/*! For license information please see main.b94587fc.js.LICENSE.txt */
(()=>{var e={973:e=>{"use strict";function t(e,t,r){r=r||2;var s,o,a,l,h,d,p,g=t&&t.length,m=g?t[0]*r:e.length,_=n(e,0,m,r,!0),v=[];if(!_||_.next===_.prev)return v;if(g&&(_=function(e,t,r,i){var s,o,a,l=[];for(s=0,o=t.length;s<o;s++)(a=n(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(c),s=0;s<l.length;s++)r=u(l[s],r);return r}(e,t,_,r)),e.length>80*r){s=a=e[0],o=l=e[1];for(var y=r;y<m;y+=r)(h=e[y])<s&&(s=h),(d=e[y+1])<o&&(o=d),h>a&&(a=h),d>l&&(l=d);p=0!==(p=Math.max(a-s,l-o))?32767/p:0}return i(_,v,r,s,o,p,0),v}function n(e,t,n,r,i){var s,o;if(i===A(e,t,n,r)>0)for(s=t;s<n;s+=r)o=S(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=S(s,e[s],e[s+1],o);return o&&_(o,o.next)&&(T(o),o=o.next),o}function r(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!_(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(T(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,c,u,h,f){if(e){!f&&h&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=d(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,s,o,a,l,c=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1)}(i)}(e,c,u,h);for(var p,g,m=e;e.prev!==e.next;)if(p=e.prev,g=e.next,h?o(e,c,u,h):s(e))t.push(p.i/n|0),t.push(e.i/n|0),t.push(g.i/n|0),T(e),e=g.next,m=g.next;else if((e=g)===m){f?1===f?i(e=a(r(e),t,n),t,n,c,u,h,2):2===f&&l(e,t,n,c,u,h):i(r(e),t,n,c,u,h,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(m(t,n,r)>=0)return!1;for(var i=t.x,s=n.x,o=r.x,a=t.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,g=r.next;g!==t;){if(g.x>=u&&g.x<=d&&g.y>=h&&g.y<=f&&p(i,a,s,l,o,c,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function o(e,t,n,r){var i=e.prev,s=e,o=e.next;if(m(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,h=s.y,f=o.y,g=a<l?a<c?a:c:l<c?l:c,_=u<h?u<f?u:f:h<f?h:f,v=a>l?a>c?a:c:l>c?l:c,y=u>h?u>f?u:f:h>f?h:f,b=d(g,_,t,n,r),E=d(v,y,t,n,r),w=e.prevZ,S=e.nextZ;w&&w.z>=b&&S&&S.z<=E;){if(w.x>=g&&w.x<=v&&w.y>=_&&w.y<=y&&w!==i&&w!==o&&p(a,u,l,h,c,f,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,S.x>=g&&S.x<=v&&S.y>=_&&S.y<=y&&S!==i&&S!==o&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;w&&w.z>=b;){if(w.x>=g&&w.x<=v&&w.y>=_&&w.y<=y&&w!==i&&w!==o&&p(a,u,l,h,c,f,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=E;){if(S.x>=g&&S.x<=v&&S.y>=_&&S.y<=y&&S!==i&&S!==o&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(e,t,n){var i=e;do{var s=i.prev,o=i.next.next;!_(s,o)&&v(s,i,i.next,o)&&E(s,o)&&E(o,s)&&(t.push(s.i/n|0),t.push(i.i/n|0),t.push(o.i/n|0),T(i),T(i.next),i=e=o),i=i.next}while(i!==e);return r(i)}function l(e,t,n,s,o,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=w(l,c);return l=r(l,l.next),u=r(u,u.next),i(l,t,n,s,o,a,0),void i(u,t,n,s,o,a,0)}c=c.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function u(e,t){var n=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==t);if(!n)return null;var l,c=n,u=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=u&&i!==r.x&&p(s<d?i:o,s,u,d,s<d?o:i,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(i-r.x),E(r,e)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=l)),r=r.next}while(r!==c);return n}(e,t);if(!n)return t;var i=w(n,e);return r(i,i.next),r(n,n.next)}function h(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function d(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,r,i,s,o,a){return(i-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(r-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(E(e,t)&&E(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||_(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,n,r){var i=b(m(e,t,n)),s=b(m(e,t,r)),o=b(m(n,r,e)),a=b(m(n,r,t));return i!==s&&o!==a||(!(0!==i||!y(e,n,t))||(!(0!==s||!y(e,r,t))||(!(0!==o||!y(n,e,r))||!(0!==a||!y(n,t,r)))))}function y(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function E(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function w(e,t){var n=new x(e.i,e.x,e.y),r=new x(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function S(e,t,n,r){var i=new x(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function x(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,n,r){for(var i=0,s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(A(e,0,s,n));if(i)for(var a=0,l=t.length;a<l;a++){var c=t[a]*n,u=a<l-1?t[a+1]*n:e.length;o-=Math.abs(A(e,c,u,n))}var h=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},895:(e,t,n)=>{var r;!function(i,s,o,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=s.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(E(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function _(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=i.console&&(i.console.warn||i.console.log);return s&&s.call(i.console,r,n),e.apply(this,arguments)}}l="function"!==typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var v=_((function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===a)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),y=_((function(e,t){return v(e,t,!0)}),"merge","Use `assign`.");function b(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&l(r,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function S(e,t){return e===a?t:e}function T(e,t,n){m(P(t),(function(t){e.addEventListener(t,n,!1)}))}function x(e,t,n){m(P(t),(function(t){e.removeEventListener(t,n,!1)}))}function A(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function R(e,t){return e.indexOf(t)>-1}function P(e){return e.trim().split(/\s+/g)}function C(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function k(e){return Array.prototype.slice.call(e,0)}function L(e,t,n){for(var r=[],i=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];C(i,o)<0&&r.push(e[s]),i[s]=o,s++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function M(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),s=0;s<c.length;){if((r=(n=c[s])?n+i:t)in e)return r;s++}return a}var I=1;function O(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var N="ontouchstart"in i,F=M(i,"PointerEvent")!==a,D=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",U="mouse",z=24,G=["x","y"],j=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function W(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=1&t&&r-i===0,o=12&t&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=H(t));i>1&&!n.firstMultiple?n.firstMultiple=H(t):1===i&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,l=o?o.center:s.center,c=t.center=X(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=Z(l,c),t.distance=Y(l,c),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};1!==t.eventType&&4!==s.eventType||(i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=K(t.deltaX,t.deltaY);var u=q(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,t.scale=o?(h=o.pointers,p=r,Y(p[0],p[1],j)/Y(h[0],h[1],j)):1,t.rotation=o?function(e,t){return Z(t[1],t[0],j)+Z(e[1],e[0],j)}(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,s,o=e.lastInterval||t,l=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(l>25||o.velocity===a)){var c=t.deltaX-o.deltaX,u=t.deltaY-o.deltaY,h=q(l,c,u);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,s=K(c,u),e.lastInterval=t}else n=o.velocity,r=o.velocityX,i=o.velocityY,s=o.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=s}(n,t);var h,p;var g=e.element;A(t.srcEvent.target,g)&&(g=t.srcEvent.target);t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:h(n/t),y:h(r/t)}}function q(e,t,n){return{x:t/e||0,y:n/e||0}}function K(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Y(e,t,n){n||(n=G);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function Z(e,t,n){n||(n=G);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(O(this.element),this.evWin,this.domHandler)}};var Q={mousedown:1,mousemove:2,mouseup:4},$="mousedown",J="mousemove mouseup";function ee(){this.evEl=$,this.evWin=J,this.pressed=!1,V.apply(this,arguments)}b(ee,V,{handler:function(e){var t=Q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:U,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ne={2:B,3:"pen",4:U,5:"kinect"},re="pointerdown",ie="pointermove pointerup pointercancel";function se(){this.evEl=re,this.evWin=ie,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(re="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel"),b(se,V,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=te[r],s=ne[e.pointerType]||e.pointerType,o=s==B,a=C(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):12&i&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),n&&t.splice(a,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,V.apply(this,arguments)}function le(e,t){var n=k(e.touches),r=k(e.changedTouches);return 12&t&&(n=L(n.concat(r),"identifier",!0)),[n,r]}b(ae,V,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=le.call(this,e,t);12&t&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}}});var ce={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function he(){this.evTarget=ue,this.targetIds={},V.apply(this,arguments)}function de(e,t){var n=k(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,s,o=k(e.changedTouches),a=[],l=this.target;if(s=n.filter((function(e){return A(e.target,l)})),1===t)for(i=0;i<s.length;)r[s[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&a.push(o[i]),12&t&&delete r[o[i].identifier],i++;return a.length?[L(s.concat(a),"identifier",!0),a]:void 0}b(he,V,{handler:function(e){var t=ce[e.type],n=de.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}});function fe(){V.apply(this,arguments);var e=E(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function pe(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ge.call(this,t)):12&e&&ge.call(this,t)}function ge(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function me(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],s=Math.abs(t-i.x),o=Math.abs(n-i.y);if(s<=25&&o<=25)return!0}return!1}b(fe,V,{handler:function(e,t,n){var r=n.pointerType==B,i=n.pointerType==U;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)pe.call(this,t,n);else if(i&&me.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=M(u.style,"touchAction"),ve=_e!==a,ye="compute",be="auto",Ee="manipulation",we="none",Se="pan-x",Te="pan-y",xe=function(){if(!ve)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||i.CSS.supports("touch-action",n)})),e}();function Ae(e,t){this.manager=e,this.set(t)}Ae.prototype={set:function(e){e==ye&&(e=this.compute()),ve&&this.manager.element.style&&xe[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,(function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(R(e,we))return we;var t=R(e,Se),n=R(e,Te);if(t&&n)return we;if(t||n)return t?Se:Te;if(R(e,Ee))return Ee;return be}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=R(r,we)&&!xe[we],s=R(r,Te)&&!xe[Te],o=R(r,Se)&&!xe[Se];if(i){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!o||!s)return i||s&&6&n||o&&n&z?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Re=32;function Pe(e){this.options=l({},this.defaults,e||{}),this.id=I++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ce(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ke(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Le(e,t){var n=t.manager;return n?n.get(e):e}function Me(){Pe.apply(this,arguments)}function Ie(){Me.apply(this,arguments),this.pX=null,this.pY=null}function Oe(){Me.apply(this,arguments)}function Ne(){Pe.apply(this,arguments),this._timer=null,this._input=null}function Fe(){Me.apply(this,arguments)}function De(){Me.apply(this,arguments)}function Be(){Pe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ue(e,t){return(t=t||{}).recognizers=S(t.recognizers,Ue.defaults.preset),new ze(e,t)}Pe.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Le(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=Le(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===C(t,e=Le(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=Le(e,this);var t=C(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Ce(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Ce(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Re},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=Re);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Me,Pe,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Re}}),b(Ie,Me,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Te),e&z&&t.push(Se),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===s?1:s<0?2:4,n=s!=this.pX,r=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Me.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ke(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(Oe,Me,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Ne,Pe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[be]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Re},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),b(Fe,Me,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(De,Me,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ie.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&z&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ke(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(Be,Pe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ee]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Y(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Re},failTimeout:function(){return this._timer=p((function(){this.state=Re}),this.options.interval,this),Re},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:ye,enable:!0,inputTarget:null,inputClass:null,preset:[[Fe,{enable:!1}],[Oe,{enable:!1},["rotate"]],[De,{direction:6}],[Ie,{direction:6},["swipe"]],[Be],[Be,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ze(e,t){var n;this.options=l({},Ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(F?se:D?he:N?fe:ee))(n,W),this.touchAction=new Ae(this,this.options.touchAction),Ge(this,!0),m(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ge(e,t){var n,r=e.element;r.style&&(m(e.options.cssProps,(function(i,s){n=M(r.style,s),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}ze.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var s=0;s<r.length;)n=r[s],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),s++}},get:function(e){if(e instanceof Pe)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=C(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return m(P(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==a){var n=this.handlers;return m(P(e),(function(e){t?n[e]&&n[e].splice(C(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=s.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ge(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Ue,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Re,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:z,DIRECTION_ALL:30,Manager:ze,Input:V,TouchAction:Ae,TouchInput:he,MouseInput:ee,PointerEventInput:se,TouchMouseInput:fe,SingleTouchInput:ae,Recognizer:Pe,AttrRecognizer:Me,Tap:Be,Pan:Ie,Swipe:De,Pinch:Oe,Rotate:Fe,Press:Ne,on:T,off:x,each:m,merge:y,extend:v,assign:l,inherit:b,bindFn:E,prefixed:M}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=Ue,(r=function(){return Ue}.call(t,n,t,e))===a||(e.exports=r)}(window,document)},4:(e,t,n)=>{"use strict";var r=n(853),i=n(43),s=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.consumer"),m=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),E=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var w=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var S=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function x(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=T&&e[T]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case h:return"Fragment";case u:return"Portal";case f:return"Profiler";case d:return"StrictMode";case v:return"Suspense";case y:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Provider";case g:return(e._context.displayName||"Context")+".Consumer";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case b:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var P,C,k=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=Object.assign;function M(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||"",C=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+P+e+C}var I=!1;function O(e,t){if(!e||I)return"";I=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){r=s}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{I=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?M(n):""}function N(e){switch(e.tag){case 26:case 27:case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 15:return e=O(e.type,!1);case 11:return e=O(e.type.render,!1);case 1:return e=O(e.type,!0);default:return""}}function F(e){try{var t="";do{t+=N(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function D(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function B(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function U(e){if(D(e)!==e)throw Error(o(188))}function z(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=z(e)))return t;e=e.sibling}return null}var G=Array.isArray,j=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},W=[],H=-1;function X(e){return{current:e}}function q(e){0>H||(e.current=W[H],W[H]=null,H--)}function K(e,t){H++,W[H]=e.current,e.current=t}var Y=X(null),Z=X(null),Q=X(null),$=X(null);function J(e,t){switch(K(Q,t),K(Z,e),K(Y,null),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?Zu(t):0;break;default:if(t=(e=8===e?t.parentNode:t).tagName,e=e.namespaceURI)t=Qu(e=Zu(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}q(Y),K(Y,t)}function ee(){q(Y),q(Z),q(Q)}function te(e){null!==e.memoizedState&&K($,e);var t=Y.current,n=Qu(t,e.type);t!==n&&(K(Z,e),K(Y,n))}function ne(e){Z.current===e&&(q(Y),q(Z)),$.current===e&&(q($),Fh._currentValue=V)}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,se=r.unstable_cancelCallback,oe=r.unstable_shouldYield,ae=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,he=r.unstable_UserBlockingPriority,de=r.unstable_NormalPriority,fe=r.unstable_LowPriority,pe=r.unstable_IdlePriority,ge=r.log,me=r.unstable_setDisableYieldValue,_e=null,ve=null;function ye(e){if("function"===typeof ge&&me(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(_e,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Ee(e)/we|0)|0},Ee=Math.log,we=Math.LN2;var Se=128,Te=4194304;function xe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=e.warmLanes;e=0!==e.finishedLanes;var a=134217727&n;return 0!==a?0!==(n=a&~i)?r=xe(n):0!==(s&=a)?r=xe(s):e||0!==(o=a&~o)&&(r=xe(o)):0!==(a=n&~i)?r=xe(a):0!==s?r=xe(s):e||0!==(o=n&~o)&&(r=xe(o)),0===r?0:0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||32===i&&0!==(4194176&o))?t:r}function Re(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Pe(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ce(){var e=Se;return 0===(4194176&(Se<<=1))&&(Se=128),e}function ke(){var e=Te;return 0===(62914560&(Te<<=1))&&(Te=4194304),e}function Le(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Me(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ie(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-be(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ne(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=j.p;return 0!==e?e:void 0===(e=window.event)?32:Qh(e.type)}var De=Math.random().toString(36).slice(2),Be="__reactFiber$"+De,Ue="__reactProps$"+De,ze="__reactContainer$"+De,Ge="__reactEvents$"+De,je="__reactListeners$"+De,Ve="__reactHandles$"+De,We="__reactResources$"+De,He="__reactMarker$"+De;function Xe(e){delete e[Be],delete e[Ue],delete e[Ge],delete e[je],delete e[Ve]}function qe(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ze]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=lh(e);null!==e;){if(n=e[Be])return n;e=lh(e)}return t}n=(e=n).parentNode}return null}function Ke(e){if(e=e[Be]||e[ze]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ye(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Ze(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Qe(e){e[He]=!0}var $e=new Set,Je={};function et(e,t){tt(e,t),tt(e+"Capture",t)}function tt(e,t){for(Je[e]=t,e=0;e<t.length;e++)$e.add(t[e])}var nt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),rt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},st={};function ot(e,t,n){if(i=t,re.call(st,i)||!re.call(it,i)&&(rt.test(i)?st[i]=!0:(it[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function at(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function lt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function dt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function gt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function mt(e,t,n,r,i,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?vt(e,o,ct(t)):null!=n?vt(e,o,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function _t(e,t,n,r,i,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function vt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function yt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function bt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Et(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(G(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function wt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function xt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Tt(e,i,r)}else for(var s in t)t.hasOwnProperty(s)&&Tt(e,s,t[s])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ct(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var kt=null;function Lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Mt=null,It=null;function Ot(e){var t=Ke(e);if(t&&(e=t.stateNode)){var n=e[Ue]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Ue]||null;if(!i)throw Error(o(90));mt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&dt(r)}break e;case"textarea":bt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&yt(e,!!n.multiple,t,!1)}}}var Nt=!1;function Ft(e,t,n){if(Nt)return e(t,n);Nt=!0;try{return e(t)}finally{if(Nt=!1,(null!==Mt||null!==It)&&(Bc(),Mt&&(t=Mt,e=It,It=Mt=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Dt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Ue]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Bt=!1;if(nt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(Ed){Bt=!1}var zt=null,Gt=null,jt=null;function Vt(){if(jt)return jt;var e,t,n=Gt,r=n.length,i="value"in zt?zt.value:zt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return jt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ht(){return!0}function Xt(){return!1}function qt(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Ht:Xt,this.isPropagationStopped=Xt,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ht)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ht)},persist:function(){},isPersistent:Ht}),t}var Kt,Yt,Zt,Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$t=qt(Qt),Jt=L({},Qt,{view:0,detail:0}),en=qt(Jt),tn=L({},Jt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(Kt=e.screenX-Zt.screenX,Yt=e.screenY-Zt.screenY):Yt=Kt=0,Zt=e),Kt)},movementY:function(e){return"movementY"in e?e.movementY:Yt}}),nn=qt(tn),rn=qt(L({},tn,{dataTransfer:0})),sn=qt(L({},Jt,{relatedTarget:0})),on=qt(L({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0})),an=qt(L({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ln=qt(L({},Qt,{data:0})),cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},un={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function fn(){return dn}var pn=qt(L({},Jt,{key:function(e){if(e.key){var t=cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?un[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=qt(L({},tn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mn=qt(L({},Jt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn})),_n=qt(L({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=qt(L({},tn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),yn=qt(L({},Qt,{newState:0,oldState:0})),bn=[9,13,27,32],En=nt&&"CompositionEvent"in window,wn=null;nt&&"documentMode"in document&&(wn=document.documentMode);var Sn=nt&&"TextEvent"in window&&!wn,Tn=nt&&(!En||wn&&8<wn&&11>=wn),xn=String.fromCharCode(32),An=!1;function Rn(e,t){switch(e){case"keyup":return-1!==bn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Cn=!1;var kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!kn[e.type]:"textarea"===t}function Mn(e,t,n,r){Mt?It?It.push(r):It=[r]:Mt=r,0<(t=Fu(t,"onChange")).length&&(n=new $t("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var In=null,On=null;function Nn(e){Pu(e,0)}function Fn(e){if(dt(Ye(e)))return e}function Dn(e,t){if("change"===e)return t}var Bn=!1;if(nt){var Un;if(nt){var zn="oninput"in document;if(!zn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),zn="function"===typeof Gn.oninput}Un=zn}else Un=!1;Bn=Un&&(!document.documentMode||9<document.documentMode)}function jn(){In&&(In.detachEvent("onpropertychange",Vn),On=In=null)}function Vn(e){if("value"===e.propertyName&&Fn(On)){var t=[];Mn(t,On,e,Lt(e)),Ft(Nn,t)}}function Wn(e,t,n){"focusin"===e?(jn(),On=n,(In=t).attachEvent("onpropertychange",Vn)):"focusout"===e&&jn()}function Hn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(On)}function Xn(e,t){if("click"===e)return Fn(t)}function qn(e,t){if("input"===e||"change"===e)return Fn(t)}var Kn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yn(e,t){if(Kn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!Kn(e[i],t[i]))return!1}return!0}function Zn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qn(e,t){var n,r=Zn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Zn(r)}}function $n(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?$n(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Jn(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function er(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function tr(e,t){var n=Jn(t);t=e.focusedElem;var r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&$n(t.ownerDocument.documentElement,t)){if(null!==r&&er(t))if(e=r.start,void 0===(n=r.end)&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if((n=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Qn(t,s);var o=Qn(t,r);i&&o&&(1!==n.rangeCount||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&((e=e.createRange()).setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}for(e=[],n=t;n=n.parentNode;)1===n.nodeType&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(n=e[t]).element.scrollLeft=n.left,n.element.scrollTop=n.top}}var nr=nt&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,sr=null,or=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&er(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Yn(sr,r)||(sr=r,0<(r=Fu(ir,"onSelect")).length&&(t=new $t("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},hr={};function dr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return ur[e]=n[t];return e}nt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=dr("animationend"),pr=dr("animationiteration"),gr=dr("animationstart"),mr=dr("transitionrun"),_r=dr("transitionstart"),vr=dr("transitioncancel"),yr=dr("transitionend"),br=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function wr(e,t){br.set(e,t),et(t,[e])}var Sr=[],Tr=0,xr=0;function Ar(){for(var e=Tr,t=xr=Tr=0;t<e;){var n=Sr[t];Sr[t++]=null;var r=Sr[t];Sr[t++]=null;var i=Sr[t];Sr[t++]=null;var s=Sr[t];if(Sr[t++]=null,null!==r&&null!==i){var o=r.pending;null===o?i.next=i:(i.next=o.next,o.next=i),r.pending=i}0!==s&&kr(n,i,s)}}function Rr(e,t,n,r){Sr[Tr++]=e,Sr[Tr++]=t,Sr[Tr++]=n,Sr[Tr++]=r,xr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Rr(e,t,n,r),Lr(e)}function Cr(e,t){return Rr(e,null,null,t),Lr(e)}function kr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;i&&null!==t&&3===e.tag&&(s=e.stateNode,i=31-be(n),null===(e=(s=s.hiddenUpdates)[i])?s[i]=[t]:e.push(t),t.lane=536870912|n)}function Lr(e){if(50<Pc)throw Pc=0,Cc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Mr={},Ir=new WeakMap;function Or(e,t){if("object"===typeof e&&null!==e){var n=Ir.get(e);return void 0!==n?n:(t={value:e,source:t,stack:F(t)},Ir.set(e,t),t)}return{value:e,source:t,stack:F(t)}}var Nr=[],Fr=0,Dr=null,Br=0,Ur=[],zr=0,Gr=null,jr=1,Vr="";function Wr(e,t){Nr[Fr++]=Br,Nr[Fr++]=Dr,Dr=e,Br=t}function Hr(e,t,n){Ur[zr++]=jr,Ur[zr++]=Vr,Ur[zr++]=Gr,Gr=e;var r=jr;e=Vr;var i=32-be(r)-1;r&=~(1<<i),n+=1;var s=32-be(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,jr=1<<32-be(t)+i|n<<i|r,Vr=s+e}else jr=1<<s|n<<i|r,Vr=e}function Xr(e){null!==e.return&&(Wr(e,1),Hr(e,1,0))}function qr(e){for(;e===Dr;)Dr=Nr[--Fr],Nr[Fr]=null,Br=Nr[--Fr],Nr[Fr]=null;for(;e===Gr;)Gr=Ur[--zr],Ur[zr]=null,Vr=Ur[--zr],Ur[zr]=null,jr=Ur[--zr],Ur[zr]=null}var Kr=null,Yr=null,Zr=!1,Qr=null,$r=!1,Jr=Error(o(519));function ei(e){throw si(Or(Error(o(418,"")),e)),Jr}function ti(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Be]=e,t[Ue]=r,n){case"dialog":Cu("cancel",t),Cu("close",t);break;case"iframe":case"object":case"embed":Cu("load",t);break;case"video":case"audio":for(n=0;n<Au.length;n++)Cu(Au[n],t);break;case"source":Cu("error",t);break;case"img":case"image":case"link":Cu("error",t),Cu("load",t);break;case"details":Cu("toggle",t);break;case"input":Cu("invalid",t),_t(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Cu("invalid",t);break;case"textarea":Cu("invalid",t),Et(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||ju(t.textContent,n)?(null!=r.popover&&(Cu("beforetoggle",t),Cu("toggle",t)),null!=r.onScroll&&Cu("scroll",t),null!=r.onScrollEnd&&Cu("scrollend",t),null!=r.onClick&&(t.onclick=Vu),t=!0):t=!1,t||ei(e)}function ni(e){for(Kr=e.return;Kr;)switch(Kr.tag){case 3:case 27:return void($r=!0);case 5:case 13:return void($r=!1);default:Kr=Kr.return}}function ri(e){if(e!==Kr)return!1;if(!Zr)return ni(e),Zr=!0,!1;var t,n=!1;if((t=3!==e.tag&&27!==e.tag)&&((t=5===e.tag)&&(t=!("form"!==(t=e.type)&&"button"!==t)||$u(e.type,e.memoizedProps)),t=!t),t&&(n=!0),n&&Yr&&ei(e),ni(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){Yr=ah(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}Yr=null}}else Yr=Kr?ah(e.stateNode.nextSibling):null;return!0}function ii(){Yr=Kr=null,Zr=!1}function si(e){null===Qr?Qr=[e]:Qr.push(e)}var oi=Error(o(460)),ai=Error(o(474)),li={then:function(){}};function ci(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ui(){}function hi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(ui,ui),t=n),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oi)throw Error(o(483));throw e;default:if("string"===typeof t.status)t.then(ui,ui);else{if(null!==(e=tc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oi)throw Error(o(483));throw e}throw di=t,oi}}var di=null;function fi(){if(null===di)throw Error(o(459));var e=di;return di=null,e}var pi=null,gi=0;function mi(e){var t=gi;return gi+=1,null===pi&&(pi=[]),hi(pi,e,t)}function _i(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function vi(e,t){if(t.$$typeof===l)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=jl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n,r){var s=n.type;return s===h?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===E&&yi(s)===t.type)?(_i(t=i(t,n.props),n),t.return=e,t):(_i(t=Ul(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function f(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function p(e,t,n,r,s){return null===t||7!==t.tag?((t=zl(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function g(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=jl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return _i(n=Ul(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case u:return(t=Vl(t,e.mode,n)).return=e,t;case E:return g(e,t=(0,t._init)(t._payload),n)}if(G(t)||x(t))return(t=zl(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return g(e,mi(t),n);if(t.$$typeof===m)return g(e,Aa(e,t),n);vi(e,t)}return null}function _(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case c:return n.key===i?d(e,t,n,r):null;case u:return n.key===i?f(e,t,n,r):null;case E:return _(e,t,n=(i=n._init)(n._payload),r)}if(G(n)||x(n))return null!==i?null:p(e,t,n,r,null);if("function"===typeof n.then)return _(e,t,mi(n),r);if(n.$$typeof===m)return _(e,t,Aa(e,n),r);vi(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case u:return f(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return v(e,t,n,r=(0,r._init)(r._payload),i)}if(G(r)||x(r))return p(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return v(e,t,n,mi(r),i);if(r.$$typeof===m)return v(e,t,n,Aa(t,r),i);vi(t,r)}return null}function y(l,d,f,p){if("object"===typeof f&&null!==f&&f.type===h&&null===f.key&&(f=f.props.children),"object"===typeof f&&null!==f){switch(f.$$typeof){case c:e:{for(var b=f.key;null!==d;){if(d.key===b){if((b=f.type)===h){if(7===d.tag){n(l,d.sibling),(p=i(d,f.props.children)).return=l,l=p;break e}}else if(d.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===E&&yi(b)===d.type){n(l,d.sibling),_i(p=i(d,f.props),f),p.return=l,l=p;break e}n(l,d);break}t(l,d),d=d.sibling}f.type===h?((p=zl(f.props.children,l.mode,p,f.key)).return=l,l=p):(_i(p=Ul(f.type,f.key,f.props,null,l.mode,p),f),p.return=l,l=p)}return a(l);case u:e:{for(b=f.key;null!==d;){if(d.key===b){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){n(l,d.sibling),(p=i(d,f.children||[])).return=l,l=p;break e}n(l,d);break}t(l,d),d=d.sibling}(p=Vl(f,l.mode,p)).return=l,l=p}return a(l);case E:return y(l,d,f=(b=f._init)(f._payload),p)}if(G(f))return function(i,o,a,l){for(var c=null,u=null,h=o,d=o=0,f=null;null!==h&&d<a.length;d++){h.index>d?(f=h,h=null):f=h.sibling;var p=_(i,h,a[d],l);if(null===p){null===h&&(h=f);break}e&&h&&null===p.alternate&&t(i,h),o=s(p,o,d),null===u?c=p:u.sibling=p,u=p,h=f}if(d===a.length)return n(i,h),Zr&&Wr(i,d),c;if(null===h){for(;d<a.length;d++)null!==(h=g(i,a[d],l))&&(o=s(h,o,d),null===u?c=h:u.sibling=h,u=h);return Zr&&Wr(i,d),c}for(h=r(h);d<a.length;d++)null!==(f=v(h,i,d,a[d],l))&&(e&&null!==f.alternate&&h.delete(null===f.key?d:f.key),o=s(f,o,d),null===u?c=f:u.sibling=f,u=f);return e&&h.forEach((function(e){return t(i,e)})),Zr&&Wr(i,d),c}(l,d,f,p);if(x(f)){if("function"!==typeof(b=x(f)))throw Error(o(150));return function(i,a,l,c){if(null==l)throw Error(o(151));for(var u=null,h=null,d=a,f=a=0,p=null,m=l.next();null!==d&&!m.done;f++,m=l.next()){d.index>f?(p=d,d=null):p=d.sibling;var y=_(i,d,m.value,c);if(null===y){null===d&&(d=p);break}e&&d&&null===y.alternate&&t(i,d),a=s(y,a,f),null===h?u=y:h.sibling=y,h=y,d=p}if(m.done)return n(i,d),Zr&&Wr(i,f),u;if(null===d){for(;!m.done;f++,m=l.next())null!==(m=g(i,m.value,c))&&(a=s(m,a,f),null===h?u=m:h.sibling=m,h=m);return Zr&&Wr(i,f),u}for(d=r(d);!m.done;f++,m=l.next())null!==(m=v(d,i,f,m.value,c))&&(e&&null!==m.alternate&&d.delete(null===m.key?f:m.key),a=s(m,a,f),null===h?u=m:h.sibling=m,h=m);return e&&d.forEach((function(e){return t(i,e)})),Zr&&Wr(i,f),u}(l,d,f=b.call(f),p)}if("function"===typeof f.then)return y(l,d,mi(f),p);if(f.$$typeof===m)return y(l,d,Aa(l,f),p);vi(l,f)}return"string"===typeof f&&""!==f||"number"===typeof f||"bigint"===typeof f?(f=""+f,null!==d&&6===d.tag?(n(l,d.sibling),(p=i(d,f)).return=l,l=p):(n(l,d),(p=jl(f,l.mode,p)).return=l,l=p),a(l)):n(l,d)}return function(e,t,n,r){try{gi=0;var i=y(e,t,n,r);return pi=null,i}catch(o){if(o===oi)throw o;var s=Nl(29,o,null,e.mode);return s.lanes=r,s.return=e,s}}}var Ei=bi(!0),wi=bi(!1),Si=X(null),Ti=X(0);function xi(e,t){K(Ti,e=cc),K(Si,t),cc=e|t.baseLanes}function Ai(){K(Ti,cc),K(Si,Si.current)}function Ri(){cc=Ti.current,q(Si),q(Ti)}var Pi=X(null),Ci=null;function ki(e){var t=e.alternate;K(Oi,1&Oi.current),K(Pi,e),null===Ci&&(null===t||null!==Si.current||null!==t.memoizedState)&&(Ci=e)}function Li(e){if(22===e.tag){if(K(Oi,Oi.current),K(Pi,e),null===Ci){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Ci=e)}}else Mi()}function Mi(){K(Oi,Oi.current),K(Pi,Pi.current)}function Ii(e){q(Pi),Ci===e&&(Ci=null),q(Oi)}var Oi=X(0);function Ni(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Di=r.unstable_scheduleCallback,Bi=r.unstable_NormalPriority,Ui={$$typeof:m,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zi(){return{controller:new Fi,data:new Map,refCount:0}}function Gi(e){e.refCount--,0===e.refCount&&Di(Bi,(function(){e.controller.abort()}))}var ji=null,Vi=0,Wi=0,Hi=null;function Xi(){if(0===--Vi&&null!==ji){null!==Hi&&(Hi.status="fulfilled");var e=ji;ji=null,Wi=0,Hi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qi=k.S;k.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===ji){var n=ji=[];Vi=0,Wi=Eu(),Hi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Vi++,t.then(Xi,Xi)}(0,t),null!==qi&&qi(e,t)};var Ki=X(null);function Yi(){var e=Ki.current;return null!==e?e:tc.pooledCache}function Zi(e,t){K(Ki,null===t?Ki.current:t.pool)}function Qi(){var e=Yi();return null===e?null:{parent:Ui._currentValue,pool:e}}var $i=0,Ji=null,es=null,ts=null,ns=!1,rs=!1,is=!1,ss=0,os=0,as=null,ls=0;function cs(){throw Error(o(321))}function us(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function hs(e,t,n,r,i,s){return $i=s,Ji=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,k.H=null===e||null===e.memoizedState?Ao:Ro,is=!1,s=n(r,i),is=!1,rs&&(s=fs(t,n,r,i)),ds(e),s}function ds(e){k.H=xo;var t=null!==es&&null!==es.next;if($i=0,ts=es=Ji=null,ns=!1,os=0,as=null,t)throw Error(o(300));null===e||Wo||null!==(e=e.dependencies)&&Sa(e)&&(Wo=!0)}function fs(e,t,n,r){Ji=e;var i=0;do{if(rs&&(as=null),os=0,rs=!1,25<=i)throw Error(o(301));if(i+=1,ts=es=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}k.H=Po,s=t(n,r)}while(rs);return s}function ps(){var e=k.H,t=e.useState()[0];return t="function"===typeof t.then?bs(t):t,e=e.useState()[0],(null!==es?es.memoizedState:null)!==e&&(Ji.flags|=1024),t}function gs(){var e=0!==ss;return ss=0,e}function ms(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function _s(e){if(ns){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ns=!1}$i=0,ts=es=Ji=null,rs=!1,os=ss=0,as=null}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ts?Ji.memoizedState=ts=e:ts=ts.next=e,ts}function ys(){if(null===es){var e=Ji.alternate;e=null!==e?e.memoizedState:null}else e=es.next;var t=null===ts?Ji.memoizedState:ts.next;if(null!==t)ts=t,es=e;else{if(null===e){if(null===Ji.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(es=e).memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},null===ts?Ji.memoizedState=ts=e:ts=ts.next=e}return ts}function bs(e){var t=os;return os+=1,null===as&&(as=[]),e=hi(as,e,t),t=Ji,null===(null===ts?t.memoizedState:ts.next)&&(t=t.alternate,k.H=null===t||null===t.memoizedState?Ao:Ro),e}function Es(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return bs(e);if(e.$$typeof===m)return xa(e)}throw Error(o(438,String(e)))}function ws(e){var t=null,n=Ji.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Ji.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=S;return t.index++,n}function Ss(e,t){return"function"===typeof t?t(e):t}function Ts(e){return xs(ys(),es,e)}function xs(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var i=e.baseQueue,s=r.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,r.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(rc&d)===d:($i&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Wi&&(h=!0);else{if(($i&f)===f){u=u.next,f===Wi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=s):c=c.next=d,Ji.lanes|=f,hc|=f}d=u.action,is&&n(s,d),s=u.hasEagerState?u.eagerState:n(s,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=s):c=c.next=f,Ji.lanes|=d,hc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!Kn(s,e.memoizedState)&&(Wo=!0,h&&null!==(n=Hi)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,r.lastRenderedState=s}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function As(e){var t=ys(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);Kn(s,t.memoizedState)||(Wo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Rs(e,t,n){var r=Ji,i=ys(),s=Zr;if(s){if(void 0===n)throw Error(o(407));n=n()}else n=t();var a=!Kn((es||i).memoizedState,n);if(a&&(i.memoizedState=n,Wo=!0),i=i.queue,$s(ks.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==ts&&1&ts.memoizedState.tag){if(r.flags|=2048,qs(9,Cs.bind(null,r,i,n,t),{destroy:void 0},null),null===tc)throw Error(o(349));s||0!==(60&$i)||Ps(r,t,n)}return n}function Ps(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ji.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Cs(e,t,n,r){t.value=n,t.getSnapshot=r,Ls(t)&&Ms(e)}function ks(e,t,n){return n((function(){Ls(t)&&Ms(e)}))}function Ls(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch(r){return!0}}function Ms(e){var t=Cr(e,2);null!==t&&Mc(t,e,2)}function Is(e){var t=vs();if("function"===typeof e){var n=e;if(e=n(),is){ye(!0);try{n()}finally{ye(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t}function Os(e,t,n,r){return e.baseState=n,xs(e,es,"function"===typeof r?r:Ss)}function Ns(e,t,n,r,i){if(wo(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==k.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,Fs(t,s)):(s.next=n.next,t.pending=n.next=s)}}function Fs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var s=k.T,o={};k.T=o;try{var a=n(i,r),l=k.S;null!==l&&l(o,a),Ds(e,t,a)}catch(c){Us(e,t,c)}finally{k.T=s}}else try{Ds(e,t,s=n(i,r))}catch(u){Us(e,t,u)}}function Ds(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){Bs(e,t,n)}),(function(n){return Us(e,t,n)})):Bs(e,t,n)}function Bs(e,t,n){t.status="fulfilled",t.value=n,zs(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Fs(e,n)))}function Us(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,zs(t),t=t.next}while(t!==r)}e.action=null}function zs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Gs(e,t){return t}function js(e,t){if(Zr){var n=tc.formState;if(null!==n){e:{var r=Ji;if(Zr){if(Yr){t:{for(var i=Yr,s=$r;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=ah(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){Yr=ah(i.nextSibling),r="F!"===i.data;break e}}ei(r)}r=!1}r&&(t=n[0])}}return(n=vs()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:t},n.queue=r,n=yo.bind(null,Ji,r),r.dispatch=n,r=Is(!1),s=Eo.bind(null,Ji,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=vs()).queue=i,n=Ns.bind(null,Ji,i,s,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Vs(e){return Ws(ys(),es,e)}function Ws(e,t,n){t=xs(e,t,Gs)[0],e=Ts(Ss)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?bs(t):t;var r=ys(),i=r.queue,s=i.dispatch;return n!==r.memoizedState&&(Ji.flags|=2048,qs(9,Hs.bind(null,i,n),{destroy:void 0},null)),[t,s,e]}function Hs(e,t){e.action=t}function Xs(e){var t=ys(),n=es;if(null!==n)return Ws(t,n,e);ys(),t=t.memoizedState;var r=(n=ys()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function qs(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=Ji.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ks(){return ys().memoizedState}function Ys(e,t,n,r){var i=vs();Ji.flags|=e,i.memoizedState=qs(1|t,n,{destroy:void 0},void 0===r?null:r)}function Zs(e,t,n,r){var i=ys();r=void 0===r?null:r;var s=i.memoizedState.inst;null!==es&&null!==r&&us(r,es.memoizedState.deps)?i.memoizedState=qs(t,n,s,r):(Ji.flags|=e,i.memoizedState=qs(1|t,n,s,r))}function Qs(e,t){Ys(8390656,8,e,t)}function $s(e,t){Zs(2048,8,e,t)}function Js(e,t){return Zs(4,2,e,t)}function eo(e,t){return Zs(4,4,e,t)}function to(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function no(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Zs(4,4,to.bind(null,t,e),n)}function ro(){}function io(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&us(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function so(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&us(t,r[1]))return r[0];if(r=e(),is){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[r,t],r}function oo(e,t,n){return void 0===n||0!==(1073741824&$i)?e.memoizedState=t:(e.memoizedState=n,e=Lc(),Ji.lanes|=e,hc|=e,n)}function ao(e,t,n,r){return Kn(n,t)?n:null!==Si.current?(e=oo(e,n,r),Kn(e,t)||(Wo=!0),e):0===(42&$i)?(Wo=!0,e.memoizedState=n):(e=Lc(),Ji.lanes|=e,hc|=e,t)}function lo(e,t,n,r,i){var s=j.p;j.p=0!==s&&8>s?s:8;var o=k.T,a={};k.T=a,Eo(e,!1,t,n);try{var l=i(),c=k.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)bo(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r),kc());else bo(e,t,r,kc())}catch(u){bo(e,t,{then:function(){},status:"rejected",reason:u},kc())}finally{j.p=s,k.T=o}}function co(){}function uo(e,t,n,r){if(5!==e.tag)throw Error(o(476));var i=ho(e).queue;lo(e,i,t,V,null===n?co:function(){return fo(e),n(r)})}function ho(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:V},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function fo(e){bo(e,ho(e).next.queue,{},kc())}function po(){return xa(Fh)}function go(){return ys().memoizedState}function mo(){return ys().memoizedState}function _o(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=kc(),r=Ma(t,e=La(n),n);return null!==r&&(Mc(r,t,n),Ia(r,t,n)),t={cache:zi()},void(e.payload=t)}t=t.return}}function vo(e,t,n){var r=kc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},wo(e)?So(t,n):null!==(n=Pr(e,t,n,r))&&(Mc(n,e,r),To(n,t,r))}function yo(e,t,n){bo(e,t,n,kc())}function bo(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(wo(e))So(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Kn(a,o))return Rr(e,t,i,0),null===tc&&Ar(),!1}catch(l){}if(null!==(n=Pr(e,t,i,r)))return Mc(n,e,r),To(n,t,r),!0}return!1}function Eo(e,t,n,r){if(r={lane:2,revertLane:Eu(),action:r,hasEagerState:!1,eagerState:null,next:null},wo(e)){if(t)throw Error(o(479))}else null!==(t=Pr(e,n,r,2))&&Mc(t,e,2)}function wo(e){var t=e.alternate;return e===Ji||null!==t&&t===Ji}function So(e,t){rs=ns=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function To(e,t,n){if(0!==(4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var xo={readContext:xa,use:Es,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useLayoutEffect:cs,useInsertionEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useSyncExternalStore:cs,useId:cs};xo.useCacheRefresh=cs,xo.useMemoCache=cs,xo.useHostTransitionStatus=cs,xo.useFormState=cs,xo.useActionState=cs,xo.useOptimistic=cs;var Ao={readContext:xa,use:Es,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:Qs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ys(4194308,4,to.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ys(4194308,4,e,t)},useInsertionEffect:function(e,t){Ys(4,2,e,t)},useMemo:function(e,t){var n=vs();t=void 0===t?null:t;var r=e();if(is){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=vs();if(void 0!==n){var i=n(t);if(is){ye(!0);try{n(t)}finally{ye(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=vo.bind(null,Ji,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:function(e){var t=(e=Is(e)).queue,n=yo.bind(null,Ji,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ro,useDeferredValue:function(e,t){return oo(vs(),e,t)},useTransition:function(){var e=Is(!1);return e=lo.bind(null,Ji,e.queue,!0,!1),vs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ji,i=vs();if(Zr){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===tc)throw Error(o(349));0!==(60&rc)||Ps(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Qs(ks.bind(null,r,s,e),[e]),r.flags|=2048,qs(9,Cs.bind(null,r,s,n,t),{destroy:void 0},null),n},useId:function(){var e=vs(),t=tc.identifierPrefix;if(Zr){var n=Vr;t=":"+t+"R"+(n=(jr&~(1<<32-be(jr)-1)).toString(32)+n),0<(n=ss++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ls++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return vs().memoizedState=_o.bind(null,Ji)}};Ao.useMemoCache=ws,Ao.useHostTransitionStatus=po,Ao.useFormState=js,Ao.useActionState=js,Ao.useOptimistic=function(e){var t=vs();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Eo.bind(null,Ji,!0,n),n.dispatch=t,[e,t]};var Ro={readContext:xa,use:Es,useCallback:io,useContext:xa,useEffect:$s,useImperativeHandle:no,useInsertionEffect:Js,useLayoutEffect:eo,useMemo:so,useReducer:Ts,useRef:Ks,useState:function(){return Ts(Ss)},useDebugValue:ro,useDeferredValue:function(e,t){return ao(ys(),es.memoizedState,e,t)},useTransition:function(){var e=Ts(Ss)[0],t=ys().memoizedState;return["boolean"===typeof e?e:bs(e),t]},useSyncExternalStore:Rs,useId:go};Ro.useCacheRefresh=mo,Ro.useMemoCache=ws,Ro.useHostTransitionStatus=po,Ro.useFormState=Vs,Ro.useActionState=Vs,Ro.useOptimistic=function(e,t){return Os(ys(),0,e,t)};var Po={readContext:xa,use:Es,useCallback:io,useContext:xa,useEffect:$s,useImperativeHandle:no,useInsertionEffect:Js,useLayoutEffect:eo,useMemo:so,useReducer:As,useRef:Ks,useState:function(){return As(Ss)},useDebugValue:ro,useDeferredValue:function(e,t){var n=ys();return null===es?oo(n,e,t):ao(n,es.memoizedState,e,t)},useTransition:function(){var e=As(Ss)[0],t=ys().memoizedState;return["boolean"===typeof e?e:bs(e),t]},useSyncExternalStore:Rs,useId:go};function Co(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}Po.useCacheRefresh=mo,Po.useMemoCache=ws,Po.useHostTransitionStatus=po,Po.useFormState=Xs,Po.useActionState=Xs,Po.useOptimistic=function(e,t){var n=ys();return null!==es?Os(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])};var ko={isMounted:function(e){return!!(e=e._reactInternals)&&D(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=kc(),i=La(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ma(e,i,r))&&(Mc(t,e,r),Ia(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=kc(),i=La(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ma(e,i,r))&&(Mc(t,e,r),Ia(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=kc(),r=La(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ma(e,r,n))&&(Mc(t,e,n),Ia(t,e,n))}};function Lo(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Yn(n,r)||!Yn(i,s))}function Mo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ko.enqueueReplaceState(t,t.state,null)}function Io(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=L({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var Oo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function No(e){Oo(e)}function Fo(e){console.error(e)}function Do(e){Oo(e)}function Bo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Uo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function zo(e,t,n){return(n=La(n)).tag=3,n.payload={element:null},n.callback=function(){Bo(e,t)},n}function Go(e){return(e=La(e)).tag=3,e}function jo(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var s=r.value;e.payload=function(){return i(s)},e.callback=function(){Uo(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Uo(t,n,r),"function"!==typeof i&&(null===wc?wc=new Set([this]):wc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Vo=Error(o(461)),Wo=!1;function Ho(e,t,n,r){t.child=null===e?wi(t,null,n,r):Ei(t,e.child,n,r)}function Xo(e,t,n,r,i){n=n.render;var s=t.ref;if("ref"in r){var o={};for(var a in r)"ref"!==a&&(o[a]=r[a])}else o=r;return Ta(t),r=hs(e,t,n,o,s,i),a=gs(),null===e||Wo?(Zr&&a&&Xr(t),t.flags|=1,Ho(e,t,r,i),t.child):(ms(e,t,i),da(e,t,i))}function qo(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Fl(s)||void 0!==s.defaultProps||null!==n.compare?((e=Ul(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ko(e,t,s,r,i))}if(s=e.child,!fa(e,i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Yn)(o,r)&&e.ref===t.ref)return da(e,t,i)}return t.flags|=1,(e=Dl(s,r)).ref=t.ref,e.return=t,t.child=e}function Ko(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(Yn(s,r)&&e.ref===t.ref){if(Wo=!1,t.pendingProps=r=s,!fa(e,i))return t.lanes=e.lanes,da(e,t,i);0!==(131072&e.flags)&&(Wo=!0)}}return $o(e,t,n,r,i)}function Yo(e,t,n){var r=t.pendingProps,i=r.children,s=0!==(2&t.stateNode._pendingVisibility),o=null!==e?e.memoizedState:null;if(Qo(e,t),"hidden"===r.mode||s){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,s=0;null!==i;)s=s|i.lanes|i.childLanes,i=i.sibling;t.childLanes=s&~r}else t.childLanes=0,t.child=null;return Zo(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Zo(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Zi(0,null!==o?o.cachePool:null),null!==o?xi(t,o):Ai(),Li(t)}else null!==o?(Zi(0,o.cachePool),xi(t,o),Mi(),t.memoizedState=null):(null!==e&&Zi(0,null),Ai(),Mi());return Ho(e,t,i,n),t.child}function Zo(e,t,n,r){var i=Yi();return i=null===i?null:{parent:Ui._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Zi(0,null),Ai(),Li(t),null!==e&&wa(e,t,r,!0),null}function Qo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=2097664)}}function $o(e,t,n,r,i){return Ta(t),n=hs(e,t,n,r,void 0,i),r=gs(),null===e||Wo?(Zr&&r&&Xr(t),t.flags|=1,Ho(e,t,n,i),t.child):(ms(e,t,i),da(e,t,i))}function Jo(e,t,n,r,i,s){return Ta(t),t.updateQueue=null,n=fs(t,r,n,i),ds(e),r=gs(),null===e||Wo?(Zr&&r&&Xr(t),t.flags|=1,Ho(e,t,n,s),t.child):(ms(e,t,s),da(e,t,s))}function ea(e,t,n,r,i){if(Ta(t),null===t.stateNode){var s=Mr,o=n.contextType;"object"===typeof o&&null!==o&&(s=xa(o)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=ko,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},Ca(t),o=n.contextType,s.context="object"===typeof o&&null!==o?xa(o):Mr,s.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(Co(t,n,o,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&ko.enqueueReplaceState(s,s.state,null),Da(t,r,s,i),Fa(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=Io(n,a);s.props=l;var c=s.context,u=n.contextType;o=Mr,"object"===typeof u&&null!==u&&(o=xa(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&Mo(t,s,r,o),Pa=!1;var d=t.memoizedState;s.state=d,Da(t,r,s,i),Fa(),c=t.memoizedState,a||d!==c||Pa?("function"===typeof h&&(Co(t,n,h,r),c=t.memoizedState),(l=Pa||Lo(t,n,l,r,d,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=o,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ka(e,t),u=Io(n,o=t.memoizedProps),s.props=u,h=t.pendingProps,d=s.context,c=n.contextType,l=Mr,"object"===typeof c&&null!==c&&(l=xa(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&Mo(t,s,r,l),Pa=!1,d=t.memoizedState,s.state=d,Da(t,r,s,i),Fa();var f=t.memoizedState;o!==h||d!==f||Pa||null!==e&&null!==e.dependencies&&Sa(e.dependencies)?("function"===typeof a&&(Co(t,n,a,r),f=t.memoizedState),(u=Pa||Lo(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Sa(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Qo(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=Ei(t,e.child,null,i),t.child=Ei(t,null,n,i)):Ho(e,t,n,i),t.memoizedState=s.state,e=t.child):e=da(e,t,i),e}function ta(e,t,n,r){return ii(),t.flags|=256,Ho(e,t,n,r),t.child}var na={dehydrated:null,treeContext:null,retryLane:0};function ra(e){return{baseLanes:e,cachePool:Qi()}}function ia(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=pc),e}function sa(e,t,n){var r,i=t.pendingProps,s=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Oi.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(Zr){if(s?ki(t):Mi(),Zr){var l,c=Yr;if(l=c){e:{for(l=c,c=$r;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=ah(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Gr?{id:jr,overflow:Vr}:null,retryLane:536870912},(l=Nl(18,null,null,0)).stateNode=c,l.return=t,t.child=l,Kr=t,Yr=null,l=!0):l=!1}l||ei(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return"$!"===c.data?t.lanes=16:t.lanes=536870912,null;Ii(t)}return c=i.children,i=i.fallback,s?(Mi(),c=aa({mode:"hidden",children:c},s=t.mode),i=zl(i,s,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=ra(n),s.childLanes=ia(e,r,n),t.memoizedState=na,i):(ki(t),oa(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(ki(t),t.flags&=-257,t=la(e,t,n)):null!==t.memoizedState?(Mi(),t.child=e.child,t.flags|=128,t=null):(Mi(),s=i.fallback,c=t.mode,i=aa({mode:"visible",children:i.children},c),(s=zl(s,c,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,Ei(t,e.child,null,n),(i=t.child).memoizedState=ra(n),i.childLanes=ia(e,r,n),t.memoizedState=na,t=s);else if(ki(t),"$!"===c.data){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(o(419))).stack="",i.digest=r,si({value:i,source:null,stack:null}),t=la(e,t,n)}else if(Wo||wa(e,t,n,!1),r=0!==(n&e.childLanes),Wo||r){if(null!==(r=tc)){if(0!==(42&(i=n&-n)))i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(0!==(i=0!==(i&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane)throw l.retryLane=i,Cr(e,i),Mc(r,e,i),Vo}"$?"===c.data||Wc(),t=la(e,t,n)}else"$?"===c.data?(t.flags|=128,t.child=e.child,t=au.bind(null,e),c._reactRetry=t,t=null):(e=l.treeContext,Yr=ah(c.nextSibling),Kr=t,Zr=!0,Qr=null,$r=!1,null!==e&&(Ur[zr++]=jr,Ur[zr++]=Vr,Ur[zr++]=Gr,jr=e.id,Vr=e.overflow,Gr=t),(t=oa(t,i.children)).flags|=4096);return t}return s?(Mi(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Dl(l,{mode:"hidden",children:i.children})).subtreeFlags=31457280&l.subtreeFlags,null!==u?s=Dl(u,s):(s=zl(s,c,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=ra(n):(null!==(l=c.cachePool)?(u=Ui._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Qi(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=ia(e,r,n),t.memoizedState=na,i):(ki(t),e=(n=e.child).sibling,(n=Dl(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function oa(e,t){return(t=aa({mode:"visible",children:t},e.mode)).return=e,e.child=t}function aa(e,t){return Gl(e,t,0,null)}function la(e,t,n){return Ei(t,e.child,null,n),(e=oa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ca(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ba(e.return,t,n)}function ua(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ha(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Ho(e,t,r.children,n),0!==(2&(r=Oi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ca(e,n,t);else if(19===e.tag)ca(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(K(Oi,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Ni(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ua(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ni(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ua(t,!0,n,null,s);break;case"together":ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function da(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),hc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(wa(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function fa(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Sa(e))}function pa(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Wo=!0;else{if(!fa(e,n)&&0===(128&t.flags))return Wo=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),va(t,Ui,e.memoizedState.cache),ii();break;case 27:case 5:te(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:va(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ki(t),t.flags|=128,null):0!==(n&t.child.childLanes)?sa(e,t,n):(ki(t),null!==(e=da(e,t,n))?e.sibling:null);ki(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(wa(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return ha(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),K(Oi,Oi.current),r)break;return null;case 22:case 23:return t.lanes=0,Yo(e,t,n);case 24:va(t,Ui,e.memoizedState.cache)}return da(e,t,n)}(e,t,n);Wo=0!==(131072&e.flags)}else Wo=!1,Zr&&0!==(1048576&t.flags)&&Hr(t,Br,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===_){t.tag=11,t=Xo(null,t,r,e,n);break e}if(i===b){t.tag=14,t=qo(null,t,r,e,n);break e}}throw t=R(r)||r,Error(o(306,t,""))}Fl(r)?(e=Io(r,e),t.tag=1,t=ea(null,t,r,e,n)):(t.tag=0,t=$o(null,t,r,e,n))}return t;case 0:return $o(e,t,t.type,t.pendingProps,n);case 1:return ea(e,t,r=t.type,i=Io(r,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(o(387));var s=t.pendingProps;r=(i=t.memoizedState).element,ka(e,t),Da(t,s,null,n);var a=t.memoizedState;if(s=a.cache,va(t,Ui,s),s!==i.cache&&Ea(t,[Ui],n,!0),Fa(),s=a.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=ta(e,t,s,n);break e}if(s!==r){si(r=Or(Error(o(424)),t)),t=ta(e,t,s,n);break e}for(Yr=ah(t.stateNode.containerInfo.firstChild),Kr=t,Zr=!0,Qr=null,$r=!0,n=wi(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ii(),s===r){t=da(e,t,n);break e}Ho(e,t,s,n)}t=t.child}return t;case 26:return Qo(e,t),null===e?(n=mh(t.type,null,t.pendingProps,null))?t.memoizedState=n:Zr||(n=t.type,e=t.pendingProps,(r=Yu(Q.current).createElement(n))[Be]=t,r[Ue]=e,Xu(r,n,e),Qe(r),t.stateNode=r):t.memoizedState=mh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return te(t),null===e&&Zr&&(r=t.stateNode=ch(t.type,t.pendingProps,Q.current),Kr=t,$r=!0,Yr=ah(r.firstChild)),r=t.pendingProps.children,null!==e||Zr?Ho(e,t,r,n):t.child=Ei(t,null,r,n),Qo(e,t),t.child;case 5:return null===e&&Zr&&((i=r=Yr)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[He])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=ah(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,$r))?(t.stateNode=r,Kr=t,Yr=ah(r.firstChild),$r=!1,i=!0):i=!1),i||ei(t)),te(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,r=s.children,$u(i,s)?r=null:null!==a&&$u(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=hs(e,t,ps,null,null,n),Fh._currentValue=i),Qo(e,t),Ho(e,t,r,n),t.child;case 6:return null===e&&Zr&&((e=n=Yr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=ah(e.nextSibling)))return null}return e}(n,t.pendingProps,$r))?(t.stateNode=n,Kr=t,Yr=null,e=!0):e=!1),e||ei(t)),null;case 13:return sa(e,t,n);case 4:return J(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ei(t,null,r,n):Ho(e,t,r,n),t.child;case 11:return Xo(e,t,t.type,t.pendingProps,n);case 7:return Ho(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ho(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,va(t,t.type,r.value),Ho(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ta(t),r=r(i=xa(i)),t.flags|=1,Ho(e,t,r,n),t.child;case 14:return qo(e,t,t.type,t.pendingProps,n);case 15:return Ko(e,t,t.type,t.pendingProps,n);case 19:return ha(e,t,n);case 22:return Yo(e,t,n);case 24:return Ta(t),r=xa(Ui),null===e?(null===(i=Yi())&&(i=tc,s=zi(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:r,cache:i},Ca(t),va(t,Ui,i)):(0!==(e.lanes&n)&&(ka(e,t),Da(t,null,null,n),Fa()),i=e.memoizedState,s=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),va(t,Ui,r)):(r=s.cache,va(t,Ui,r),r!==i.cache&&Ea(t,[Ui],n,!0))),Ho(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}var ga=X(null),ma=null,_a=null;function va(e,t,n){K(ga,t._currentValue),t._currentValue=n}function ya(e){e._currentValue=ga.current,q(ga)}function ba(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ea(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ba(s.return,n,e),r||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(o(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),ba(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function wa(e,t,n,r){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=i.type;Kn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===$.current){if(null===(a=i.alternate))throw Error(o(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Fh):e=[Fh])}i=i.return}null!==e&&Ea(t,e,n,r),t.flags|=262144}function Sa(e){for(e=e.firstContext;null!==e;){if(!Kn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ta(e){ma=e,_a=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function xa(e){return Ra(ma,e)}function Aa(e,t){return null===ma&&Ta(e),Ra(e,t)}function Ra(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===_a){if(null===e)throw Error(o(308));_a=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else _a=_a.next=t;return n}var Pa=!1;function Ca(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ka(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function La(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ma(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ec)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Lr(e),kr(e,null,n),t}return Rr(e,r,t,n),Lr(e)}function Ia(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function Oa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Na=!1;function Fa(){if(Na){if(null!==Hi)throw Hi}}function Da(e,t,n,r){Na=!1;var i=e.updateQueue;Pa=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=-536870913&a.lane,f=d!==a.lane;if(f?(rc&d)===d:(r&d)===d){0!==d&&d===Wi&&(Na=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var p=e,g=a;d=t;var m=n;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(m,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(m,h,d):p)||void 0===d)break e;h=L({},h,d);break e;case 2:Pa=!0}}null!==(d=a.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=i.callbacks)?i.callbacks=[d]:f.push(d))}else f={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(f=a).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),hc|=o,e.lanes=o,e.memoizedState=h}}function Ba(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function Ua(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ba(n[e],t)}function za(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var s=n.create,o=n.inst;r=s(),o.destroy=r}n=n.next}while(n!==i)}}catch(a){ru(t,t.return,a)}}function Ga(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var s=i.next;r=s;do{if((r.tag&e)===e){var o=r.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,i=t;var l=n;try{a()}catch(c){ru(i,l,c)}}}r=r.next}while(r!==s)}}catch(c){ru(t,t.return,c)}}function ja(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ua(t,n)}catch(r){ru(e,e.return,r)}}}function Va(e,t,n){n.props=Io(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){ru(e,t,r)}}function Wa(e,t){try{var n=e.ref;if(null!==n){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=r;break;default:i=r}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(s){ru(e,t,s)}}function Ha(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){ru(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){ru(e,t,s)}else n.current=null}function Xa(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){ru(e,e.return,i)}}function qa(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:r.hasOwnProperty(p)||Wu(e,t,p,null,r,d)}}for(var f in r){var p=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:p!==d&&Wu(e,t,f,p,r,d)}}return void mt(e,a,l,c,u,h,s,i);case"select":for(s in p=a=l=f=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||Wu(e,t,s,null,r,c)}for(i in r)if(s=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&Wu(e,t,i,s,r,c)}return t=l,n=a,r=p,void(null!=f?yt(e,!!n,f,!1):!!r!==!!n&&(null!=t?yt(e,!!n,t,!0):yt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Wu(e,t,l,null,r,i)}for(a in r)if(i=r[a],s=n[a],r.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==s&&Wu(e,t,a,i,r,s)}return void bt(e,f,p);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else Wu(e,t,g,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Wu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m)&&Wu(e,t,m,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:Wu(e,t,u,f,r,p)}return;default:if(At(t)){for(var _ in n)f=n[_],n.hasOwnProperty(_)&&void 0!==f&&!r.hasOwnProperty(_)&&Hu(e,t,_,void 0,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||Hu(e,t,h,f,r,p);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&null!=f&&!r.hasOwnProperty(v)&&Wu(e,t,v,null,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||null==f&&null==p||Wu(e,t,d,f,r,p)}(r,e.type,n,t),r[Ue]=t}catch(i){ru(e,e.return,i)}}function Ka(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag||4===e.tag}function Ya(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Ka(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&27!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Za(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Vu));else if(4!==r&&27!==r&&null!==(e=e.child))for(Za(e,t,n),e=e.sibling;null!==e;)Za(e,t,n),e=e.sibling}function Qa(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&27!==r&&null!==(e=e.child))for(Qa(e,t,n),e=e.sibling;null!==e;)Qa(e,t,n),e=e.sibling}var $a=!1,Ja=!1,el=!1,tl="function"===typeof WeakSet?WeakSet:Set,nl=null,rl=!1;function il(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:_l(e,n),4&r&&za(5,n);break;case 1:if(_l(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){ru(n,n.return,a)}else{var i=Io(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){ru(n,n.return,l)}}64&r&&ja(n),512&r&&Wa(n,n.return);break;case 3:if(_l(e,n),64&r&&null!==(r=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:e=n.child.stateNode}try{Ua(r,e)}catch(a){ru(n,n.return,a)}}break;case 26:_l(e,n),512&r&&Wa(n,n.return);break;case 27:case 5:_l(e,n),null===t&&4&r&&Xa(n),512&r&&Wa(n,n.return);break;case 12:default:_l(e,n);break;case 13:_l(e,n),4&r&&ul(e,n);break;case 22:if(!(i=null!==n.memoizedState||$a)){t=null!==t&&null!==t.memoizedState||Ja;var s=$a,o=Ja;$a=i,(Ja=t)&&!o?yl(e,n,0!==(8772&n.subtreeFlags)):_l(e,n),$a=s,Ja=o}512&r&&("manual"===n.memoizedProps.mode?Wa(n,n.return):Ha(n,n.return))}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ol=null,al=!1;function ll(e,t,n){for(n=n.child;null!==n;)cl(e,t,n),n=n.sibling}function cl(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(_e,n)}catch(o){}switch(n.tag){case 26:Ja||Ha(n,t),ll(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ja||Ha(n,t);var r=ol,i=al;for(ol=n.stateNode,ll(e,t,n),t=(n=n.stateNode).attributes;t.length;)n.removeAttributeNode(t[0]);Xe(n),ol=r,al=i;break;case 5:Ja||Ha(n,t);case 6:i=ol;var s=al;if(ol=null,ll(e,t,n),al=s,null!==(ol=i))if(al)try{e=ol,r=n.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)}catch(a){ru(n,t,a)}else try{ol.removeChild(n.stateNode)}catch(a){ru(n,t,a)}break;case 18:null!==ol&&(al?(t=ol,n=n.stateNode,8===t.nodeType?sh(t.parentNode,n):1===t.nodeType&&sh(t,n),gd(t)):sh(ol,n.stateNode));break;case 4:r=ol,i=al,ol=n.stateNode.containerInfo,al=!0,ll(e,t,n),ol=r,al=i;break;case 0:case 11:case 14:case 15:Ja||Ga(2,n,t),Ja||Ga(4,n,t),ll(e,t,n);break;case 1:Ja||(Ha(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&Va(n,t,r)),ll(e,t,n);break;case 21:ll(e,t,n);break;case 22:Ja||Ha(n,t),Ja=(r=Ja)||null!==n.memoizedState,ll(e,t,n),Ja=r;break;default:ll(e,t,n)}}function ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{gd(e)}catch(n){ru(t,t.return,n)}}function hl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new tl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new tl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach((function(t){var r=lu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function dl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:case 5:ol=l.stateNode,al=!1;break e;case 3:case 4:ol=l.stateNode.containerInfo,al=!0;break e}l=l.return}if(null===ol)throw Error(o(160));cl(s,a,i),ol=null,al=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}var fl=null;function pl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:dl(t,e),gl(e),4&r&&(Ga(3,e,e.return),za(3,e),Ga(5,e,e.return));break;case 1:dl(t,e),gl(e),512&r&&(Ja||null===n||Ha(n,n.return)),64&r&&$a&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=fl;if(dl(t,e),gl(e),512&r&&(Ja||null===n||Ha(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(s=i.getElementsByTagName("title")[0])||s[He]||s[Be]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(r),i.head.insertBefore(s,i.querySelector("head > title"))),Xu(s,r,n),s[Be]=e,Qe(s),r=s;break e;case"link":var a=Rh("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}Xu(s=i.createElement(r),r,n),i.head.appendChild(s);break;case"meta":if(a=Rh("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}Xu(s=i.createElement(r),r,n),i.head.appendChild(s);break;default:throw Error(o(468,r))}s[Be]=e,Qe(s),r=s}e.stateNode=r}else Ph(i,e.type,e.stateNode);else e.stateNode=wh(i,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?Ph(i,e.type,e.stateNode):wh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&qa(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(4&r&&null===e.alternate){i=e.stateNode,s=e.memoizedProps;try{for(var c=i.firstChild;c;){var u=c.nextSibling,h=c.nodeName;c[He]||"HEAD"===h||"BODY"===h||"SCRIPT"===h||"STYLE"===h||"LINK"===h&&"stylesheet"===c.rel.toLowerCase()||i.removeChild(c),c=u}for(var d=e.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);Xu(i,d,s),i[Be]=e,i[Ue]=s}catch(g){ru(e,e.return,g)}}case 5:if(dl(t,e),gl(e),512&r&&(Ja||null===n||Ha(n,n.return)),32&e.flags){i=e.stateNode;try{wt(i,"")}catch(g){ru(e,e.return,g)}}4&r&&null!=e.stateNode&&qa(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(el=!0);break;case 6:if(dl(t,e),gl(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(g){ru(e,e.return,g)}}break;case 3:if(Ah=null,i=fl,fl=dh(t.containerInfo),dl(t,e),fl=i,gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{gd(t.containerInfo)}catch(g){ru(e,e.return,g)}el&&(el=!1,ml(e));break;case 4:r=fl,fl=dh(e.stateNode.containerInfo),dl(t,e),gl(e),fl=r;break;case 12:dl(t,e),gl(e);break;case 13:dl(t,e),gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(yc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,hl(e,r)));break;case 22:if(512&r&&(Ja||null===n||Ha(n,n.return)),c=null!==e.memoizedState,u=null!==n&&null!==n.memoizedState,$a=(h=$a)||c,Ja=(d=Ja)||u,dl(t,e),Ja=d,$a=h,gl(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=c?-2&t._visibility:1|t._visibility,c&&(t=$a||Ja,null===n||u||t||vl(e)),null===e.memoizedProps||"manual"!==e.memoizedProps.mode))e:for(n=null,t=e;;){if(5===t.tag||26===t.tag||27===t.tag){if(null===n){u=n=t;try{if(i=u.stateNode,c)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{a=u.stateNode;var p=void 0!==(l=u.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null;a.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(g){ru(u,u.return,g)}}}else if(6===t.tag){if(null===n){u=t;try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(g){ru(u,u.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,hl(e,n))));break;case 19:dl(t,e),gl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,hl(e,r)));break;case 21:break;default:dl(t,e),gl(e)}}function gl(e){var t=e.flags;if(2&t){try{if(27!==e.tag){e:{for(var n=e.return;null!==n;){if(Ka(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 27:var i=r.stateNode;Qa(e,Ya(e),i);break;case 5:var s=r.stateNode;32&r.flags&&(wt(s,""),r.flags&=-33),Qa(e,Ya(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;Za(e,Ya(e),a);break;default:throw Error(o(161))}}}catch(l){ru(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function _l(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)il(e,t.alternate,t),t=t.sibling}function vl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ga(4,t,t.return),vl(t);break;case 1:Ha(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&Va(t,t.return,n),vl(t);break;case 26:case 27:case 5:Ha(t,t.return),vl(t);break;case 22:Ha(t,t.return),null===t.memoizedState&&vl(t);break;default:vl(t)}e=e.sibling}}function yl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:yl(i,s,n),za(4,s);break;case 1:if(yl(i,s,n),"function"===typeof(i=(r=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){ru(r,r.return,c)}if(null!==(i=(r=s).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Ba(l[i],a)}catch(c){ru(r,r.return,c)}}n&&64&o&&ja(s),Wa(s,s.return);break;case 26:case 27:case 5:yl(i,s,n),n&&null===r&&4&o&&Xa(s),Wa(s,s.return);break;case 12:default:yl(i,s,n);break;case 13:yl(i,s,n),n&&4&o&&ul(i,s);break;case 22:null===s.memoizedState&&yl(i,s,n),Wa(s,s.return)}t=t.sibling}}function bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Gi(n))}function El(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Gi(e))}function wl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Sl(e,t,n,r),t=t.sibling}function Sl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:wl(e,t,n,r),2048&i&&za(9,t);break;case 3:wl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Gi(e)));break;case 12:if(2048&i){wl(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ru(t,t.return,l)}}else wl(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,null!==t.memoizedState?4&s._visibility?wl(e,t,n,r):xl(e,t):4&s._visibility?wl(e,t,n,r):(s._visibility|=4,Tl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&bl(t.alternate,t);break;case 24:wl(e,t,n,r),2048&i&&El(t.alternate,t);break;default:wl(e,t,n,r)}}function Tl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,o=t,a=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:Tl(s,o,a,l,i),za(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?4&u._visibility?Tl(s,o,a,l,i):xl(s,o):(u._visibility|=4,Tl(s,o,a,l,i)),i&&2048&c&&bl(o.alternate,o);break;case 24:Tl(s,o,a,l,i),i&&2048&c&&El(o.alternate,o);break;default:Tl(s,o,a,l,i)}t=t.sibling}}function xl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:xl(n,r),2048&i&&bl(r.alternate,r);break;case 24:xl(n,r),2048&i&&El(r.alternate,r);break;default:xl(n,r)}t=t.sibling}}var Al=8192;function Rl(e){if(e.subtreeFlags&Al)for(e=e.child;null!==e;)Pl(e),e=e.sibling}function Pl(e){switch(e.tag){case 26:Rl(e),e.flags&Al&&null!==e.memoizedState&&function(e,t,n){if(null===kh)throw Error(o(475));var r=kh;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=_h(n.href),s=e.querySelector(vh(i));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Mh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=s,void Qe(s);s=e.ownerDocument||e,n=yh(n),(i=uh.get(i))&&Th(n,i),Qe(s=s.createElement("link"));var a=s;a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Xu(s,"link",n),t.instance=s}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Mh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(fl,e.memoizedState,e.memoizedProps);break;case 5:default:Rl(e);break;case 3:case 4:var t=fl;fl=dh(e.stateNode.containerInfo),Rl(e),fl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Al,Al=16777216,Rl(e),Al=t):Rl(e))}}function Cl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function kl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nl=r,Il(r,e)}Cl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Ll(e),e=e.sibling}function Ll(e){switch(e.tag){case 0:case 11:case 15:kl(e),2048&e.flags&&Ga(9,e,e.return);break;case 3:case 12:default:kl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Ml(e)):kl(e)}}function Ml(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nl=r,Il(r,e)}Cl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:Ga(8,t,t.return),Ml(t);break;case 22:4&(n=t.stateNode)._visibility&&(n._visibility&=-5,Ml(t));break;default:Ml(t)}e=e.sibling}}function Il(e,t){for(;null!==nl;){var n=nl;switch(n.tag){case 0:case 11:case 15:Ga(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Gi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,nl=r;else e:for(n=e;null!==nl;){var i=(r=nl).sibling,s=r.return;if(sl(r),r===n){nl=null;break e}if(null!==i){i.return=s,nl=i;break e}nl=s}}}function Ol(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nl(e,t,n,r){return new Ol(e,t,n,r)}function Fl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=Nl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=31457280&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Bl(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ul(e,t,n,r,i,s){var a=0;if(r=e,"function"===typeof e)Fl(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,Y.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case h:return zl(n.children,i,s,t);case d:a=8,i|=24;break;case f:return(e=Nl(12,n,t,2|i)).elementType=f,e.lanes=s,e;case v:return(e=Nl(13,n,t,i)).elementType=v,e.lanes=s,e;case y:return(e=Nl(19,n,t,i)).elementType=y,e.lanes=s,e;case w:return Gl(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:case m:a=10;break e;case g:a=9;break e;case _:a=11;break e;case b:a=14;break e;case E:a=16,r=null;break e}a=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Nl(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function zl(e,t,n,r){return(e=Nl(7,e,r,t)).lanes=n,e}function Gl(e,t,n,r){(e=Nl(22,e,r,t)).elementType=w,e.lanes=n;var i={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=i._current;if(null===e)throw Error(o(456));if(0===(2&i._pendingVisibility)){var t=Cr(e,2);null!==t&&(i._pendingVisibility|=2,Mc(t,e,2))}},attach:function(){var e=i._current;if(null===e)throw Error(o(456));if(0!==(2&i._pendingVisibility)){var t=Cr(e,2);null!==t&&(i._pendingVisibility&=-3,Mc(t,e,2))}}};return e.stateNode=i,e}function jl(e,t,n){return(e=Nl(6,e,null,t)).lanes=n,e}function Vl(e,t,n){return(t=Nl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wl(e){e.flags|=4}function Hl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Ch(t)){if(null!==(t=Pi.current)&&((4194176&rc)===rc?null!==Ci:(62914560&rc)!==rc&&0===(536870912&rc)||t!==Ci))throw di=li,ai;e.flags|=8192}}function Xl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,gc|=t)}function ql(e,t){if(!Zr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Kl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=31457280&i.subtreeFlags,r|=31457280&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Yl(e,t,n){var r=t.pendingProps;switch(qr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return Kl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ya(Ui),ee(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ri(t)?Wl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Qr&&(Oc(Qr),Qr=null))),Kl(t),null;case 26:return n=t.memoizedState,null===e?(Wl(t),null!==n?(Kl(t),Hl(t,n)):(Kl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Wl(t),Kl(t),Hl(t,n)):(Kl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Wl(t),Kl(t),t.flags&=-16777217),null;case 27:ne(t),n=Q.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Kl(t),null}e=Y.current,ri(t)?ti(t):(e=ch(i,r,n),t.stateNode=e,Wl(t))}return Kl(t),null;case 5:if(ne(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Kl(t),null}if(e=Y.current,ri(t))ti(t);else{switch(i=Yu(Q.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Be]=t,e[Ue]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(Xu(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Wl(t)}}return Kl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=Q.current,ri(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=Kr))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||ju(e.nodeValue,n)))||ei(t)}else(e=Yu(e).createTextNode(r))[Be]=t,t.stateNode=e}return Kl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ri(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[Be]=t}else ii(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Kl(t),i=!1}else null!==Qr&&(Oc(Qr),Qr=null),i=!0;if(!i)return 256&t.flags?(Ii(t),t):(Ii(t),null)}if(Ii(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Xl(t,t.updateQueue),Kl(t),null;case 4:return ee(),null===e&&Mu(t.stateNode.containerInfo),Kl(t),null;case 10:return ya(t.type),Kl(t),null;case 19:if(q(Oi),null===(i=t.memoizedState))return Kl(t),null;if(r=0!==(128&t.flags),null===(s=i.rendering))if(r)ql(i,!1);else{if(0!==uc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Ni(e))){for(t.flags|=128,ql(i,!1),e=s.updateQueue,t.updateQueue=e,Xl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Bl(n,e),n=n.sibling;return K(Oi,1&Oi.current|2),t.child}e=e.sibling}null!==i.tail&&le()>bc&&(t.flags|=128,r=!0,ql(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Ni(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Xl(t,e),ql(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!Zr)return Kl(t),null}else 2*le()-i.renderingStartTime>bc&&536870912!==n&&(t.flags|=128,r=!0,ql(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=le(),t.sibling=null,e=Oi.current,K(Oi,r?1&e|2:1&e),t):(Kl(t),null);case 22:case 23:return Ii(t),Ri(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(Kl(t),6&t.subtreeFlags&&(t.flags|=8192)):Kl(t),null!==(n=t.updateQueue)&&Xl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&q(Ki),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ya(Ui),Kl(t),null;case 25:return null}throw Error(o(156,t.tag))}function Zl(e,t){switch(qr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ya(Ui),ee(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ne(t),null;case 13:if(Ii(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));ii()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return q(Oi),null;case 4:return ee(),null;case 10:return ya(t.type),null;case 22:case 23:return Ii(t),Ri(),null!==e&&q(Ki),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return ya(Ui),null;default:return null}}function Ql(e,t){switch(qr(t),t.tag){case 3:ya(Ui),ee();break;case 26:case 27:case 5:ne(t);break;case 4:ee();break;case 13:Ii(t);break;case 19:q(Oi);break;case 10:ya(t.type);break;case 22:case 23:Ii(t),Ri(),null!==e&&q(Ki);break;case 24:ya(Ui)}}var $l={getCacheForType:function(e){var t=xa(Ui),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},Jl="function"===typeof WeakMap?WeakMap:Map,ec=0,tc=null,nc=null,rc=0,ic=0,sc=null,oc=!1,ac=!1,lc=!1,cc=0,uc=0,hc=0,dc=0,fc=0,pc=0,gc=0,mc=null,_c=null,vc=!1,yc=0,bc=1/0,Ec=null,wc=null,Sc=!1,Tc=null,xc=0,Ac=0,Rc=null,Pc=0,Cc=null;function kc(){if(0!==(2&ec)&&0!==rc)return rc&-rc;if(null!==k.T){return 0!==Wi?Wi:Eu()}return Fe()}function Lc(){0===pc&&(pc=0===(536870912&rc)||Zr?Ce():536870912);var e=Pi.current;return null!==e&&(e.flags|=32),pc}function Mc(e,t,n){(e===tc&&2===ic||null!==e.cancelPendingCommit)&&(zc(e,0),Dc(e,rc,pc,!1)),Me(e,n),0!==(2&ec)&&e===tc||(e===tc&&(0===(2&ec)&&(dc|=n),4===uc&&Dc(e,rc,pc,!1)),gu(e))}function Ic(e,t,n){if(0!==(6&ec))throw Error(o(327));for(var r=!n&&0===(60&t)&&0===(t&e.expiredLanes)||Re(e,t),i=r?function(e,t){var n=ec;ec|=2;var r=jc(),i=Vc();tc!==e||rc!==t?(Ec=null,bc=le()+500,zc(e,t)):ac=Re(e,t);e:for(;;)try{if(0!==ic&&null!==nc){t=nc;var s=sc;t:switch(ic){case 1:ic=0,sc=null,Zc(e,t,s,1);break;case 2:if(ci(s)){ic=0,sc=null,Yc(t);break}t=function(){2===ic&&tc===e&&(ic=7),gu(e)},s.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:ci(s)?(ic=0,sc=null,Yc(t)):(ic=0,sc=null,Zc(e,t,s,7));break;case 5:var a=null;switch(nc.tag){case 26:a=nc.memoizedState;case 5:case 27:var l=nc;if(!a||Ch(a)){ic=0,sc=null;var c=l.sibling;if(null!==c)nc=c;else{var u=l.return;null!==u?(nc=u,Qc(u)):nc=null}break t}}ic=0,sc=null,Zc(e,t,s,5);break;case 6:ic=0,sc=null,Zc(e,t,s,6);break;case 8:Uc(),uc=6;break e;default:throw Error(o(462))}}qc();break}catch(h){Gc(e,h)}return _a=ma=null,k.H=r,k.A=i,ec=n,null!==nc?0:(tc=null,rc=0,Ar(),uc)}(e,t):Hc(e,t,!0),s=r;;){if(0===i){ac&&!r&&Dc(e,t,0,!1);break}if(6===i)Dc(e,t,0,!oc);else{if(n=e.current.alternate,s&&!Fc(n)){i=Hc(e,t,!1),s=!1;continue}if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=mc;var c=l.current.memoizedState.isDehydrated;if(c&&(zc(l,a).flags|=256),2!==(a=Hc(l,a,!1))){if(lc&&!c){l.errorRecoveryDisabledLanes|=s,dc|=s,i=4;break e}s=_c,_c=i,null!==s&&Oc(s)}i=a}if(s=!1,2!==i)continue}}if(1===i){zc(e,0),Dc(e,t,0,!0);break}e:{switch(r=e,i){case 0:case 1:throw Error(o(345));case 4:if((4194176&t)===t){Dc(r,t,pc,!oc);break e}break;case 2:_c=null;break;case 3:case 5:break;default:throw Error(o(329))}if(r.finishedWork=n,r.finishedLanes=t,(62914560&t)===t&&10<(s=yc+300-le())){if(Dc(r,t,pc,!oc),0!==Ae(r,0))break e;r.timeoutHandle=eh(Nc.bind(null,r,n,_c,Ec,vc,t,pc,dc,gc,oc,2,-0,0),s)}else Nc(r,n,_c,Ec,vc,t,pc,dc,gc,oc,0,-0,0)}}break}gu(e)}function Oc(e){null===_c?_c=e:_c.push.apply(_c,e)}function Nc(e,t,n,r,i,s,a,l,c,u,h,d,f){var p=t.subtreeFlags;if((8192&p||16785408===(16785408&p))&&(kh={stylesheets:null,count:0,unsuspend:Lh},Pl(t),null!==(t=function(){if(null===kh)throw Error(o(475));var e=kh;return e.stylesheets&&0===e.count&&Oh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Oh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=t(Jc.bind(null,e,n,r,i,a,l,c,1,d,f)),void Dc(e,s,a,!u);Jc(e,n,r,i,a,l,c,h,d,f)}function Fc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Kn(s(),i))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dc(e,t,n,r){t&=~fc,t&=~dc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var s=31-be(i),o=1<<s;r[s]=-1,i&=~o}0!==n&&Ie(e,n,t)}function Bc(){return 0!==(6&ec)||(mu(0,!1),!1)}function Uc(){if(null!==nc){if(0===ic)var e=nc.return;else _a=ma=null,_s(e=nc),pi=null,gi=0,e=nc;for(;null!==e;)Ql(e.alternate,e),e=e.return;nc=null}}function zc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,th(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Uc(),tc=e,nc=n=Dl(e.current,null),rc=t,ic=0,sc=null,oc=!1,ac=Re(e,t),lc=!1,gc=pc=fc=dc=hc=uc=0,_c=mc=null,vc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-be(r),s=1<<i;t|=e[i],r&=~s}return cc=t,Ar(),n}function Gc(e,t){Ji=null,k.H=xo,t===oi?(t=fi(),ic=3):t===ai?(t=fi(),ic=4):ic=t===Vo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,sc=t,null===nc&&(uc=1,Bo(e,Or(t,e.current)))}function jc(){var e=k.H;return k.H=xo,null===e?xo:e}function Vc(){var e=k.A;return k.A=$l,e}function Wc(){uc=4,oc||(4194176&rc)!==rc&&null!==Pi.current||(ac=!0),0===(134217727&hc)&&0===(134217727&dc)||null===tc||Dc(tc,rc,pc,!1)}function Hc(e,t,n){var r=ec;ec|=2;var i=jc(),s=Vc();tc===e&&rc===t||(Ec=null,zc(e,t)),t=!1;var o=uc;e:for(;;)try{if(0!==ic&&null!==nc){var a=nc,l=sc;switch(ic){case 8:Uc(),o=6;break e;case 3:case 2:case 6:null===Pi.current&&(t=!0);var c=ic;if(ic=0,sc=null,Zc(e,a,l,c),n&&ac){o=0;break e}break;default:c=ic,ic=0,sc=null,Zc(e,a,l,c)}}Xc(),o=uc;break}catch(u){Gc(e,u)}return t&&e.shellSuspendCounter++,_a=ma=null,ec=r,k.H=i,k.A=s,null===nc&&(tc=null,rc=0,Ar()),o}function Xc(){for(;null!==nc;)Kc(nc)}function qc(){for(;null!==nc&&!oe();)Kc(nc)}function Kc(e){var t=pa(e.alternate,e,cc);e.memoizedProps=e.pendingProps,null===t?Qc(e):nc=t}function Yc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Jo(n,t,t.pendingProps,t.type,void 0,rc);break;case 11:t=Jo(n,t,t.pendingProps,t.type.render,t.ref,rc);break;case 5:_s(t);default:Ql(n,t),t=pa(n,t=nc=Bl(t,cc),cc)}e.memoizedProps=e.pendingProps,null===t?Qc(e):nc=t}function Zc(e,t,n,r){_a=ma=null,_s(t),pi=null,gi=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&wa(t,n,i,!0),null!==(n=Pi.current)){switch(n.tag){case 13:return null===Ci?Wc():null===n.alternate&&0===uc&&(uc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===li?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),iu(e,r,i)),!1;case 22:return n.flags|=65536,r===li?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),iu(e,r,i)),!1}throw Error(o(435,n.tag))}return iu(e,r,i),Wc(),!1}if(Zr)return null!==(t=Pi.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==Jr&&si(Or(e=Error(o(422),{cause:r}),n))):(r!==Jr&&si(Or(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Or(r,n),Oa(e,i=zo(e.stateNode,r,i)),4!==uc&&(uc=2)),!1;var s=Error(o(520),{cause:r});if(s=Or(s,n),null===mc?mc=[s]:mc.push(s),4!==uc&&(uc=2),null===t)return!0;r=Or(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,Oa(n,e=zo(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===wc||!wc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,jo(i=Go(i),e,n,r),Oa(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,rc))return uc=1,Bo(e,Or(n,e.current)),void(nc=null)}catch(s){if(null!==i)throw nc=i,s;return uc=1,Bo(e,Or(n,e.current)),void(nc=null)}32768&t.flags?(Zr||1===r?e=!0:ac||0!==(536870912&rc)?e=!1:(oc=e=!0,(2===r||3===r||6===r)&&(null!==(r=Pi.current)&&13===r.tag&&(r.flags|=16384))),$c(t,e)):Qc(t)}function Qc(e){var t=e;do{if(0!==(32768&t.flags))return void $c(t,oc);e=t.return;var n=Yl(t.alternate,t,cc);if(null!==n)return void(nc=n);if(null!==(t=t.sibling))return void(nc=t);nc=t=e}while(null!==t);0===uc&&(uc=5)}function $c(e,t){do{var n=Zl(e.alternate,e);if(null!==n)return n.flags&=32767,void(nc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(nc=e);nc=e=n}while(null!==e);uc=6,nc=null}function Jc(e,t,n,r,i,s,a,l,c,u){var h=k.T,d=j.p;try{j.p=2,k.T=null,function(e,t,n,r,i,s,a,l){do{tu()}while(null!==Tc);if(0!==(6&ec))throw Error(o(327));var c=e.finishedWork;if(r=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=c.lanes|c.childLanes;if(function(e,t,n,r,i,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-be(n),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&Ie(e,r,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,r,u|=xr,s,a,l),e===tc&&(nc=tc=null,rc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||Sc||(Sc=!0,Ac=u,Rc=n,function(e,t){ie(e,t)}(de,(function(){return tu(),null}))),n=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||n?(n=k.T,k.T=null,s=j.p,j.p=2,a=ec,ec|=4,function(e,t){if(e=e.containerInfo,qu=Wh,er(e=Jn(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(m){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==s||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ku={focusedElem:e,selectionRange:n},Wh=!1,nl=t;null!==nl;)if(e=(t=nl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,nl=e;else for(;null!==nl;){switch(s=(t=nl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var g=Io(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(g,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(_){ru(n,n.return,_)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))oh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":oh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,nl=e;break}nl=t.return}g=rl,rl=!1}(e,c),pl(c,e),tr(Ku,e.containerInfo),Wh=!!qu,Ku=qu=null,e.current=c,il(e,c.alternate,c),ae(),ec=a,j.p=s,k.T=n):e.current=c,Sc?(Sc=!1,Tc=e,xc=r):eu(e,u),u=e.pendingLanes,0===u&&(wc=null),function(e){if(ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(_e,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),gu(e),null!==t)for(i=e.onRecoverableError,c=0;c<t.length;c++)u=t[c],i(u.value,{componentStack:u.stack});0!==(3&xc)&&tu(),u=e.pendingLanes,0!==(4194218&r)&&0!==(42&u)?e===Cc?Pc++:(Pc=0,Cc=e):Pc=0,mu(0,!1)}(e,t,n,r,d,i,s,a)}finally{k.T=h,j.p=d}}function eu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Gi(t)))}function tu(){if(null!==Tc){var e=Tc,t=Ac;Ac=0;var n=Ne(xc),r=k.T,i=j.p;try{if(j.p=32>n?32:n,k.T=null,null===Tc)var s=!1;else{n=Rc,Rc=null;var a=Tc,l=xc;if(Tc=null,xc=0,0!==(6&ec))throw Error(o(331));var c=ec;if(ec|=4,Ll(a.current),Sl(a,a.current,l,n),ec=c,mu(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(_e,a)}catch(u){}s=!0}return s}finally{j.p=i,k.T=r,eu(e,t)}}return!1}function nu(e,t,n){t=Or(n,t),null!==(e=Ma(e,t=zo(e.stateNode,t,2),2))&&(Me(e,2),gu(e))}function ru(e,t,n){if(3===e.tag)nu(e,e,n);else for(;null!==t;){if(3===t.tag){nu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===wc||!wc.has(r))){e=Or(n,e),null!==(r=Ma(t,n=Go(2),2))&&(jo(n,r,t,e),Me(r,2),gu(r));break}}t=t.return}}function iu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Jl;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(lc=!0,i.add(n),e=su.bind(null,e,t,n),t.then(e,e))}function su(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,tc===e&&(rc&n)===n&&(4===uc||3===uc&&(62914560&rc)===rc&&300>le()-yc?0===(2&ec)&&zc(e,0):fc|=n,gc===rc&&(gc=0)),gu(e)}function ou(e,t){0===t&&(t=ke()),null!==(e=Cr(e,t))&&(Me(e,t),gu(e))}function au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ou(e,n)}function lu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),ou(e,n)}var cu=null,uu=null,hu=!1,du=!1,fu=!1,pu=0;function gu(e){var t;e!==uu&&null===e.next&&(null===uu?cu=uu=e:uu=uu.next=e),du=!0,hu||(hu=!0,t=_u,rh((function(){0!==(6&ec)?ie(ue,t):t()})))}function mu(e,t){if(!fu&&du){fu=!0;do{for(var n=!1,r=cu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var s=0;else{var o=r.suspendedLanes,a=r.pingedLanes;s=(1<<31-be(42|e)+1)-1,s=201326677&(s&=i&~(o&~a))?201326677&s|1:s?2|s:0}0!==s&&(n=!0,bu(r,s))}else s=rc,0===(3&(s=Ae(r,r===tc?s:0)))||Re(r,s)||(n=!0,bu(r,s));r=r.next}}while(n);fu=!1}}function _u(){du=hu=!1;var e=0;0!==pu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Ju&&(Ju=e,!0);return Ju=null,!1}()&&(e=pu),pu=0);for(var t=le(),n=null,r=cu;null!==r;){var i=r.next,s=vu(r,t);0===s?(r.next=null,null===n?cu=i:n.next=i,null===i&&(uu=n)):(n=r,(0!==e||0!==(3&s))&&(du=!0)),r=i}mu(e,!1)}function vu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-be(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=Pe(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(n=rc,n=Ae(e,e===(t=tc)?n:0),r=e.callbackNode,0===n||e===t&&2===ic||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Re(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),Ne(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=pe}return r=yu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function yu(e,t){var n=e.callbackNode;if(tu()&&e.callbackNode!==n)return null;var r=rc;return 0===(r=Ae(e,e===tc?r:0))?null:(Ic(e,r,t),vu(e,le()),null!=e.callbackNode&&e.callbackNode===n?yu.bind(null,e):null)}function bu(e,t){if(tu())return null;Ic(e,t,!0)}function Eu(){return 0===pu&&(pu=Ce()),pu}function wu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Ct(""+e)}function Su(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Tu=0;Tu<Er.length;Tu++){var xu=Er[Tu];wr(xu.toLowerCase(),"on"+(xu[0].toUpperCase()+xu.slice(1)))}wr(fr,"onAnimationEnd"),wr(pr,"onAnimationIteration"),wr(gr,"onAnimationStart"),wr("dblclick","onDoubleClick"),wr("focusin","onFocus"),wr("focusout","onBlur"),wr(mr,"onTransitionRun"),wr(_r,"onTransitionStart"),wr(vr,"onTransitionCancel"),wr(yr,"onTransitionEnd"),tt("onMouseEnter",["mouseout","mouseover"]),tt("onMouseLeave",["mouseout","mouseover"]),tt("onPointerEnter",["pointerout","pointerover"]),tt("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ru=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Au));function Pu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){Oo(u)}i.currentTarget=null,s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){Oo(u)}i.currentTarget=null,s=l}}}}function Cu(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(Iu(t,e,2,!1),n.add(r))}function ku(e,t,n){var r=0;t&&(r|=4),Iu(n,e,r,t)}var Lu="_reactListening"+Math.random().toString(36).slice(2);function Mu(e){if(!e[Lu]){e[Lu]=!0,$e.forEach((function(t){"selectionchange"!==t&&(Ru.has(t)||ku(t,!1,e),ku(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Lu]||(t[Lu]=!0,ku("selectionchange",!1,t))}}function Iu(e,t,n,r){switch(Qh(t)){case 2:var i=Hh;break;case 8:i=Xh;break;default:i=qh}n=i.bind(null,t,n,e),i=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Ou(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=qe(a)))return;if(5===(l=o.tag)||6===l||26===l||27===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Ft((function(){var r=s,i=Lt(n),o=[];e:{var a=br.get(e);if(void 0!==a){var l=$t,c=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":l=pn;break;case"focusin":c="focus",l=sn;break;case"focusout":c="blur",l=sn;break;case"beforeblur":case"afterblur":l=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=nn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=mn;break;case fr:case pr:case gr:l=on;break;case yr:l=_n;break;case"scroll":case"scrollend":l=en;break;case"wheel":l=vn;break;case"copy":case"cut":case"paste":l=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=gn;break;case"toggle":case"beforetoggle":l=yn}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=p;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===d||null!=(g=Dt(p,d))&&u.push(Nu(p,g,f)),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===kt||!(c=n.relatedTarget||n.fromElement)||!qe(c)&&!c[ze])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?qe(c):null)&&(h=D(c),u=c.tag,c!==h||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=r),l!==c)){if(u=nn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=gn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:Ye(l),f=null==c?a:Ye(c),(a=new u(g,p+"leave",l,n,i)).target=h,a.relatedTarget=f,g=null,qe(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Du(f))p++;for(f=0,g=d;g;g=Du(g))f++;for(;0<p-f;)u=Du(u),p--;for(;0<f-p;)d=Du(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Du(u),d=Du(d)}u=null}else u=null;null!==l&&Bu(o,a,l,u,!1),null!==c&&null!==h&&Bu(o,h,c,u,!0)}if("select"===(l=(a=r?Ye(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Dn;else if(Ln(a))if(Bn)m=qn;else{m=Hn;var _=Wn}else!(l=a.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&At(r.elementType)&&(m=Dn):m=Xn;switch(m&&(m=m(e,r))?Mn(o,m,n,i):(_&&_(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&vt(a,"number",a.value)),_=r?Ye(r):window,e){case"focusin":(Ln(_)||"true"===_.contentEditable)&&(rr=_,ir=r,sr=null);break;case"focusout":sr=ir=rr=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,ar(o,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(o,n,i)}var v;if(En)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Cn?Rn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Tn&&"ko"!==n.locale&&(Cn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Cn&&(v=Vt()):(Gt="value"in(zt=i)?zt.value:zt.textContent,Cn=!0)),0<(_=Fu(r,y)).length&&(y=new ln(y,e,null,n,i),o.push({event:y,listeners:_}),v?y.data=v:null!==(v=Pn(n))&&(y.data=v))),(v=Sn?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(An=!0,xn);case"textInput":return(e=t.data)===xn&&An?null:e;default:return null}}(e,n):function(e,t){if(Cn)return"compositionend"===e||!En&&Rn(e,t)?(e=Vt(),jt=Gt=zt=null,Cn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(y=Fu(r,"onBeforeInput")).length&&(_=new ln("onBeforeInput","beforeinput",null,n,i),o.push({event:_,listeners:y}),_.data=v)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var s=wu((i[Ue]||null).action),o=r.submitter;o&&null!==(t=(t=o[Ue]||null)?wu(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new $t("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==pu){var e=o?Su(i,o):new FormData(i);uo(n,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Su(i,o):new FormData(i),uo(n,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(o,e,r,n,i)}Pu(o,t)}))}function Nu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=Dt(e,n))&&r.unshift(Nu(e,i,s)),null!=(i=Dt(e,t))&&r.push(Nu(e,i,s))),e=e.return}return r}function Du(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Bu(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=Dt(n,s))&&o.unshift(Nu(n,c,l)):i||null!=(c=Dt(n,s))&&o.push(Nu(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Uu=/\r\n?/g,zu=/\u0000|\uFFFD/g;function Gu(e){return("string"===typeof e?e:""+e).replace(Uu,"\n").replace(zu,"")}function ju(e,t){return t=Gu(t),Gu(e)===t}function Vu(){}function Wu(e,t,n,r,i,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||wt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&wt(e,""+r);break;case"className":at(e,"class",r);break;case"tabIndex":at(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":at(e,n,r);break;case"style":xt(e,r,s);break;case"data":if("object"!==t){at(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Ct(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Wu(e,t,"name",i.name,i,null),Wu(e,t,"formEncType",i.formEncType,i,null),Wu(e,t,"formMethod",i.formMethod,i,null),Wu(e,t,"formTarget",i.formTarget,i,null)):(Wu(e,t,"encType",i.encType,i,null),Wu(e,t,"method",i.method,i,null),Wu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Ct(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Vu);break;case"onScroll":null!=r&&Cu("scroll",e);break;case"onScrollEnd":null!=r&&Cu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Ct(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Cu("beforetoggle",e),Cu("toggle",e),ot(e,"popover",r);break;case"xlinkActuate":lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":lt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":lt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":lt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":lt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ot(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ot(e,n=Rt.get(n)||n,r)}}function Hu(e,t,n,r,i,s){switch(n){case"style":xt(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?wt(e,r):("number"===typeof r||"bigint"===typeof r)&&wt(e,""+r);break;case"onScroll":null!=r&&Cu("scroll",e);break;case"onScrollEnd":null!=r&&Cu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Vu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Je.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(s=null!=(s=e[Ue]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ot(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function Xu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cu("error",e),Cu("load",e);var r,i=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Wu(e,t,r,a,n,null)}}return s&&Wu(e,t,"srcSet",n.srcSet,n,null),void(i&&Wu(e,t,"src",n.src,n,null));case"input":Cu("invalid",e);var l=r=a=s=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":s=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(o(137,t));break;default:Wu(e,t,i,h,n,null)}}return _t(e,r,l,c,u,a,s,!1),void ht(e);case"select":for(s in Cu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Wu(e,t,s,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?yt(e,!!i,t,!1):null!=n&&yt(e,!!i,n,!0));case"textarea":for(a in Cu("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Wu(e,t,a,l,n,null)}return Et(e,i,s,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Wu(e,t,c,i,n,null);return;case"dialog":Cu("cancel",e),Cu("close",e);break;case"iframe":case"object":Cu("load",e);break;case"video":case"audio":for(i=0;i<Au.length;i++)Cu(Au[i],e);break;case"image":Cu("error",e),Cu("load",e);break;case"details":Cu("toggle",e);break;case"embed":case"source":case"link":Cu("error",e),Cu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Wu(e,t,u,i,n,null)}return;default:if(At(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&Hu(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Wu(e,t,l,i,n,null))}var qu=null,Ku=null;function Yu(e){return 9===e.nodeType?e:e.ownerDocument}function Zu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function $u(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Ju=null;var eh="function"===typeof setTimeout?setTimeout:void 0,th="function"===typeof clearTimeout?clearTimeout:void 0,nh="function"===typeof Promise?Promise:void 0,rh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nh?function(e){return nh.resolve(null).then(e).catch(ih)}:eh;function ih(e){setTimeout((function(){throw e}))}function sh(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void gd(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);gd(t)}function oh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":oh(n),Xe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function ah(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function lh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function ch(e,t,n){switch(t=Yu(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}var uh=new Map,hh=new Set;function dh(e){return"function"===typeof e.getRootNode?e.getRootNode():e.ownerDocument}var fh=j.d;j.d={f:function(){var e=fh.f(),t=Bc();return e||t},r:function(e){var t=Ke(e);null!==t&&5===t.tag&&"form"===t.type?fo(t):fh.r(e)},D:function(e){fh.D(e),gh("dns-prefetch",e,null)},C:function(e,t){fh.C(e,t),gh("preconnect",e,t)},L:function(e,t,n){fh.L(e,t,n);var r=ph;if(r&&e&&t){var i='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+gt(n.imageSizes)+'"]')):i+='[href="'+gt(e)+'"]';var s=i;switch(t){case"style":s=_h(e);break;case"script":s=bh(e)}uh.has(s)||(e=L({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),uh.set(s,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(vh(s))||"script"===t&&r.querySelector(Eh(s))||(Xu(t=r.createElement("link"),"link",e),Qe(t),r.head.appendChild(t)))}},m:function(e,t){fh.m(e,t);var n=ph;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+gt(r)+'"][href="'+gt(e)+'"]',s=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=bh(e)}if(!uh.has(s)&&(e=L({rel:"modulepreload",href:e},t),uh.set(s,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Eh(s)))return}Xu(r=n.createElement("link"),"link",e),Qe(r),n.head.appendChild(r)}}},X:function(e,t){fh.X(e,t);var n=ph;if(n&&e){var r=Ze(n).hoistableScripts,i=bh(e),s=r.get(i);s||((s=n.querySelector(Eh(i)))||(e=L({src:e,async:!0},t),(t=uh.get(i))&&xh(e,t),Qe(s=n.createElement("script")),Xu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}},S:function(e,t,n){fh.S(e,t,n);var r=ph;if(r&&e){var i=Ze(r).hoistableStyles,s=_h(e);t=t||"default";var o=i.get(s);if(!o){var a={loading:0,preload:null};if(o=r.querySelector(vh(s)))a.loading=5;else{e=L({rel:"stylesheet",href:e,"data-precedence":t},n),(n=uh.get(s))&&Th(e,n);var l=o=r.createElement("link");Qe(l),Xu(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Sh(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:a},i.set(s,o)}}},M:function(e,t){fh.M(e,t);var n=ph;if(n&&e){var r=Ze(n).hoistableScripts,i=bh(e),s=r.get(i);s||((s=n.querySelector(Eh(i)))||(e=L({src:e,async:!0,type:"module"},t),(t=uh.get(i))&&xh(e,t),Qe(s=n.createElement("script")),Xu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}}};var ph="undefined"===typeof document?null:document;function gh(e,t,n){var r=ph;if(r&&"string"===typeof t&&t){var i=gt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),hh.has(i)||(hh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(Xu(t=r.createElement("link"),"link",e),Qe(t),r.head.appendChild(t)))}}function mh(e,t,n,r){var i,s,a,l,c=(c=Q.current)?dh(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=_h(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=_h(n.href);var u=Ze(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(vh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),uh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},uh.set(e,n),u||(i=c,s=e,a=n,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",(function(){return l.loading|=1})),s.addEventListener("error",(function(){return l.loading|=2})),Xu(s,"link",a),Qe(s),i.head.appendChild(s))))),t&&null===r)throw Error(o(528,""));return h}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=bh(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function _h(e){return'href="'+gt(e)+'"'}function vh(e){return'link[rel="stylesheet"]['+e+"]"}function yh(e){return L({},e,{"data-precedence":e.precedence,precedence:null})}function bh(e){return'[src="'+gt(e)+'"]'}function Eh(e){return"script[async]"+e}function wh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(r)return t.instance=r,Qe(r),r;var i=L({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Qe(r=(e.ownerDocument||e).createElement("style")),Xu(r,"style",i),Sh(r,n.precedence,e),t.instance=r;case"stylesheet":i=_h(n.href);var s=e.querySelector(vh(i));if(s)return t.state.loading|=4,t.instance=s,Qe(s),s;r=yh(n),(i=uh.get(i))&&Th(r,i),Qe(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Xu(s,"link",r),t.state.loading|=4,Sh(s,n.precedence,e),t.instance=s;case"script":return s=bh(n.src),(i=e.querySelector(Eh(s)))?(t.instance=i,Qe(i),i):(r=n,(i=uh.get(s))&&xh(r=L({},n),i),Qe(i=(e=e.ownerDocument||e).createElement("script")),Xu(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Sh(r,n.precedence,e));return t.instance}function Sh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,s=i,o=0;o<r.length;o++){var a=r[o];if(a.dataset.precedence===t)s=a;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Th(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function xh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ah=null;function Rh(e,t,n){if(null===Ah){var r=new Map,i=Ah=new Map;i.set(n,r)}else(r=(i=Ah).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var s=n[i];if(!(s[He]||s[Be]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=r.get(o);a?a.push(s):r.set(o,[s])}}return r}function Ph(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Ch(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var kh=null;function Lh(){}function Mh(){if(this.count--,0===this.count)if(this.stylesheets)Oh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Ih=null;function Oh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Ih=new Map,t.forEach(Nh,e),Ih=null,Mh.call(e))}function Nh(e,t){if(!(4&t.state.loading)){var n=Ih.get(e);if(n)var r=n.get(null);else{n=new Map,Ih.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var o=i[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(i=t.instance).getAttribute("data-precedence"),(s=n.get(o)||r)===r&&n.set(null,i),n.set(o,i),this.count++,r=Mh.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Fh={$$typeof:m,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Dh(e,t,n,r,i,s,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Le(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Le(0),this.hiddenUpdates=Le(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Bh(e,t,n,r,i,s,o,a,l,c,u,h){return e=new Dh(e,t,n,o,a,l,c,h),t=1,!0===s&&(t|=24),s=Nl(3,null,null,t),e.current=s,s.stateNode=e,(t=zi()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},Ca(s),e}function Uh(e){return e?e=Mr:Mr}function zh(e,t,n,r,i,s){i=Uh(i),null===r.context?r.context=i:r.pendingContext=i,(r=La(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=Ma(e,r,t))&&(Mc(n,0,t),Ia(n,e,t))}function Gh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function jh(e,t){Gh(e,t),(e=e.alternate)&&Gh(e,t)}function Vh(e){if(13===e.tag){var t=Cr(e,67108864);null!==t&&Mc(t,0,67108864),jh(e,67108864)}}var Wh=!0;function Hh(e,t,n,r){var i=k.T;k.T=null;var s=j.p;try{j.p=2,qh(e,t,n,r)}finally{j.p=s,k.T=i}}function Xh(e,t,n,r){var i=k.T;k.T=null;var s=j.p;try{j.p=8,qh(e,t,n,r)}finally{j.p=s,k.T=i}}function qh(e,t,n,r){if(Wh){var i=Kh(r);if(null===i)Ou(e,t,r,Yh,n),od(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Jh=ad(Jh,e,t,n,r,i),!0;case"dragenter":return ed=ad(ed,e,t,n,r,i),!0;case"mouseover":return td=ad(td,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return nd.set(s,ad(nd.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,rd.set(s,ad(rd.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(od(e,r),4&t&&-1<sd.indexOf(e)){for(;null!==i;){var s=Ke(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=xe(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-be(o);a.entanglements[1]|=l,o&=~l}gu(s),0===(6&ec)&&(bc=le()+500,mu(0,!1))}}break;case 13:null!==(a=Cr(s,2))&&Mc(a,0,2),Bc(),jh(s,2)}if(null===(s=Kh(r))&&Ou(e,t,r,Yh,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Ou(e,t,r,null,n)}}function Kh(e){return Zh(e=Lt(e))}var Yh=null;function Zh(e){if(Yh=null,null!==(e=qe(e))){var t=D(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=B(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Yh=e,null}function Qh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case fe:return 32;case pe:return 268435456;default:return 32}default:return 32}}var $h=!1,Jh=null,ed=null,td=null,nd=new Map,rd=new Map,id=[],sd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function od(e,t){switch(e){case"focusin":case"focusout":Jh=null;break;case"dragenter":case"dragleave":ed=null;break;case"mouseover":case"mouseout":td=null;break;case"pointerover":case"pointerout":nd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rd.delete(t.pointerId)}}function ad(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Ke(t))&&Vh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function ld(e){var t=qe(e.target);if(null!==t){var n=D(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=B(n)))return e.blockedOn=t,void function(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}(e.priority,(function(){if(13===n.tag){var e=kc(),t=Cr(n,e);null!==t&&Mc(t,0,e),jh(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function cd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kh(e.nativeEvent);if(null!==n)return null!==(t=Ke(n))&&Vh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);kt=r,n.target.dispatchEvent(r),kt=null,t.shift()}return!0}function ud(e,t,n){cd(e)&&n.delete(t)}function hd(){$h=!1,null!==Jh&&cd(Jh)&&(Jh=null),null!==ed&&cd(ed)&&(ed=null),null!==td&&cd(td)&&(td=null),nd.forEach(ud),rd.forEach(ud)}function dd(e,t){e.blockedOn===t&&(e.blockedOn=null,$h||($h=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,hd)))}var fd=null;function pd(e){fd!==e&&(fd=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){fd===e&&(fd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===Zh(r||n))continue;break}var s=Ke(n);null!==s&&(e.splice(t,3),t-=3,uo(s,{pending:!0,data:i,method:n.method,action:r},r,i))}})))}function gd(e){function t(t){return dd(t,e)}null!==Jh&&dd(Jh,e),null!==ed&&dd(ed,e),null!==td&&dd(td,e),nd.forEach(t),rd.forEach(t);for(var n=0;n<id.length;n++){var r=id[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<id.length&&null===(n=id[0]).blockedOn;)ld(n),null===n.blockedOn&&id.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],s=n[r+1],o=i[Ue]||null;if("function"===typeof s)o||pd(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(i=s,o=s[Ue]||null)a=o.formAction;else if(null!==Zh(i))continue}else a=o.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),pd(n)}}}function md(e){this._internalRoot=e}function _d(e){this._internalRoot=e}_d.prototype.render=md.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));zh(t.current,kc(),e,t,null,null)},_d.prototype.unmount=md.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;0===e.tag&&tu(),zh(e.current,2,null,e,null,null),Bc(),t[ze]=null}},_d.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<id.length&&0!==t&&t<id[n].priority;n++);id.splice(n,0,e),0===n&&ld(e)}};var vd=i.version;if("19.0.0"!==vd)throw Error(o(527,vd,"19.0.0"));j.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=D(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return U(i),e;if(s===r)return U(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?z(e):null)?null:e.stateNode};var yd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:k,findFiberByHostInstance:qe,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bd.isDisabled&&bd.supportsFiber)try{_e=bd.inject(yd),ve=bd}catch(wd){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var n=!1,r="",i=No,s=Fo,l=Do;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Bh(e,1,!1,null,0,n,r,i,s,l,0,null),e[ze]=t.current,Mu(8===e.nodeType?e.parentNode:e),new md(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(o(299));var r=!1,i="",s=No,l=Fo,c=Do,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Bh(e,1,!0,t,0,r,i,s,l,c,0,u)).context=Uh(null),n=t.current,(i=La(r=kc())).callback=null,Ma(n,i,r),t.current.lanes=r,Me(t,r),gu(t),e[ze]=t.current,Mu(e),new _d(t)},t.version="19.0.0"},672:(e,t,n)=>{"use strict";var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:s}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.0.0"},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var b=y.prototype=new v;b.constructor=y,g(b,_.prototype),b.isPureReactComponent=!0;var E=Array.isArray,w={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function T(e,t,r,i,s,o){return r=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:o}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(){}function C(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return C((u=e._init)(e._payload),t,i,s,o)}}if(u)return o=o(e),u=""===s?"."+R(e,0):s,E(o)?(i="",null!=u&&(i=u.replace(A,"$&/")+"/"),C(o,t,i,"",(function(e){return e}))):null!=o&&(x(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+u,o=T(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var h,p=""===s?".":s+":";if(E(e))for(var g=0;g<e.length;g++)u+=C(s=e[g],t,i,a=p+R(s,g),o);else if("function"===typeof(g=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=g.call(e),g=0;!(s=e.next()).done;)u+=C(s=s.value,t,i,a=p+R(s,g++),o);else if("object"===a){if("function"===typeof e.then)return C(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(P,P):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function k(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function I(){}t.Children={map:k,forEach:function(e,t,n){k(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=i,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,t.act=function(){throw Error("act(...) is not supported in production builds of React.")},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];r.children=o}return T(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===i[r]&&(i[r]=o[r]);return T(e,s,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=w.T,n={};w.T=n;try{var r=e(),i=w.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(I,M)}catch(s){M(s)}finally{w.T=t}},t.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},t.use=function(e){return w.H.use(e)},t.useActionState=function(e,t,n){return w.H.useActionState(e,t,n)},t.useCallback=function(e,t){return w.H.useCallback(e,t)},t.useContext=function(e){return w.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return w.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return w.H.useEffect(e,t)},t.useId=function(){return w.H.useId()},t.useImperativeHandle=function(e,t,n){return w.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return w.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return w.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return w.H.useMemo(e,t)},t.useOptimistic=function(e,t){return w.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return w.H.useReducer(e,t,n)},t.useRef=function(e){return w.H.useRef(e)},t.useState=function(e){return w.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return w.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return w.H.useTransition()},t.version="19.0.0"},43:(e,t,n)=>{"use strict";e.exports=n(288)},579:(e,t,n)=>{"use strict";e.exports=n(799)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function E(e){if(m=!1,b(e),!g)if(null!==r(c))g=!0,L();else{var t=r(u);null!==t&&M(E,t.startTime-e)}}var w,S=!1,T=-1,x=5,A=-1;function R(){return!(t.unstable_now()-A<x)}function P(){if(S){var e=t.unstable_now();A=e;var n=!0;try{e:{g=!1,m&&(m=!1,v(T),T=-1),p=!0;var s=f;try{t:{for(b(e),d=r(c);null!==d&&!(d.expirationTime>e&&R());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,b(e),n=!0;break t}d===r(c)&&i(c),b(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&M(E,l.startTime-e),n=!1}}break e}finally{d=null,f=s,p=!1}n=void 0}}finally{n?w():S=!1}}}if("function"===typeof y)w=function(){y(P)};else if("undefined"!==typeof MessageChannel){var C=new MessageChannel,k=C.port2;C.port1.onmessage=P,w=function(){k.postMessage(null)}}else w=function(){_(P,0)};function L(){S||(S=!0,w())}function M(e,n){T=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,L())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(m?(v(T),T=-1):m=!0,M(E,s-o))):(e.sortIndex=a,n(c,e),g||p||(g=!0,L())),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(896)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{488:"7221426e",879:"f1cd7cd9"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="my-map-app:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/my-map-app/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkmy_map_app=self.webpackChunkmy_map_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e=n(43),t=n(391);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let l=1,c=1;class u{constructor(){s(this,"time",0),s(this,"channels",new Map),s(this,"animations",new Map),s(this,"playing",!1),s(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,s=l++,o={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=c++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function h(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const d={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"===typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function f(e){let t=p(e);if("object"!==t)return a(a({value:e},d[t]),{},{type:t});if("object"===typeof e)return e?void 0!==e.type?a(a(a({},e),d[e.type]),{},{type:e.type}):void 0===e.value?{type:"object",value:e}:(t=p(e.value),a(a(a({},e),d[t]),{},{type:t})):{type:"object",value:null};throw new Error("props")}function p(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const g={vertex:"#ifdef MODULE_LOGDEPTH\nlogdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\ngl_FragColor = material_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_LIGHTING\ngl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_FOG\ngl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n#ifdef MODULE_PICKING\ngl_FragColor = picking_filterHighlightColor(gl_FragColor);\ngl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n#ifdef MODULE_LOGDEPTH\nlogdepth_setFragDepth();\n#endif\n"},m=/void\s+main\s*\([^)]*\)\s*\{\n?/,_=/}\n?[^{}]*$/,v=[],y="__LUMA_INJECT_DECLARATIONS__";function b(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function E(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i="vertex"===t;for(const s in n){const t=n[s];t.sort(((e,t)=>e.order-t.order)),v.length=t.length;for(let e=0,n=t.length;e<n;++e)v[e]=t[e].injection;const r="".concat(v.join("\n"),"\n");switch(s){case"vs:#decl":i&&(e=e.replace(y,r));break;case"vs:#main-start":i&&(e=e.replace(m,(e=>e+r)));break;case"vs:#main-end":i&&(e=e.replace(_,(e=>r+e)));break;case"fs:#decl":i||(e=e.replace(y,r));break;case"fs:#main-start":i||(e=e.replace(m,(e=>e+r)));break;case"fs:#main-end":i||(e=e.replace(_,(e=>r+e)));break;default:e=e.replace(s,(e=>e+r))}}return e=e.replace(y,""),r&&(e=e.replace(/\}\s*$/,(e=>e+g[t]))),e}let w=1;class S{static instantiateModules(e){return e.map((e=>{if(e instanceof S)return e;h("string"!==typeof e,"Shader module use by name is deprecated. Import shader module '".concat(JSON.stringify(e),"' and use it directly.")),e.name||(console.warn("shader module has no name"),e.name="shader-module-".concat(w++));const t=new S(e);return t.dependencies=S.instantiateModules(e.dependencies||[]),t}))}constructor(e){s(this,"name",void 0),s(this,"vs",void 0),s(this,"fs",void 0),s(this,"getModuleUniforms",void 0),s(this,"dependencies",void 0),s(this,"deprecations",void 0),s(this,"defines",void 0),s(this,"injections",void 0),s(this,"uniforms",{}),s(this,"uniformTypes",{});const{name:t,vs:n,fs:r,dependencies:i=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:l,deprecations:c=[],defines:u={},inject:d={}}=e;h("string"===typeof t),this.name=t,this.vs=n,this.fs=r,this.getModuleUniforms=l,this.dependencies=S.instantiateModules(i),this.deprecations=this._parseDeprecationDefinitions(c),this.defines=u,this.injections=function(e){const t={vertex:{},fragment:{}};for(const n in e){let r=e[n];"string"===typeof r&&(r={order:0,injection:r}),t[b(n)][n]=r}return t}(d),this.uniformTypes=o,a&&(this.uniforms=function(e){const t={};for(const[n,r]of Object.entries(e))t[n]=f(r);return t}(a))}getModuleSource(e){let t;switch(e){case"vertex":t=this.vs||"";break;case"fragment":t=this.fs||"";break;default:h(!1)}const n=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return"// ----- MODULE ".concat(this.name," ---------------\n\n#define MODULE_").concat(n,"\n").concat(t,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):function(e,t,n){const r={};for(const[i,s]of Object.entries(t))e&&i in e&&!s.private?(s.validate&&h(s.validate(e[i],s),"".concat(n,": invalid ").concat(i)),r[i]=e[i]):r[i]=s.value;return r}(e,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach((n=>{var r;null!==(r=n.regex)&&void 0!==r&&r.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(e){return e.forEach((e=>{if("function"===e.type)e.regex=new RegExp("\\b".concat(e.old,"\\("));else e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))})),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},n=this.uniforms;for(const r in n){const i=n[r];r in e&&!i.private?(i.validate&&h(i.validate(e[r],i),"".concat(this.name,": invalid ").concat(r)),t[r]=e[r]):t[r]=i.value}return t}}function T(e){if(e.source&&"webgpu"===e.platformInfo.type){return a(a({},e),{},{vs:void 0,fs:void 0})}if(!e.vs)throw new Error("no vertex shader");const t=x(e.platformInfo,e.vs);let n;return e.fs&&(n=x(e.platformInfo,e.fs)),a(a({},e),{},{vs:t,fs:n})}function x(e,t){if("string"===typeof t)return t;if("webgpu"===e.type){if(null!==t&&void 0!==t&&t.wgsl)return t.wgsl;throw new Error("WebGPU does not support GLSL shaders")}if(null!==t&&void 0!==t&&t.glsl)return t.glsl;throw new Error("WebGL does not support WGSL shaders")}function A(e){return R(S.instantiateModules(e))}function R(e){const t={},n={};return P({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort(((e,t)=>n[t]-n[e])).map((e=>t[e]))}function P(e){const{modules:t,level:n,moduleMap:r,moduleDepth:i}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)r[s.name]=s,(void 0===i[s.name]||i[s.name]<n)&&(i[s.name]=n);for(const s of t)s.dependencies&&P({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}const C=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],k=[...C,[I("attribute"),"in $1"],[I("varying"),"out $1"]],L=[...C,[I("varying"),"in $1"]];function M(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function I(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}function O(e,t){let n="";for(const r in e){const i=e[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),t[r]){const e=t[r];e.sort(((e,t)=>e.order-t.order));for(const t of e)n+="  ".concat(t.injection,"\n")}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}function N(e){const t={vertex:{},fragment:{}};for(const n of e){let e,r;"string"!==typeof n?(e=n,r=e.hook):(e={},r=n),r=r.trim();const[i,s]=r.split(":"),o=r.replace(/\(.+/,""),a=Object.assign(e,{signature:s});switch(i){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(i)}}return t}function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function D(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error("Invalid GLSL version ".concat(t));return t}const B="\n\n".concat(y,"\n");function U(e,t){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=t;h("string"===typeof n,"shader source must be a string");const l=n;let c="";const u=N(s),d={},f={},p={};for(const h in o){const e="string"===typeof o[h]?{injection:o[h],order:0}:o[h],t=/^(v|f)s:(#)?([\w-]+)$/.exec(h);if(t){const n=t[2],r=t[3];n?"decl"===r?f[h]=[e]:p[h]=[e]:d[h]=[e]}else p[h]=[e]}const g="webgpu"!==e.type?i:[];for(const h of g){a&&h.checkDeprecations(l,a);c+=h.getModuleSource(r,"wgsl");const e=h.injections[r];for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?f:p;r[t]=r[t]||[],r[t].push(e[t])}else d[t]=d[t]||[],d[t].push(e[t])}}return c+=B,c=E(c,r,f),c+=O(u[r],d),c+=l,c=E(c,r,p),c}function z(e,t){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:d}=t;h("string"===typeof r,"shader source must be a string");const f="glsl"===s?function(e,t){return{name:F(e,t),language:"glsl",version:D(e)}}(r).version:-1,p=e.shaderLanguageVersion,g=100===f?"#version 100":"#version 300 es",m=r.split("\n").slice(1).join("\n"),_={};o.forEach((e=>{Object.assign(_,e.getDefines())})),Object.assign(_,a);let v="";switch(s){case"wgsl":break;case"glsl":v=u?"".concat(g,"\n\n// ----- PROLOGUE -------------------------\n").concat(function(e){const{id:t,source:n,stage:r}=e,i=t&&-1===n.indexOf("SHADER_NAME");return i?"\n#define SHADER_NAME ".concat(t,"_").concat(r,"\n\n"):""}({id:n,source:r,stage:i}),"\n","#define SHADER_TYPE_".concat(i.toUpperCase()),"\n").concat(function(e){switch(null===e||void 0===e?void 0:e.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e),"\n").concat("fragment"===i?"precision highp float;\n":"","\n\n// ----- APPLICATION DEFINES -------------------------\n\n").concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(const n in e){const r=e[n];(r||Number.isFinite(r))&&(t+="#define ".concat(n.toUpperCase()," ").concat(e[n],"\n"))}return t}(_),"\n\n"):"".concat(g,"\n")}const y=N(l),b={},w={},S={};for(const h in c){const e="string"===typeof c[h]?{injection:c[h],order:0}:c[h],t=/^(v|f)s:(#)?([\w-]+)$/.exec(h);if(t){const n=t[2],r=t[3];n?"decl"===r?w[h]=[e]:S[h]=[e]:b[h]=[e]}else S[h]=[e]}for(const h of o){d&&h.checkDeprecations(m,d);v+=h.getModuleSource(i);const e=h.injections[i];for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?w:S;r[t]=r[t]||[],r[t].push(e[t])}else b[t]=b[t]||[],b[t].push(e[t])}}return v+="// ----- MAIN SHADER SOURCE -------------------------",v+=B,v=E(v,i,w),v+=O(y[i],b),v+=m,v=E(v,i,S),"glsl"===s&&f!==p&&(v=function(e,t){var n;if(300!==Number((null===(n=e.match(/^#version[ \t]+(\d+)/m))||void 0===n?void 0:n[1])||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return M(e,k);case"fragment":return M(e,L);default:throw new Error(t)}}(v,i)),v.trim()}function G(e){return function(t){const n={};for(const r of e){const e=r.getUniforms(t,n);Object.assign(n,e)}return n}}class j{constructor(){s(this,"_hookFunctions",[]),s(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return j.defaultShaderAssembler=j.defaultShaderAssembler||new j,j.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find((t=>t.name===("string"===typeof e?e:e.name)))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t))}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,r=T(e),i=function(e){const t=A(e.modules||[]);return{source:U(e.platformInfo,a(a({},e),{},{source:e.source,stage:"vertex",modules:t})),getUniforms:G(t)}}(a(a({platformInfo:e.platformInfo},r),{},{modules:t,hookFunctions:n}));return a(a({},i),{},{modules:t})}assembleShaderPair(e){const t=T(e),n=this._getModuleList(e.modules),r=this._hookFunctions,{platformInfo:i}=e,s="wgsl"===e.platformInfo.shaderLanguage?function(e){const t=A(e.modules||[]);return{vs:U(e.platformInfo,a(a({},e),{},{source:e.vs,stage:"vertex",modules:t})),fs:U(e.platformInfo,a(a({},e),{},{source:e.fs,stage:"fragment",modules:t})),getUniforms:G(t)}}(a(a({platformInfo:i},t),{},{modules:n,hookFunctions:r})):function(e){const{vs:t,fs:n}=e,r=A(e.modules||[]);return{vs:z(e.platformInfo,a(a({},e),{},{source:t,stage:"vertex",modules:r})),fs:z(e.platformInfo,a(a({},e),{},{source:n,stage:"fragment",modules:r})),getUniforms:G(r)}}(a(a({platformInfo:i},t),{},{modules:n,hookFunctions:r}));return a(a({},s),{},{modules:n})}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let i=0,s=this._defaultModules.length;i<s;++i){const e=this._defaultModules[i],s=e.name;t[r++]=e,n[s]=!0}for(let i=0,s=e.length;i<s;++i){const s=e[i],o=s.name;n[o]||(t[r++]=s,n[o]=!0)}return t.length=r,S.instantiateModules(t)}}s(j,"defaultShaderAssembler",void 0);const V={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\nfloat sin_taylor_fp32(float a) {\nfloat r, s, t, x;\nif (a == 0.0) {\nreturn 0.0;\n}\nx = -a * a;\ns = a;\nr = a;\nr = r * x;\nt = r * INVERSE_FACTORIAL_3;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_5;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_7;\ns = s + t;\nr = r * x;\nt = r * INVERSE_FACTORIAL_9;\ns = s + t;\nreturn s;\n}\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\nif (a == 0.0) {\nsin_t = 0.0;\ncos_t = 1.0;\n}\nsin_t = sin_taylor_fp32(a);\ncos_t = sqrt(1.0 - sin_t * sin_t);\n}\nfloat tan_taylor_fp32(float a) {\nfloat sin_a;\nfloat cos_a;\nif (a == 0.0) {\nreturn 0.0;\n}\nfloat z = floor(a / TWO_PI);\nfloat r = a - TWO_PI * z;\nfloat t;\nfloat q = floor(r / PI_2 + 0.5);\nint j = int(q);\nif (j < -2 || j > 2) {\nreturn 1.0 / 0.0;\n}\nt = r - PI_2 * q;\nq = floor(t / PI_16 + 0.5);\nint k = int(q);\nint abs_k = int(abs(float(k)));\nif (abs_k > 4) {\nreturn 1.0 / 0.0;\n} else {\nt = t - PI_16 * q;\n}\nfloat u = 0.0;\nfloat v = 0.0;\nfloat sin_t, cos_t;\nfloat s, c;\nsincos_taylor_fp32(t, sin_t, cos_t);\nif (k == 0) {\ns = sin_t;\nc = cos_t;\n} else {\nif (abs(float(abs_k) - 1.0) < 0.5) {\nu = COS_TABLE_0;\nv = SIN_TABLE_0;\n} else if (abs(float(abs_k) - 2.0) < 0.5) {\nu = COS_TABLE_1;\nv = SIN_TABLE_1;\n} else if (abs(float(abs_k) - 3.0) < 0.5) {\nu = COS_TABLE_2;\nv = SIN_TABLE_2;\n} else if (abs(float(abs_k) - 4.0) < 0.5) {\nu = COS_TABLE_3;\nv = SIN_TABLE_3;\n}\nif (k > 0) {\ns = u * sin_t + v * cos_t;\nc = u * cos_t - v * sin_t;\n} else {\ns = u * sin_t - v * cos_t;\nc = u * cos_t + v * sin_t;\n}\n}\nif (j == 0) {\nsin_a = s;\ncos_a = c;\n} else if (j == 1) {\nsin_a = c;\ncos_a = -s;\n} else if (j == -1) {\nsin_a = -c;\ncos_a = s;\n} else {\nsin_a = -s;\ncos_a = -c;\n}\nreturn sin_a / cos_a;\n}\n#endif\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nreturn tan_taylor_fp32(a);\n#else\nreturn tan(a);\n#endif\n}\n"},W="#define SMOOTH_EDGE_RADIUS 0.5",H={name:"geometry",vs:"\n".concat(W,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(W,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")};function X(e){var t,n;if("undefined"!==typeof window&&"renderer"===(null===(t=window.process)||void 0===t?void 0:t.type))return!0;if("undefined"!==typeof process&&Boolean(null===(n=process.versions)||void 0===n?void 0:n.electron))return!0;const r="undefined"!==typeof navigator&&navigator.userAgent,i=e||r;return Boolean(i&&i.indexOf("Electron")>=0)}function q(){var e;return!("object"===typeof process&&"[object process]"===String(process)&&!(null!==(e=process)&&void 0!==e&&e.browser))||X()}const K="4.0.7";class Y{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var Z;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(Z||(Z={}));function Q(e){return"string"!==typeof e?e:(e=e.toUpperCase(),Z[e]||Z.WHITE)}function $(e,t){if(!e)throw new Error(t||"Assertion failed")}const J=globalThis,ee=(globalThis.document,globalThis.process||{}),te=(globalThis.console,globalThis.navigator||{});function ne(){let e;var t,n;if(q()&&J.performance)e=null===J||void 0===J||null===(t=J.performance)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in ee){var r;const t=null===ee||void 0===ee||null===(r=ee.hrtime)||void 0===r?void 0:r.call(ee);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const re={debug:q()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ie={enabled:!0,level:0};function se(){}const oe={},ae={once:!0};class le{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.VERSION=K,this._startTs=ne(),this._deltaTs=ne(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new Y("__probe-".concat(this.id,"__"),ie),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),i=e;for(const s of r){const n=i[s];"function"===typeof n&&(t.find((e=>s===e))||(i[s]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ne()-this._startTs).toPrecision(10))}getDelta(){return Number((ne()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,re.warn,arguments,ae)}error(e){return this._getLogFunction(0,e,re.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,re.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,re.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,re.debug||re.info,arguments,ae)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||se,n&&[n],{tag:he(t)}):se}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||se)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=ue({logLevel:e,message:t,opts:n}),{collapsed:i}=n;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||se)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ce(e)}_getLogFunction(e,t,n,r,i){if(this._shouldLog(e)){i=ue({logLevel:e,message:t,args:r,opts:i}),$(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=ne();const s=i.tag||i.message;if(i.once&&s){if(oe[s])return se;oe[s]=ne()}return t=function(e,t,n){if("string"===typeof t){const r=n.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";t=function(e,t,n){if(!q&&"string"===typeof e){if(t){const n=Q(t);e="\x1b[".concat(n,"m").concat(e,"\x1b[39m")}if(n){const t=Q(n);e="\x1b[".concat(t+10,"m").concat(e,"\x1b[49m")}}return e}(t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),n.color,n.background)}return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return se}}function ce(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return $(Number.isFinite(t)&&t>=0),t}function ue(e){const{logLevel:t,message:n}=e;e.logLevel=ce(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const i=typeof e.message;return $("string"===i||"object"===i),Object.assign(e,{args:r},e.opts)}function he(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}le.VERSION=K;const de=new le({id:"deck"}),fe={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(fe,"IDENTITY",{get:()=>(de.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const pe={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ge={common:0,meters:1,pixels:2},me={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},_e=Object.keys(fe).map((e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(fe[e],";"))).join(""),ve=Object.keys(pe).map((e=>"const int PROJECTION_MODE_".concat(e," = ").concat(pe[e],";"))).join(""),ye=Object.keys(ge).map((e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(ge[e],";"))).join(""),be="".concat(_e,"\n").concat(ve,"\n").concat(ye,"\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject_uPseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project_uCommonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project_uCommonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project_uWrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project_uModelMatrix * position;\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project_uCoordinateOrigin;\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project_uCommonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project_uCoordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\nreturn offset * project_uFocalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project_uScale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project_uScale;\n}\n"),Ee=1e-6;let we="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Se(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,e}!function(){const e=function(){const e=new we(4);return we!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function Te(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],_=t[15],v=n*a-r*o,y=n*l-i*o,b=n*c-s*o,E=r*l-i*a,w=r*c-s*a,S=i*c-s*l,T=u*g-h*p,x=u*m-d*p,A=u*_-f*p,R=h*m-d*g,P=h*_-f*g,C=d*_-f*m;let k=v*C-y*P+b*R+E*A-w*x+S*T;return k?(k=1/k,e[0]=(a*C-l*P+c*R)*k,e[1]=(i*P-r*C-s*R)*k,e[2]=(g*S-m*w+_*E)*k,e[3]=(d*w-h*S-f*E)*k,e[4]=(l*A-o*C-c*x)*k,e[5]=(n*C-i*A+s*x)*k,e[6]=(m*b-p*S-_*y)*k,e[7]=(u*S-d*b+f*y)*k,e[8]=(o*P-a*A+c*T)*k,e[9]=(r*A-n*P-s*T)*k,e[10]=(p*w-g*b+_*v)*k,e[11]=(h*b-u*w-f*v)*k,e[12]=(a*x-o*R-l*T)*k,e[13]=(n*R-r*x+i*T)*k,e[14]=(g*y-p*E-m*v)*k,e[15]=(u*E-h*y+d*v)*k,e):null}function xe(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],m=t[13],_=t[14],v=t[15];let y=n[0],b=n[1],E=n[2],w=n[3];return e[0]=y*r+b*a+E*h+w*g,e[1]=y*i+b*l+E*d+w*m,e[2]=y*s+b*c+E*f+w*_,e[3]=y*o+b*u+E*p+w*v,y=n[4],b=n[5],E=n[6],w=n[7],e[4]=y*r+b*a+E*h+w*g,e[5]=y*i+b*l+E*d+w*m,e[6]=y*s+b*c+E*f+w*_,e[7]=y*o+b*u+E*p+w*v,y=n[8],b=n[9],E=n[10],w=n[11],e[8]=y*r+b*a+E*h+w*g,e[9]=y*i+b*l+E*d+w*m,e[10]=y*s+b*c+E*f+w*_,e[11]=y*o+b*u+E*p+w*v,y=n[12],b=n[13],E=n[14],w=n[15],e[12]=y*r+b*a+E*h+w*g,e[13]=y*i+b*l+E*d+w*m,e[14]=y*s+b*c+E*f+w*_,e[15]=y*o+b*u+E*p+w*v,e}function Ae(e,t,n){const r=n[0],i=n[1],s=n[2];let o,a,l,c,u,h,d,f,p,g,m,_;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],a=t[1],l=t[2],c=t[3],u=t[4],h=t[5],d=t[6],f=t[7],p=t[8],g=t[9],m=t[10],_=t[11],e[0]=o,e[1]=a,e[2]=l,e[3]=c,e[4]=u,e[5]=h,e[6]=d,e[7]=f,e[8]=p,e[9]=g,e[10]=m,e[11]=_,e[12]=o*r+u*i+p*s+t[12],e[13]=a*r+h*i+g*s+t[13],e[14]=l*r+d*i+m*s+t[14],e[15]=c*r+f*i+_*s+t[15]),e}function Re(e,t,n){const r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Pe(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*r,e[5]=o*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-s*r,e[9]=u*i-o*r,e[10]=h*i-a*r,e[11]=d*i-l*r,e}function Ce(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*r,e[1]=o*i+u*r,e[2]=a*i+h*r,e[3]=l*i+d*r,e[4]=c*i-s*r,e[5]=u*i-o*r,e[6]=h*i-a*r,e[7]=d*i-l*r,e}const ke=function(e,t,n,r,i){const s=1/Math.tan(t/2);if(e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){const t=1/(r-i);e[10]=(i+r)*t,e[14]=2*i*r*t}else e[10]=-1,e[14]=-2*r;return e};const Le=function(e,t,n,r,i,s,o){const a=1/(t-n),l=1/(r-i),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(o+s)*c,e[15]=1,e};function Me(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function Ie(e){let t,n={};return r=>{for(const i in r)if(!Me(r[i],n[i])){t=e(r),n=r;break}return t}}const Oe=[0,0,0,0],Ne=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Fe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],De=[0,0,0],Be=[0,0,0],Ue=Ie((function(e){let{viewport:t,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:i}=e;const{projectionCenter:s,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:i}=e;let{viewMatrix:s,viewProjectionMatrix:o}=e,a=Oe,l=Oe,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=ze(e,t,n);d&&(l=e.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Se([],l,o),s=r||s,o=xe([],i,s),o=xe([],o,Ne));return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(t,r,i),h=t.getDistanceScales(),d=[t.width*n,t.height*n],f=Se([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={project_uCoordinateSystem:r,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:a.slice(0,3),project_uCenter:s,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:d,project_uDevicePixelRatio:n,project_uFocalDistance:f,project_uCommonUnitsPerMeter:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:De,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:Fe,project_uCameraPosition:l};if(u){const e=t.getDistanceScales(u);switch(r){case fe.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case fe.LNGLAT:case fe.LNGLAT_OFFSETS:t._pseudoMeters||(p.project_uCommonUnitsPerMeter=e.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case fe.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return p}));function ze(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Be;n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=t===fe.LNGLAT_OFFSETS||t===fe.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case pe.WEB_MERCATOR:t!==fe.LNGLAT&&t!==fe.CARTESIAN||(r=[0,0,0],s=!1);break;case pe.WEB_MERCATOR_AUTO_OFFSET:t===fe.LNGLAT?i=r:t===fe.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case pe.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case pe.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const Ge={};const je={name:"project",dependencies:[V,H],vs:be,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:n=1,modelMatrix:r=null,coordinateSystem:i=fe.DEFAULT,coordinateOrigin:s=Be,autoWrapLongitude:o=!1}=e;i===fe.DEFAULT&&(i=t.isGeospatial?fe.LNGLAT:fe.CARTESIAN);const a=Ue({viewport:t,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:s});return a.project_uWrapLongitude=o,a.project_uModelMatrix=r||Fe,a}(e):{}}},Ve=[je],We=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function He(){const e=j.getDefaultShaderAssembler();for(const t of Ve)e.addDefaultModule(t);for(const t of We)e.addShaderHook(t);return e}const Xe="Awaiting state",qe="Matched. State transferred from previous layer",Ke="Initialized",Ye="Discarded. Awaiting garbage collection",Ze="No longer matched. Awaiting garbage collection",Qe="Finalized! Awaiting garbage collection",$e=Symbol.for("component"),Je=Symbol.for("propTypes"),et=Symbol.for("deprecatedProps"),tt=Symbol.for("asyncPropDefaults"),nt=Symbol.for("asyncPropOriginal"),rt=Symbol.for("asyncPropResolved");let it={};function st(e){it=e}function ot(e,t,n,r){de.level>0&&it[e]&&it[e].call(null,t,n,r)}function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?lt(e,t,[]):t(e)?[e]:[]}function lt(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?lt(i,t,n):t(i)&&n.push(i)}return n}function ct(e){let{target:t,source:n,start:r=0,count:i=1}=e;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);return t}function ut(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class ht{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ut(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ut()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class dt{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){const{name:t,type:n}=e;let r=this.stats[t];return r||(r=e instanceof ht?e:new ht(t,n),this.stats[t]=r),r}}const ft=e=>"boolean"===typeof e,pt=e=>"function"===typeof e,gt=e=>null!==e&&"object"===typeof e,mt=e=>gt(e)&&e.constructor==={}.constructor,_t=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,vt=e=>"undefined"!==typeof Blob&&e instanceof Blob,yt=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||gt(e)&&pt(e.tee)&&pt(e.cancel)&&pt(e.getReader))(e)||(e=>gt(e)&&pt(e.read)&&pt(e.pipe)&&ft(e.readable))(e);function bt(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Et(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions)}function wt(e){var t,n;let r;return bt(e,"null loader"),bt(Et(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=a(a({},e=e[0]),{},{options:a(a({},e.options),r)})),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let St="";const Tt={};class xt extends Error{constructor(e,t){super(e),s(this,"reason",void 0),s(this,"url",void 0),s(this,"response",void 0),this.reason=t.reason,this.url=t.url,this.response=t.response}}const At=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Rt=/^([-\w.]+\/[-\w.+]+)/;function Pt(e,t){return e.toLowerCase()===t.toLowerCase()}function Ct(e){const t=At.exec(e);return t?t[1]:""}const kt=/\?.*/;function Lt(e){return e.replace(kt,"")}function Mt(e){if(_t(e)){return e.url}if(vt(e)){return e.name||""}return"string"===typeof e?e:""}function It(e){if(_t(e)){const t=e,n=t.headers.get("content-type")||"",r=Lt(t.url);return function(e){const t=Rt.exec(e);return t?t[1]:e}(n)||Ct(r)}if(vt(e)){return e.type||""}return"string"===typeof e?Ct(e):""}async function Ot(e){if(_t(e))return e;const t={},n=function(e){if(_t(e))return e.headers["content-length"]||-1;if(vt(e))return e.size;return"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const r=Mt(e),i=It(e);i&&(t["content-type"]=i);const s=await async function(e){const t=5;if("string"===typeof e)return"data:,".concat(e.slice(0,t));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){const n=function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t));return"data:base64,".concat(n)}return null}(e);s&&(t["x-first-bytes"]=s),"string"===typeof e&&(e=(new TextEncoder).encode(e));const o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:r}),o}async function Nt(e){if(!e.ok){const t=await async function(e){const n=function(e){if(e.length<50)return e;const t=e.slice(e.length-15),n=e.substr(0,32);return"".concat(n,"...").concat(t)}(e.url);let r="Failed to fetch resource (".concat(e.status,") ").concat(e.statusText,": ").concat(n);r=r.length>100?"".concat(r.slice(0,100),"..."):r;const i={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");i.reason=!e.bodyUsed&&null!==t&&void 0!==t&&t.includes("application/json")?await e.json():await e.text()}catch(t){}return new xt(r,i)}(e);throw t}}async function Ft(e,t){if("string"===typeof e){const i=function(e){for(const t in Tt)if(e.startsWith(t)){const n=Tt[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(St).concat(e)),e}(e);var n,r;if(function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(i))if(null!==(n=globalThis.loaders)&&void 0!==n&&n.fetchNode)return null===(r=globalThis.loaders)||void 0===r?void 0:r.fetchNode(i,t);return await fetch(i,t)}return await Ot(e)}const Dt=new le({id:"loaders.gl"});class Bt{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const Ut=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),zt="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Gt=(zt&&parseFloat(zt[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){s(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Ut,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),jt={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Vt(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function Wt(){const e=Vt();return e.globalOptions=e.globalOptions||a({},Gt),e.globalOptions}function Ht(e,t,n,r){return n=n||[],function(e,t){Xt(e,null,Gt,jt,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Xt(r,n.id,i,s,t)}}(e,n=Array.isArray(n)?n:[n]),Kt(t,e,r)}function Xt(e,t,n,r,i){const s=t||"Top level",o=t?"".concat(t,"."):"";for(const a in e){const l=!t&&gt(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in r)Dt.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const e=qt(a,i);Dt.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(e))()}}}function qt(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '".concat(i.id,".").concat(t,"'?");const s=t.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(t,"'?"))}return r}function Kt(e,t,n){const r=a({},e.options||{});return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new Bt),Yt(r,Wt()),Yt(r,t),r}function Yt(e,t){for(const n in t)if(n in t){const r=t[n];mt(r)&&mt(e[n])?e[n]=a(a({},e[n]),t[n]):e[n]=t[n]}}function Zt(e,t){const n=Wt(),r=e||n;return"function"===typeof r.fetch?r.fetch:gt(r.fetch)?e=>Ft(e,r.fetch):null!==t&&void 0!==t&&t.fetch?null===t||void 0===t?void 0:t.fetch:Ft}function Qt(e,t){return $t(e||{},t)}function $t(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n>3)return t;const r=a({},e);for(const[i,s]of Object.entries(t))s&&"object"===typeof s&&!Array.isArray(s)?r[i]=$t(r[i]||{},t[i],n+1):r[i]=t[i];return r}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const Jt="object"!==typeof process||"[object process]"!==String(process)||process.browser,en="undefined"!==typeof window&&"undefined"!==typeof window.orientation,tn="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);tn&&parseFloat(tn[1]);class nn{terminate(){}}function rn(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const sn=new Map;function on(e){rn(e.source&&!e.url||!e.source&&e.url);let t=sn.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return an((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),sn.set(e.url,t)),e.source&&(t=an(e.source),sn.set(e.source,t))),rn(t),t}function an(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function ln(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(e){if(cn(e))r.add(e);else if(cn(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const i in e)ln(e[i],t,r)}else;return void 0===n?Array.from(r):[]}function cn(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const un=()=>{};class hn{static isSupported(){return"undefined"!==typeof Worker&&Jt||"undefined"!==typeof nn&&!Jt}constructor(e){s(this,"name",void 0),s(this,"source",void 0),s(this,"url",void 0),s(this,"terminated",!1),s(this,"worker",void 0),s(this,"onMessage",void 0),s(this,"onError",void 0),s(this,"_loadableURL","");const{name:t,source:n,url:r}=e;rn(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=un,this.onError=e=>console.log(e),this.worker=Jt?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=un,this.onError=un,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||ln(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=on({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new nn(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new nn(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class dn{constructor(e,t){s(this,"name",void 0),s(this,"workerThread",void 0),s(this,"isRunning",!0),s(this,"result",void 0),s(this,"_resolve",(()=>{})),s(this,"_reject",(()=>{})),this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){rn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){rn(this.isRunning),this.isRunning=!1,this._reject(e)}}class fn{static isSupported(){return hn.isSupported()}constructor(e){s(this,"name","unnamed"),s(this,"source",void 0),s(this,"url",void 0),s(this,"maxConcurrency",1),s(this,"maxMobileConcurrency",1),s(this,"onDebug",(()=>{})),s(this,"reuseWorkers",!0),s(this,"props",{}),s(this,"jobQueue",[]),s(this,"idleQueue",[]),s(this,"count",0),s(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props=a(a({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const r=new Promise((r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new dn(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){console.error("Worker exception: ".concat(n))}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Jt||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new hn({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return en?this.maxMobileConcurrency:this.maxConcurrency}}const pn={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class gn{static isSupported(){return hn.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gn._workerFarm=gn._workerFarm||new gn({}),gn._workerFarm.setProps(e),gn._workerFarm}constructor(e){s(this,"props",void 0),s(this,"workerPools",new Map),this.props=a({},pn),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props=a(a({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new fn({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}s(gn,"_workerFarm",void 0);const mn=function(){var e;return null!==(e=globalThis._loadersgl_)&&void 0!==e&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}();async function _n(e,t,n,r,i){const s=e.id,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t[e.id]||{},r="".concat(e.id,Jt?"-worker.js":"-worker-node.js");let i=n.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i=Jt?"modules/".concat(e.module,"/dist/").concat(r):"modules/".concat(e.module,"/src/workers/").concat(e.id,"-worker-node.ts")),!i){let t=e.version;"latest"===t&&(t="latest");const n=t?"@".concat(t):"";i="https://unpkg.com/@loaders.gl/".concat(e.module).concat(n,"/dist/").concat(r)}return rn(i),i}(e,n),a=gn.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",vn.bind(null,i));l.postMessage("process",{input:t,options:n,context:r});const c=await l.result;return await c.result}async function vn(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:s,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:s,result:n})}catch(i){const e=i instanceof Error?i.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function yn(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new bn(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function bn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return bn=function(e){this.s=e,this.n=e.next},bn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new bn(e)}function En(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),n=t.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(n);let i=0;for(const s of t)r.set(s,i),i+=s.byteLength;return r.buffer}(t)}const wn=262144;function Sn(e,t){this.v=e,this.k=t}function Tn(e){return new Sn(e,0)}function xn(e){return function(){return new An(e.apply(this,arguments))}}function An(e){var t,n;function r(t,n){try{var s=e[t](n),o=s.value,a=o instanceof Sn;Promise.resolve(a?o.v:o).then((function(n){if(a){var l="return"===t?"return":"next";if(!o.k||n.done)return r(l,n);n=e[l](n).value}i(s.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise((function(s,o){var a={key:e,arg:i,resolve:s,reject:o,next:null};n?n=n.next=a:(t=n=a,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}An.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},An.prototype.next=function(e){return this._invoke("next",e)},An.prototype.throw=function(e){return this._invoke("throw",e)},An.prototype.return=function(e){return this._invoke("return",e)};function Rn(){return(Rn=xn((function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||1048576;let r=0;for(;r<e.size;){const t=r+n,i=yield Tn(e.slice(r,t).arrayBuffer());r=t,yield i}}))).apply(this,arguments)}function Pn(e){if((t=e)&&"object"===typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Cn(e,t){return Ut?function(e,t){return kn.apply(this,arguments)}(e,t):function(e,t){return Ln.apply(this,arguments)}(e,t)}function kn(){return(kn=xn((function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!==t&&void 0!==t&&t._streamReadAhead&&(r=n.read());const{done:i,value:s}=yield Tn(e);if(i)return;yield Pn(s)}}catch(i){n.releaseLock()}}))).apply(this,arguments)}function Ln(){return(Ln=xn((function*(e,t){var n,r=!1,i=!1;try{for(var s,o=yn(e);r=!(s=yield Tn(o.next())).done;r=!1){const e=s.value;yield Pn(e)}}catch(a){i=!0,n=a}finally{try{r&&null!=o.return&&(yield Tn(o.return()))}finally{if(i)throw n}}}))).apply(this,arguments)}function Mn(e,t){if("string"===typeof e)return function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),s=e.slice(r,r+t);r+=t,yield i.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=wn}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),s=new Uint8Array(e,r,t);new Uint8Array(i).set(s),r+=t,yield i}}()}(e,t);if(vt(e))return function(e,t){return Rn.apply(this,arguments)}(e,t);if(yt(e))return Cn(e,t);if(_t(e)){return Cn(e.body,t)}throw new Error("makeIterator")}const In="Cannot convert supplied data type";async function On(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||r)return function(e,t){if(t.text&&"string"===typeof e)return e;var n;if((n=e)&&"object"===typeof n&&n.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(In)}(e,t);if(vt(e)&&(e=await Ot(e)),_t(e)){const n=e;return await Nt(n),t.binary?await n.arrayBuffer():await n.text()}if(yt(e)&&(e=Mn(e,n)),i=e,Boolean(i)&&"function"===typeof i[Symbol.iterator]||(e=>e&&"function"===typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];var n,r=!1,i=!1;try{for(var s,o=yn(e);r=!(s=await o.next()).done;r=!1){const e=s.value;t.push(e)}}catch(a){i=!0,n=a}finally{try{r&&null!=o.return&&await o.return()}finally{if(i)throw n}}return En(...t)}(e);var i;throw new Error(In)}function Nn(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function Fn(e,t,n){if(n)return n;const r=a({fetch:Zt(t,e)},e);if(r.url){const e=Lt(r.url);r.baseUrl=e,r.queryString=function(e){const t=e.match(kt);return t&&t[0]}(r.url),r.filename=Nn(e),r.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}const Dn="4.3.2",Bn=Dn[0]>="0"&&Dn[0]<="9"?"v".concat(Dn):"";const Un=function(){const e=new le({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=Bn,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}(),zn=()=>{const e=Vt();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const Gn=/\.([^.]+)$/;function jn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Vn(e))return null;if(t&&!Array.isArray(t))return wt(t);let i=[];t&&(i=i.concat(t)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||i.push(...zn()),function(e){for(const t of e)wt(t)}(i);const s=function(e,t,n,r){const i=Mt(e),s=It(e),o=Lt(i)||(null===r||void 0===r?void 0:r.url);let a=null,l="";null!==n&&void 0!==n&&n.mimeType&&(a=Hn(t,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType));a=a||function(e,t){const n=t&&Gn.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,o),l=l||(a?"matched url ".concat(o):""),a=a||Hn(t,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"===typeof t){if(Xn(t,n))return n}else if(ArrayBuffer.isView(t)){if(qn(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(qn(t,0,n))return n}return null}(t,e),l=l||(a?"matched initial data ".concat(Kn(e)):""),null!==n&&void 0!==n&&n.fallbackMimeType&&(a=a||Hn(t,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""));var c;l&&Un.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,"."));return a}(e,i,n,r);if(!s&&(null===n||void 0===n||!n.nothrow))throw new Error(Wn(e));return s}function Vn(e){return!(e instanceof Response&&204===e.status)}function Wn(e){const t=Mt(e),n=It(e);let r="No valid loader found (";r+=t?"".concat(Nn(t),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=e?Kn(e):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Hn(e,t){for(const r of e){var n;if(null!==(n=r.mimeTypes)&&void 0!==n&&n.some((e=>Pt(t,e))))return r;if(Pt(t,"application/x.".concat(r.id)))return r}return null}function Xn(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function qn(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===Yn(e,t,r.length);default:return!1}}(e,t,0,n)))}function Kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Yn(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return Yn(e,0,t)}return""}function Yn(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}async function Zn(e,t,n,r){!t||Array.isArray(t)||Et(t)||(r=void 0,n=t,t=void 0),n=n||{};const i=Mt(e=await e),s=function(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}(t,r),o=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Vn(e))return null;let i=jn(e,t,a(a({},n),{},{nothrow:!0}),r);if(i)return i;if(vt(e)&&(i=jn(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!i&&(null===n||void 0===n||!n.nothrow))throw new Error(Wn(e));return i}(e,s,n);return o?(r=Fn({url:i,_parse:Zn,loaders:s},n=Ht(n,o,s,i),r||null),await async function(e,t,n,r){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn;rn(e,"no worker provided");const n=e.version}(e),n=Qt(e.options,n),_t(t)){const e=t,{ok:n,redirected:i,status:s,statusText:o,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());r.response={headers:c,ok:n,redirected:i,status:s,statusText:o,type:a,url:l}}t=await On(t,e,n);const i=e;if(i.parseTextSync&&"string"===typeof t)return i.parseTextSync(t,n,r);if(function(e,t){return!!gn.isSupported()&&!!(Jt||null!==t&&void 0!==t&&t._nodeWorkers)&&e.worker&&(null===t||void 0===t?void 0:t.worker)}(e,n))return await _n(e,t,n,r,Zn);if(i.parseText&&"string"===typeof t)return await i.parseText(t,n,r);if(i.parse)return await i.parse(t,n,r);throw rn(!i.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(o,e,n,r)):null}async function Qn(e,t,n,r){let i,s;Array.isArray(t)||Et(t)?(i=t,s=n):(i=[],s=t);const o=Zt(s);let a=e;return"string"===typeof e&&(a=await o(e)),vt(e)&&(a=await o(e)),Array.isArray(i),await Zn(a,i,s)}class $n{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"===typeof e&&(r=Qn(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)})).catch((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class Jn{constructor(e){var t;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:null===(t=e.device)||void 0===t?void 0:t.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:r=!1,persistent:i=!0}=e,s=this._resources[t];s?s.setData(n,r):(s=new $n(t,n,this._context),this._resources[t]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const e in n){const t=n[e],r=this._resources[t.resourceId];r&&r.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:r,requestId:i="default"}=e;const{_resources:s,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),s[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=s[t];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const i=this._consumers,s=i[e]=i[e]||{};let o=s[t];const a=o&&o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),n&&(o?(o.onChange=r,o.resourceId=n.id):o={onChange:r,resourceId:n.id},s[t]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const er=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}=n;const c=i||e&&e.constructor||Float32Array,u=t*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h=1/0;l&&(h=l*r+s);const d=this._allocate(c,u,a,h);return e&&o?d.set(e):a||d.fill(0,0,4),this._release(e),d}release(e){this._release(e)}_allocate(e,t,n,r){let i=Math.max(Math.ceil(t*this.opts.overAlloc),1);i>r&&(i=r);const s=this._pool,o=e.BYTES_PER_ELEMENT*i,a=s.findIndex((e=>e.byteLength>=o));if(a>=0){const t=new e(s.splice(a,1)[0],0,i);return n&&t.fill(0),t}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,i=t.findIndex((e=>e.byteLength>=r));i<0?t.push(n):(i>0||t.length<this.opts.poolSize)&&t.splice(i,0,n),t.length>this.opts.poolSize&&t.shift()}};Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:a({},{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1})};const tr=globalThis.mathgl.config;function nr(e){let{precision:t=tr.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/tr.EPSILON)*tr.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function rr(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ir(e,t,n){return ar(e,(e=>Math.max(t,Math.min(n,e))))}function sr(e,t,n){return rr(e)?e.map(((e,r)=>sr(e,t[r],n))):n*t+(1-n)*e}function or(e,t,n){const r=tr.EPSILON;n&&(tr.EPSILON=n);try{if(e===t)return!0;if(rr(e)&&rr(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!or(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=tr.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{tr.EPSILON=r}}function ar(e,t,n){if(rr(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let i=0;i<n.length&&i<r.length;++i){const r="number"===typeof e?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}class lr extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:rr(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(tr)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+nr(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!or(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const i=e[r],s="number"===typeof t?t:t[r];this[r]=i+n*(s-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=r[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=r[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(tr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function cr(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(JSON.stringify(e)));return e}function ur(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(tr.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}function hr(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class dr extends lr{get x(){return this[0]}set x(e){this[0]=cr(e)}get y(){return this[1]}set y(e){this[1]=cr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return cr(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return cr(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=r[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=r[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return hr(e>=0&&e<this.ELEMENTS,"index is out of range"),cr(this[e])}setComponent(e,t){return hr(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}function fr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pr(e,t,n){const r=t[0],i=t[1],s=t[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,e}const gr=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e};!function(){const e=function(){const e=new we(3);return we!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function mr(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[3]*r+n[7]*i+n[11]*s||1;return e[0]=(n[0]*r+n[4]*i+n[8]*s)/o,e[1]=(n[1]*r+n[5]*i+n[9]*s)/o,e[2]=(n[2]*r+n[6]*i+n[10]*s)/o,e}const _r=[0,0,0];let vr;class yr extends dr{static get ZERO(){return vr||(vr=new yr(0,0,0),Object.freeze(vr)),vr}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&rr(e)?this.copy(e):(tr.debug&&(cr(e),cr(t),cr(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return tr.debug&&(cr(e.x),cr(e.y),cr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=cr(e)}angle(e){return function(e,t){const n=e[0],r=e[1],i=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&fr(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2];e[0]=i*l-s*a,e[1]=s*o-r*l,e[2]=r*a-i*o}(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=_r}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=_r}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=_r}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return pr(this,this,e),this.check()}transformAsVector(e){return mr(this,this,e),this.check()}transformByMatrix3(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2];e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=t[0],l=t[1],c=t[2];let u=i*c-s*l,h=s*a-r*c,d=r*l-i*a,f=i*d-s*h,p=s*u-r*d,g=r*h-i*u;const m=2*o;u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,e[0]=a+u+f,e[1]=l+h+p,e[2]=c+d+g}(this,this,e),this.check()}}const br=new yr;function Er(e,t,n,r){br.set(e,t,n);const i=br.len();return{distance:r/i,normal:new yr(-e/i,-t/i,-n/i)}}let wr;function Sr(e,t){const{size:n=1,startIndex:r=0}=t,i=void 0!==t.endIndex?t.endIndex:e.length,s=(i-r)/n;wr=er.allocate(wr,s,{type:Float32Array,size:2*n});let o=r,a=0;for(;o<i;){for(let t=0;t<n;t++){const r=e[o++];wr[a+t]=r,wr[a+t+n]=(l=r)-Math.fround(l)}a+=2*n}var l;return wr.subarray(0,s*n*2)}function Tr(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}class xr extends lr{toString(){let e="[";if(tr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=cr(n),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function Ar(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Rr(e,t,n,r){const i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}!function(){const e=function(){const e=new we(2);return we!=Float32Array&&(e[0]=0,e[1]=0),e}()}();var Pr;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(Pr||(Pr={}));const Cr=45*Math.PI/180,kr=1,Lr=.1,Mr=500,Ir=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Or extends xr{static get IDENTITY(){return function(){Fr||(Fr=new Or,Object.freeze(Fr));return Fr}()}static get ZERO(){return function(){Nr||(Nr=new Or([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Nr));return Nr}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Pr}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=t,this[5]=s,this[6]=c,this[7]=f,this[8]=n,this[9]=o,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Ir)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,d=i*o,f=i*a,p=i*l,g=s*o,m=s*a,_=s*l;e[0]=1-h-p,e[1]=u+_,e[2]=d-m,e[3]=0,e[4]=u-_,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=d+m,e[9]=f-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:i,near:s=Lr,far:o=Mr}=e;return o===1/0?function(e,t,n,r,i,s){const o=2*s/(n-t),a=2*s/(i-r),l=(n+t)/(n-t),c=(i+r)/(i-r),u=-1,h=-1,d=-2*s;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,n,r,i,s):function(e,t,n,r,i,s,o){const a=1/(n-t),l=1/(i-r),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*l,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,t,n,r,i,s,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return function(e,t,n,r){let i,s,o,a,l,c,u,h,d,f;const p=t[0],g=t[1],m=t[2],_=r[0],v=r[1],y=r[2],b=n[0],E=n[1],w=n[2];Math.abs(p-b)<Ee&&Math.abs(g-E)<Ee&&Math.abs(m-w)<Ee?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(h=p-b,d=g-E,f=m-w,i=1/Math.sqrt(h*h+d*d+f*f),h*=i,d*=i,f*=i,s=v*f-y*d,o=y*h-_*f,a=_*d-v*h,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=d*a-f*o,c=f*s-h*a,u=h*o-d*s,i=Math.sqrt(l*l+c*c+u*u),i?(i=1/i,l*=i,c*=i,u*=i):(l=0,c=0,u=0),e[0]=s,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=c,e[6]=d,e[7]=0,e[8]=a,e[9]=u,e[10]=f,e[11]=0,e[12]=-(s*p+o*g+a*m),e[13]=-(l*p+c*g+u*m),e[14]=-(h*p+d*g+f*m),e[15]=1)}(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:i,near:s=Lr,far:o=Mr}=e;return Le(this,t,n,r,i,s,o),this.check()}orthographic(e){const{fovy:t=Cr,aspect:n=kr,focalDistance:r=1,near:i=Lr,far:s=Mr}=e;Dr(t);const o=t/2,a=r*Math.tan(o),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:s})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=e;return Dr(t),ke(this,t,n,r,i),this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=t*o-n*s,_=t*a-r*s,v=n*a-r*o,y=c*p-u*f,b=c*g-h*f,E=u*g-h*p;return l*(t*E-n*b+r*y)-i*(s*E-o*b+a*y)+e[15]*(c*v-u*_+h*m)-d*(f*v-p*_+g*m)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*s,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*s,e}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return Te(this,this),this.check()}multiplyLeft(e){return xe(this,e,this),this.check()}multiplyRight(e){return xe(this,this,e),this.check()}rotateX(e){return Pe(this,this,e),this.check()}rotateY(e){return function(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*r,e[1]=o*i-u*r,e[2]=a*i-h*r,e[3]=l*i-d*r,e[8]=s*r+c*i,e[9]=o*r+u*i,e[10]=a*r+h*i,e[11]=l*r+d*i}(this,this,e),this.check()}rotateZ(e){return Ce(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,r){let i,s,o,a,l,c,u,h,d,f,p,g,m,_,v,y,b,E,w,S,T,x,A,R,P=r[0],C=r[1],k=r[2],L=Math.sqrt(P*P+C*C+k*k);L<Ee||(L=1/L,P*=L,C*=L,k*=L,s=Math.sin(n),i=Math.cos(n),o=1-i,a=t[0],l=t[1],c=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],g=t[8],m=t[9],_=t[10],v=t[11],y=P*P*o+i,b=C*P*o+k*s,E=k*P*o-C*s,w=P*C*o-k*s,S=C*C*o+i,T=k*C*o+P*s,x=P*k*o+C*s,A=C*k*o-P*s,R=k*k*o+i,e[0]=a*y+h*b+g*E,e[1]=l*y+d*b+m*E,e[2]=c*y+f*b+_*E,e[3]=u*y+p*b+v*E,e[4]=a*w+h*S+g*T,e[5]=l*w+d*S+m*T,e[6]=c*w+f*S+_*T,e[7]=u*w+p*S+v*T,e[8]=a*x+h*A+g*R,e[9]=l*x+d*A+m*R,e[10]=c*x+f*A+_*R,e[11]=u*x+p*A+v*R,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return Re(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ae(this,this,e),this.check()}transform(e,t){return 4===e.length?(ur(t=Se(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=function(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}(t||[-0,-0],e,this);break;case 3:r=pr(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ur(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1],s=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/s,e[1]=(n[1]*r+n[5]*i)/s,e}(t||[-0,-0],e,this);break;case 3:n=mr(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ur(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let Nr,Fr;function Dr(e){if(e>2*Math.PI)throw Error("expected radians")}function Br(e,t){const n=Se([],t,e);var r,i,s;return r=n,i=n,s=1/n[3],r[0]=i[0]*s,r[1]=i[1]*s,r[2]=i[2]*s,r[3]=i[3]*s,n}function Ur(e,t){const n=e%t;return n<0?t+n:n}function zr(e,t,n){return e<t?t:e>n?n:e}const Gr=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function jr(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Vr=Math.PI,Wr=Vr/4,Hr=Vr/180,Xr=180/Vr,qr=512,Kr=4003e4,Yr=85.051129,Zr=1.5;function Qr(e){const[t,n]=e;jr(Number.isFinite(t)),jr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*Hr;return[qr*(t*Hr+Vr)/(2*Vr),qr*(Vr+Math.log(Math.tan(Wr+.5*r)))/(2*Vr)]}function $r(e){const[t,n]=e,r=t/qr*(2*Vr)-Vr,i=2*(Math.atan(Math.exp(n/qr*(2*Vr)-Vr))-Wr);return[r*Xr,i*Xr]}function Jr(e){const{latitude:t}=e;jr(Number.isFinite(t));const n=Math.cos(t*Hr);return function(e){return Gr(e)}(Kr*n)-9}function ei(e){return 12790407194604047e-21/Math.cos(e*Hr)}function ti(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;jr(Number.isFinite(t)&&Number.isFinite(n));const i=qr,s=Math.cos(t*Hr),o=i/360,a=o/s,l=12790407194604047e-21/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(r){const e=Hr*Math.tan(t*Hr)/s,n=o*e/2,r=12790407194604047e-21*e,i=r/a*l;c.unitsPerDegree2=[0,n,r],c.unitsPerMeter2=[i,0,i]}return c}function ni(e,t){const[n,r,i]=e,[s,o,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=ti({longitude:n,latitude:r,highPrecision:!0}),u=Qr(e);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=$r(u),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function ri(e){const{width:t,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=ii(Zr)}=e;void 0!==r&&(u=ii(r));const h=u*Hr,d=i*Hr,f=si(u);let p=f;o&&(p+=o[2]*a/Math.cos(d)/n);const g=h*(.5+(s?s[1]:0)/n),m=Math.sin(g)*p/Math.sin(zr(Math.PI/2-d-g,.01,Math.PI-.01)),_=Math.sin(d)*m+p,v=10*p;return{fov:h,aspect:t/n,focalDistance:f,near:l,far:Math.min(_*c,v)}}function ii(e){return 2*Math.atan(.5/e)*Xr}function si(e){return.5/Math.tan(.5*e*Hr)}function oi(e,t){const[n,r,i=0]=e;return jr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Br(t,[n,r,i,1])}function ai(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[r,i,s]=e;if(jr(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s)){return Br(t,[r,i,s,1])}const o=Br(t,[r,i,0,1]),a=Br(t,[r,i,1,1]),l=o[2],c=a[2];return Rr([],o,a,l===c?0:((n||0)-l)/(c-l))}function li(e){const{width:t,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[c,u]]=r,h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return jr(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),d=Qr([a,zr(u,-85.051129,Yr)]),f=Qr([c,zr(l,-85.051129,Yr)]),p=[Math.max(Math.abs(f[0]-d[0]),i),Math.max(Math.abs(f[1]-d[1]),i)],g=[t-h.left-h.right-2*Math.abs(o[0]),n-h.top-h.bottom-2*Math.abs(o[1])];jr(g[0]>0&&g[1]>0);const m=g[0]/p[0],_=g[1]/p[1],v=(h.right-h.left)/2/m,y=(h.top-h.bottom)/2/_,b=$r([(f[0]+d[0])/2+v,(f[1]+d[1])/2+y]),E=Math.min(s,Gr(Math.abs(Math.min(m,_))));return jr(Number.isFinite(E)),{longitude:b[0],latitude:b[1],zoom:E}}const ci=Math.PI/180;function ui(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=Br(r,[t,0,1,1]),s=Br(r,[t,e.height,1,1]),o=$r(Rr([],i,s,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return o.push(n),o}const hi=Math.PI/180,di=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],fi=[0,0,0],pi={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class gi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||pi,this.focalDistance=e.focalDistance||1,this.position=e.position||fi,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?pe.WEB_MERCATOR:pe.WEB_MERCATOR_AUTO_OFFSET:pe.IDENTITY}equals(e){return e instanceof gi&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&or(e.projectionMatrix,this.projectionMatrix)&&or(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=oi(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,s=t?i:this.height-i;return 2===e.length?[r,s]:[r,s,n[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=ai([r,o,s],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(s)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=Qr(e);return t[1]=ir(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?$r(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),n=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),i=this.unproject([this.width,this.height],e);return[Math.min(t[0],n[0],r[0],i[0]),Math.min(t[1],n[1],r[1],i[1]),Math.max(t[0],n[0],r[0],i[0]),Math.max(t[1],n[1],r[1],i[1])]}getDistanceScales(e){return e?ti({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:r=1,height:i=1}=e;return t<this.x+this.width&&this.x<t+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Er((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:Er(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:Er(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:Er(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:Er(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:Er(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Jr({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||ti({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:i,modelMatrix:s}=e;let o=fi;if(i&&(o=s?new Or(s).transformAsVector(i,[]):i),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new yr(o).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=di,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:i,fovy:s=75,near:o=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new Or).multiplyRight(t).translate(new yr(this.center).negate()),this.projectionMatrix=n||function(e){let{width:t,height:n,orthographic:r,fovyRadians:i,focalDistance:s,padding:o,near:a,far:l}=e;const c=t/n,u=r?(new Or).orthographic({fovy:i,aspect:c,focalDistance:s,near:a,far:l}):(new Or).perspective({fovy:i,aspect:c,near:a,far:l});if(o){const{left:e=0,right:r=0,top:i=0,bottom:s=0}=o,a=ir((e+t-r)/2,0,t)-t/2,l=ir((i+n-s)/2,0,n)-n/2;u[8]-=2*a/t,u[9]+=2*l/n}return u}({width:this.width,height:this.height,orthographic:r,fovyRadians:i||s*hi,focalDistance:c,padding:l,near:o,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;xe(u,u,this.projectionMatrix),xe(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=Te([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Re(d,d,[this.width/2,-this.height/2,1]),Ae(d,d,[1,-1,0]),xe(f,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=Te([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||de.warn("Pixel project matrix not invertible")()}}gi.displayName="Viewport";const mi=gi;class _i{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{ot("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:n,stats:r,viewport:i,timeline:s}=t||{};this.layers=[],this.resourceManager=new Jn({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:null===e||void 0===e?void 0:e.gl,deck:n,shaderAssembler:He(),defaultShaderModules:[],renderPass:void 0,stats:r||new dt({id:"deck.gl"}),viewport:i||new mi({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new u,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter((t=>e.find((e=>0===t.id.indexOf(e))))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){ot("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=at(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find((t=>t.name===e.name))||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex((t=>t.name===e.name));n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const s of e)n[s.id]?de.warn("Multiple old layers with same id ".concat(s.id))():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let i=!1;for(const s of r)if(s.hasUniformTransition()){i="Uniform transition in ".concat(s);break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const e=t[i.id];null===e&&de.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let s=null;try{this._debug&&e!==i&&i.validateProps(),e?(this._transferLayerState(e,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(r){this._handleError("matching",r,i)}s&&this._updateSublayersRecursively(s,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Ke}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=qe,t!==e&&(e.lifecycle=Ye)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Ze;try{e._finalize(),e.lifecycle=Qe}catch(t){this._handleError("finalization",t,e)}}}function vi(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!vi(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!vi(e[s],t[s],n-1))return!1}return!0}return!1}class yi{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter((t=>t.containsPixel(e))):this._viewports}getViews(){const e={};return this.views.forEach((t=>{e[t.id]=t})),e}getView(e){return this.views.find((t=>t.id===e))}getViewState(e){const t="string"===typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let i=n.length-1;i>=0;--i){const s=n[i];if(s.containsPixel(r)){const n=e.slice();return n[0]-=s.x,n[1]-=s.y,s.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=at(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!vi(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else de.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>{var n;return null===(n=this.getView(e.id))||void 0===n?void 0:n.makeViewport({viewState:t,width:this.width,height:this.height})}})}_updateController(e,t,n,r){const i=e.controller;if(i&&n){const s=a(a(a({},t),i),{},{id:e.id,x:n.x,y:n.y,width:n.width,height:n.height});return r&&r.constructor===i.type||(r=this._createController(e,s)),r&&r.setProps(s),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const i=e[r],s=this.getViewState(i),o=i.makeViewport({viewState:s,width:this.width,height:this.height});let a=t[i.id];const l=Boolean(i.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[i.id]=this._updateController(i,s,o,a),o&&this._viewports.unshift(o)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)}))}_diffViews(e,t){return e.length!==t.length||e.some(((n,r)=>!e[r].equals(t[r])))}}const bi=/([0-9]+\.?[0-9]*)(%|px)/;function Ei(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=bi.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function wi(e,t){return e.relative?Math.round(e.position*t):e.position}class Si{constructor(e){const{id:t,x:n=0,y:r=0,width:i="100%",height:s="100%",padding:o=null}=e;this.id=t||this.constructor.displayName||"view",this.props=a(a({},e),{},{id:this.id}),this._x=Ei(n),this._y=Ei(r),this._width=Ei(i),this._height=Ei(s),this._padding=o&&{left:Ei(o.left||0),right:Ei(o.right||0),top:Ei(o.top||0),bottom:Ei(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.ViewportType===e.ViewportType&&vi(this.props,e.props,2)}makeViewport(e){let{width:t,height:n,viewState:r}=e;r=this.filterViewState(r);const i=this.getDimensions({width:t,height:n});return i.height&&i.width?new this.ViewportType(a(a(a({},r),this.props),i)):null}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=a({},e);for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const r={x:wi(this._x,t),y:wi(this._y,n),width:wi(this._width,t),height:wi(this._height,n)};return this._padding&&(r.padding={left:wi(this._padding.left,t),top:wi(this._padding.top,n),right:wi(this._padding.right,t),bottom:wi(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:a({type:this.ControllerType},e):null}}class Ti extends mi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:i=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:h=!1,projectionMatrix:d,repeat:f=!1,worldOffset:p=0,position:g,padding:m,legacyMeterSizes:_=!1}=e;let{width:v,height:y,altitude:b=1.5}=e;const E=Math.pow(2,r);let w;v=v||1,y=y||1;let S=null;if(d)b=d[5]/2,w=ii(b);else{let n;if(e.fovy?(w=e.fovy,b=si(w)):w=ii(b),m){const{top:e=0,bottom:t=0}=m;n=[0,ir((e+y-t)/2,0,y)-y/2]}S=ri({width:v,height:y,scale:E,center:g&&[0,0,g[2]*ei(t)],offset:n,pitch:i,fovy:w,nearZMultiplier:o,farZMultiplier:l}),Number.isFinite(c)&&(S.near=c),Number.isFinite(u)&&(S.far=u)}let T=function(e){const{height:t,pitch:n,bearing:r,altitude:i,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ae(a,a,[0,0,-i]),Pe(a,a,-n*Hr),Ce(a,a,r*Hr);const l=s/t;var c,u;return Re(a,a,[l,l,l]),o&&Ae(a,a,((c=[])[0]=-(u=o)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:y,pitch:i,bearing:s,scale:E,altitude:b});if(p){T=(new Or).translate([512*p,0,0]).multiplyLeft(T)}super(a(a(a({},e),{},{width:v,height:y,viewMatrix:T,longitude:n,latitude:t,zoom:r},S),{},{fovy:w,focalDistance:b})),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=s,this.altitude=b,this.fovy=w,this.orthographic=h,this._subViewports=f?[]:null,this._pseudoMeters=_,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new Ti(a(a({},this),{},{worldOffset:r})):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*ei(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/ei(n)]}addMetersToLngLat(e,t){return ni(e,t)}panByPosition(e,t){const n=ai(t,this.pixelUnprojectionMatrix),r=Ar([],this.projectFlat(e),((i=[])[0]=-(s=n)[0],i[1]=-s[1],i));var i,s;const o=Ar([],this.center,r),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r,unproject:i}=e,s={targetZ:t},o=i([0,r],s),a=i([n,r],s);let l,c;return(e.fovy?.5*e.fovy*ci:Math.atan(.5/e.altitude))>(90-e.pitch)*ci-.01?(l=ui(e,0,t),c=ui(e,n,t)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:o}=li(a({width:n,height:r,bounds:e},t));return new Ti({width:n,height:r,longitude:i,latitude:s,zoom:o})}}Ti.displayName="WebMercatorViewport";const xi=Ti;class Ai{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var t,n;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(n=this.settings).onStart)||void 0===t||t.call(n,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Ri=()=>{},Pi=2,Ci=3,ki=e=>e,Li=1;class Mi{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:i,duration:s,easing:o}}=e,l=o(t/s),c=n.interpolateProps(r,i,l);this.propsInTransition=this.getControllerState(a(a({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Ai(e.timeline),this.onViewStateChange=e.onViewStateChange||Ri,this.onStateChange=e.onStateChange||Ri}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r=a(a({},n),e===Pi?t:this.propsInTransition||n)}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===Ci||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),i=t.transitionInterpolator,s=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0===s)return;const o=i.initializeProps(e,r);this.propsInTransition={};const a={duration:s,easing:t.transitionEasing||ki,interpolator:i,interruption:t.transitionInterruption||Li,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===e||void 0===e||e(t)}}}function Ii(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class Oi{constructor(e){const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!or(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const i of this._propsToExtract)(i in e||i in t)&&(n[i]=e[i],r[i]=t[i]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach((t=>{const n=e[t];Ii(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))}))}}const Ni=["longitude","latitude","zoom","bearing","pitch"],Fi=["longitude","latitude","zoom"];class Di extends Oi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Ni,required:Fi},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:i}=this.opts;if(r&&i){const s=r(e),o=r(t),a=s.unproject(i);n.start.around=i,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=sr(e[i]||0,t[i]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport(a(a({},t),r));Object.assign(r,i.panByPosition(t.aroundPosition,sr(e.around,t.around,n)))}return r}}const Bi={transitionDuration:0},Ui=e=>1-(1-e)*(1-e),zi=["wheel"],Gi=["panstart","panmove","panend"],ji=["pinchstart","pinchmove","pinchend"],Vi=["tripanstart","tripanmove","tripanend"],Wi=["doubletap"],Hi=["keydown"],Xi={};class qi{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new Mi(a(a({},e),{},{getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState(a(a({makeViewport:this.makeViewport},this.props),this.state)),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout((()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)}),e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(zi,c&&n),this.toggleEvents(Gi,c),this.toggleEvents(ji,c&&(o||a)),this.toggleEvents(Vi,c&&a),this.toggleEvents(Wi,c&&s),this.toggleEvents(Hi,c&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach((e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))}))}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=a(a({},e.getViewportProps()),t),i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),i){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange(a(a({},e),{},{interactionState:this._interactionState,viewId:this.props.id}))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,Bi,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,Bi,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,a(a({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Ui}),{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Bi,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,a(a({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Ui}),{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:i}=e;let s=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==s&&(s=1/s);const o=this.controllerState.zoom({pos:t,scale:s});return this.updateViewport(o,a(a({},this._getTransitionProps({around:t})),{},{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,Bi,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Bi,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,a(a({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Ui}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Xi._startPinchRotation=e.rotation,Xi._lastPinchEvent=e,this.updateViewport(n,Bi,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:Xi._startPinchRotation-n})}return this.updateViewport(t,Bi,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Xi._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=Xi;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let i=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),l=Math.pow(2,s+o*t/2);i=i.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(i,a(a({},this._getTransitionProps({around:r})),{},{transitionDuration:t,transitionEasing:Ui}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Xi._startPinchRotation=null,Xi._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(i),l.isRotating=!0):(a=o.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(i),l.isRotating=!0):(a=o.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(s),l.isRotating=!0):(a=o.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(s),l.isRotating=!0):(a=o.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?a(a({},t),{},{transitionInterpolator:new Di(a(a(a({},e),t.transitionInterpolator.opts),{},{makeViewport:this.controllerState.makeViewport}))}):t:Bi}}class Ki{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Yi extends Ki{constructor(e){const{width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:h=0,maxPitch:d=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:_,startPitch:v,startZoom:y,normalize:b=!0}=e;Ii(Number.isFinite(i)),Ii(Number.isFinite(r)),Ii(Number.isFinite(s)),super({width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o,pitch:a,altitude:l,maxZoom:u,minZoom:h,maxPitch:d,minPitch:f,normalize:b,position:c},{startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:_,startPitch:v,startZoom:y}),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:r=0}=e;const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||void 0===s||void 0===o)return this;let a;return a=t?this._getNewRotation(t,i,o,s):{bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:r}=e,{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(t)),!s)return this;const{maxZoom:o,minZoom:l}=this.getViewportProps();let c=i+Math.log2(r);c=ir(c,l,o);const u=this.makeViewport(a(a({},this.getViewportProps()),{},{zoom:c}));return this._getUpdatedState(a({zoom:c},u.panByPosition(s,t)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n=a({},this.getViewportProps()),{bearing:r,longitude:i}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=ir(r,n,t);const{maxPitch:i,minPitch:s,pitch:o}=e;e.pitch=ir(o,s,i);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:r=0}=e;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=e;(i<-180||i>180)&&(i=Ur(i+180,360)-180),(a<-180||a>180)&&(a=Ur(a+180,360)-180);const l=Gr(n/512);if(o<=l)o=l,s=0;else{const e=n/2/Math.pow(2,o),t=$r([0,e])[1];if(s<t)s=t;else{const t=$r([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor(a(a(a({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),e))}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,r){const i=e[0]-t[0],s=e[1]-t[1],o=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=i/l;let h=0;s>0?Math.abs(c-a)>5&&(h=s/(a-c)*1.2):s<0&&a>5&&(h=1-o/a),h=ir(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:r+180*u}}}class Zi extends qi{constructor(){super(...arguments),this.ControllerState=Yi,this.transition={transitionDuration:300,transitionInterpolator:new Di({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(a(a({makeViewport:this.makeViewport},e),this.state)))}}class Qi extends Si{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}get ViewportType(){return xi}get ControllerType(){return Zi}}Qi.displayName="MapView";const $i=Qi,Ji=[255,255,255],es=1;let ts=0;class ns{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="ambient";const{color:t=Ji}=e,{intensity:n=es}=e;this.id=e.id||"ambient-".concat(ts++),this.color=t,this.intensity=n}}const rs=[255,255,255],is=1,ss=[0,0,-1];let os=0;class as{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="directional";const{color:t=rs}=e,{intensity:n=is}=e,{direction:r=ss}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-".concat(os++),this.color=t,this.intensity=n,this.type="directional",this.direction=new yr(r).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class ls{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};const{id:n}=t;this.id=n,this.device=e,this.props=a({},t)}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class cs extends ls{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){var t,n,r;const[i,s]=this.device.canvasContext.getDrawingBufferSize(),o=null===(t=e.clearCanvas)||void 0===t||t,a=null!==(n=e.clearColor)&&void 0!==n?n:!!o&&[0,0,0,0],l=!!o&&1,c=!!o&&0,u=null!==(r=e.colorMask)&&void 0!==r?r:15,h={viewport:[0,0,i,s]};e.colorMask&&(h.colorMask=u),e.scissorRect&&(h.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:h,clearColor:a,clearDepth:l,clearStencil:c});try{return this._drawLayers(d,e)}finally{d.end()}}_drawLayers(e,t){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const l=[];for(const c of i){const i=s&&s[c.id];null===o||void 0===o||o(c);const a=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const s of u){const o=this._drawLayersInViewport(e,{target:n,moduleParameters:r,viewport:s,view:i,pass:t.pass,layers:t.layers},a);l.push(o)}}return l}_getDrawLayerParams(e,t){let{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:l,moduleParameters:c}=t,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const h=[],d=us(this._lastRenderIndex+1),f={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},p={};for(let m=0;m<n.length;m++){const t=n[m],i=this._shouldDrawLayer(t,f,s,p),o={shouldDrawLayer:i};var g;if(i&&!u)o.layerRenderIndex=d(t,i),o.moduleParameters=this._getModuleParameters(t,l,r,c),o.layerParameters=a(a({},null===(g=t.context.deck)||void 0===g?void 0:g.props.parameters),this.getLayerParameters(t,m,e));h[m]=o}return h}_drawLayersInViewport(e,t,n){let{layers:r,moduleParameters:i,pass:s,target:o,viewport:a,view:l}=t;const c=function(e,t){let{moduleParameters:n,target:r,viewport:i}=t;const s=n&&n.devicePixelRatio||e.canvasContext.cssToDeviceRatio(),[,o]=e.canvasContext.getDrawingBufferSize(),a=r?r.height:o,l=i;return[l.x*s,a-(l.y+l.height)*s,l.width*s,l.height*s]}(this.device,{moduleParameters:i,target:o,viewport:a});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:c},(()=>this.device.clearWebGL(e)))}const u={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let d=0;d<r.length;d++){const t=r[d],{shouldDrawLayer:i,layerRenderIndex:o,moduleParameters:l,layerParameters:c}=n[d];if(i&&t.props.pickable&&u.pickableCount++,t.isComposite)u.compositeCount++;else if(i){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,o),l.viewport=a,t.context.renderPass=e;try{t._drawLayer({renderPass:e,moduleParameters:l,uniforms:{layerIndex:o},parameters:c})}catch(h){t.raiseError(h,"drawing ".concat(t," to ").concat(s))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let i=e.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(t))return!1;t.layer=i,i=i.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,n,r){var i;const s=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create((null===(i=e.internalState)||void 0===i?void 0:i.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,picking:{isActive:0},devicePixelRatio:s});if(t)for(const l of t){var a;Object.assign(o,null===(a=l.getModuleParameters)||void 0===a?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,t),r)}}function us(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in t)&&r(i.parent,!1),l in n){const e=n[l]=n[l]||us(t[l],t);c=e(i,s),n[a]=e}else Number.isFinite(o)?(c=o+(t[l]||0),n[a]=null):c=e;return s&&c>=e&&(e=c+1),t[a]=c,c};return r}class hs extends cs{constructor(e,t){super(e,t),this.shadowMap=e.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],i=r.width*n,s=r.height*n;i===t.width&&s===t.height||t.resize({width:i,height:s}),super.render(a(a({},e),{},{clearColor:[1,1,1,1],target:t,pass:"shadow"}))}getLayerParameters(e,t,n){return a(a({},e.props.parameters),{},{blend:!1,depthRange:[0,1],depthTest:!0})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const ds=Ie((function(e){let{viewport:t,center:n}=e;return new Or(t.viewProjectionMatrix).invert().transform(n)})),fs=Ie((function(e){let{viewport:t,shadowMatrices:n}=e;const r=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,o=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((e=>function(e,t){const[n,r,i]=e,s=ai([n,r,i],t);if(Number.isFinite(i))return s;return[s[0],s[1],0]}(e,i)));for(const a of n){const e=a.clone().translate(new yr(t.center).negate()),n=o.map((t=>e.transform(t))),i=(new Or).ortho({left:Math.min(...n.map((e=>e[0]))),right:Math.max(...n.map((e=>e[0]))),bottom:Math.min(...n.map((e=>e[1]))),top:Math.max(...n.map((e=>e[1]))),near:Math.min(...n.map((e=>-e[2]))),far:Math.max(...n.map((e=>-e[2])))});r.push(i.multiplyRight(a))}return r})),ps=[0,0,0,1],gs=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const ms={name:"shadow",dependencies:[je],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?function(e,t){const{shadowEnabled:n=!0}=e;if(!n||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const r={shadow_uDrawShadowMap:Boolean(e.drawToShadowMap),shadow_uUseShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,shadow_uColor:e.shadowColor||ps,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},i=ds({viewport:e.viewport,center:t.project_uCenter}),s=[],o=fs({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let a=0;a<e.shadowMatrices.length;a++){const n=o[a],r=n.clone().translate(new yr(e.viewport.center).negate());t.project_uCoordinateSystem===fe.LNGLAT&&t.project_uProjectionMode===pe.WEB_MERCATOR?(o[a]=r,s[a]=i):(o[a]=n.clone().multiplyRight(gs),s[a]=r.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a];for(let a=0;a<2;a++)r["shadow_uShadowMap".concat(a)]=e.shadowMaps&&e.shadowMaps[a]||e.dummyShadowMap;return r}(e,t):{}}},_s={color:[255,255,255],intensity:1},vs=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ys=[0,0,0,200/255];class bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id="lighting-effect",this.shadowColor=ys,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(ms),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((e=>e.shadow)),this.context&&this.setup(this.context),this.props=e}preRender(e){let{layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s,moduleParameters:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((t=>t.getProjectedLight({layer:e}))),pointLights:this.pointLights.map((t=>t.getProjectedLight({layer:e})))},t}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(ms))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new Or).lookAt({eye:new yr(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new hs(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new ns(_s),this.directionalLights.push(new as(vs[0]),new as(vs[1])))}}const Es=new bs;class ws{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find((t=>t.id===e.id))){const n=t.findIndex((t=>function(e,t){var n,r;return(null!==(n=e.order)&&void 0!==n?n:1/0)-(null!==(r=t.order)&&void 0!==r?r:1/0)}(t,e)>0));n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(vi(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];let i=r;e&&e!==r?e.setProps?(e.setProps(r.props),i=e):e.cleanup(this._context):e||r.setup(this._context),n.push(i),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some((e=>e instanceof bs))||this._resolvedEffects.push(Es),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class Ss extends cs{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const Ts={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class xs extends cs{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:d,pass:f="picking",pickZ:p,moduleParameters:g}=e;this.pickZ=p;const m=this._resetColorEncoder(p),_=[a,l,c,u],v=super.render({target:o,layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:h,effects:null===d||void 0===d?void 0:d.filter((e=>e.useInPicking)),pass:f,isPicking:!0,moduleParameters:g,clearColor:[0,0,0,0],colorMask:15,scissorRect:_});this._colorEncoderState=null;return{decodePickingColor:m&&As.bind(null,m),stats:v}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(e,t,n){const r=a({depthMask:!0,depthTest:!0,depthRange:[0,1]},e.props.parameters),{pickable:i,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?r.blend=!1:i&&s.includes("draw")&&(Object.assign(r,Ts),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let s,o=r.get(t);o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:t,viewports:[n]},r.set(t,o),i[s]=o):(de.warn("Too many pickable layers, only picking the first 255")(),s=0));return[0,0,0,s/255]}(this._colorEncoderState,e,n)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function As(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class Rs{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Ss(e),this.pickLayersPass=new xs(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n=a({layerFilter:this.layerFilter,isPicking:this.drawPickingColors},e);n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const i=t.render(a(a({},n),{},{target:r}));n.effects&&this._postRender(n.effects,n),this.renderCount++,ot("deckRenderer.renderLayers",this,i,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();0===e.length&&[0,1].map((t=>{const n=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:"deck-renderbuffer-".concat(t),colorAttachments:[n]}))}));for(const n of e)n.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,r=a(a({},t),{},{inputBuffer:n[0],swapBuffer:n[1]});for(const i of e)if(i.postRender){r.target=i.id===this.lastPostProcessEffect?t.target:void 0;const e=i.postRender(r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const Ps={pickedColor:null,pickedObjectIndex:-1};function Cs(e){let{pickedColors:t,decodePickingColor:n,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:o}=e;const{x:l,y:c,width:u,height:h}=o;let d=s*s,f=-1,p=0;for(let a=0;a<h;a++){const e=a+c-i,n=e*e;if(n>d)p+=4*u;else for(let i=0;i<u;i++){if(t[p+3]-1>=0){const e=i+l-r,t=e*e+n;t<=d&&(d=t,f=p)}p+=4}}if(f>=0){const e=t.slice(f,f+4),r=n(e);if(r){const t=Math.floor(f/4/u),n=f/4-t*u;return a(a({},r),{},{pickedColor:e,pickedX:l+n,pickedY:c+t})}de.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Ps}function ks(e){let t,{pickInfo:n,viewports:r,pixelRatio:i,x:s,y:o,z:a}=e,l=r[0];if(r.length>1&&(l=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}((null===n||void 0===n?void 0:n.pickedViewports)||r,{x:s,y:o})),l){const e=[s-l.x,o-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:t,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:i}}function Ls(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:i}=e,{pickedColor:s,pickedLayer:o,pickedObjectIndex:l}=t,c=o?[o]:[];if("hover"===r){const e=n.index,t=n.layerId,r=o?o.props.id:null;if(r!==t||l!==e){if(r!==t){const e=i.find((e=>e.props.id===t));e&&c.unshift(e)}n.layerId=r,n.index=l,n.info=null}}const u=ks(e),h=new Map;return h.set(null,u),c.forEach((e=>{let t=a({},u);e===o&&(t.color=s,t.index=l,t.picked=!0),t=Ms({layer:e,info:t,mode:r});const i=t.layer;e===o&&"hover"===r&&(n.info=t),h.set(i.id,t),"hover"===r&&i.updateAutoHighlight(t)})),h}function Ms(e){let{layer:t,info:n,mode:r}=e;for(;t&&n;){const e=n.layer||null;n.sourceLayer=e,n.layer=t,n=t.getPickingInfo({info:n,mode:r,sourceLayer:e}),t=t.parent}return n}class Is{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new xs(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:r,viewports:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const o=s&&s.layer&&s.layer.id,l=s&&s.viewport&&s.viewport.id,c=o?r.find((e=>e.id===o)):null,u=l&&i.find((e=>e.id===l))||i[0],h=u&&u.unproject([t-u.x,n-u.y]),d={x:t,y:n,viewport:u,coordinate:h,layer:c};return a(a({},s),d)}_resizeBuffer(){var e,t;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:n}=this.device.getCanvasContext();null===(e=this.pickingFBO)||void 0===e||e.resize({width:n.width,height:n.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:n.width,height:n.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter((e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite));return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:r,x:i,y:s,radius:o=0,depth:l=1,mode:c="query",unproject3D:u,onViewportActive:h,effects:d}=e;const f=this.device.canvasContext.cssToDeviceRatio(),p=this._getPickable(t);if(!p||0===r.length)return{result:[],emptyInfo:ks({viewports:r,x:i,y:s,pixelRatio:f})};this._resizeBuffer();const g=this.device.canvasContext.cssToDevicePixels([i,s],!0),m=[g.x+Math.floor(g.width/2),g.y+Math.floor(g.height/2)],_=Math.round(o*f),{width:v,height:y}=this.pickingFBO,b=this._getPickingRect({deviceX:m[0],deviceY:m[1],deviceRadius:_,deviceWidth:v,deviceHeight:y}),E={x:i-o,y:s-o,width:2*o+1,height:2*o+1};let w;const S=[],T=new Set;for(let x=0;x<l;x++){let e,t;if(b){e=Cs(a(a({},this._drawAndSample({layers:p,views:n,viewports:r,onViewportActive:h,deviceRect:b,cullRect:E,effects:d,pass:"picking:".concat(c)})),{},{deviceX:m[0],deviceY:m[1],deviceRadius:_,deviceRect:b}))}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&u&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[e.pickedLayer],views:n,viewports:r,onViewportActive:h,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:E,effects:d,pass:"picking:".concat(c,":z")},!0);i[3]&&(t=i[0])}e.pickedLayer&&x+1<l&&(T.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=Ls({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:c,layers:p,viewports:r,x:i,y:s,z:t,pixelRatio:f});for(const n of w.values())n.layer&&S.push(n);if(!e.pickedColor)break}for(const a of T)a.restorePickingColors();return{result:S,emptyInfo:w.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:r,x:i,y:s,width:o=1,height:l=1,mode:c="query",maxObjects:u=null,onViewportActive:h,effects:d}=e;const f=this._getPickable(t);if(!f||0===r.length)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),g=this.device.canvasContext.cssToDevicePixels([i,s],!0),m=g.x,_=g.y+g.height,v=this.device.canvasContext.cssToDevicePixels([i+o,s+l],!0),y=v.x+v.width,b=v.y,E={x:m,y:b,width:y-m,height:_-b},w=function(e){let{pickedColors:t,decodePickingColor:n}=e;const r=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const e=t.slice(i,i+4),s=e.join(",");if(!r.has(s)){const t=n(e);t?r.set(s,a(a({},t),{},{color:e})):de.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(r.values())}(this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:h,deviceRect:E,cullRect:{x:i,y:s,width:o,height:l},effects:d,pass:"picking:".concat(c)})),S=new Map,T=[],x=Number.isFinite(u);for(let a=0;a<w.length;a++){var A;if(x&&T.length>=u)break;const e=w[a];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:p};t=Ms({layer:e.pickedLayer,info:t,mode:c});const n=t.layer.id;S.has(n)||S.set(n,new Set);const r=S.get(n),o=null!==(A=t.object)&&void 0!==A?A:t.index;r.has(o)||(r.add(o),T.push(t))}return T}_drawAndSample(e){let{layers:t,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,h={layers:t,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const v of a)v.useInPicking&&(h.preRenderStats[v.id]=v.preRender(h));const{decodePickingColor:d}=this.pickLayersPass.render(h),{x:f,y:p,width:g,height:m}=s,_=new(c?Float32Array:Uint8Array)(g*m*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:f,sourceY:p,sourceWidth:g,sourceHeight:m,target:_}),{pickedColors:_,decodePickingColor:d}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}=e;const o=Math.max(0,t-r),a=Math.max(0,n-r),l=Math.min(i,t+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Os={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},Ns="top-left",Fs="__root";class Ds{constructor(e){let{deck:t,parentElement:n}=e;this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!vi(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find((t=>t.id===e.id))||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const e=t[n.id];e?e.viewId!==n.viewId||e.placement!==n.placement?(this._remove(e),this._add(n)):n!==e&&(e.setProps(n.props),n=e):this._add(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const e=t[n];e&&this._remove(e)}this.widgets=e}_add(e){const{viewId:t=null,placement:n=Ns}=e,r=e.onAdd({deck:this.deck,viewId:t});r&&this._getContainer(t,n).append(r),e._element=r}_remove(e){e.onRemove(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){const n=e||Fs;let r=this.containers[n];var i;r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",null===(i=this.parentElement)||void 0===i||i.append(r),this.containers[n]=r);let s=r.querySelector(".".concat(t));return s||(s=document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,Os[t]),r.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const r=this.lastViewports[n]||null,i=n===Fs||r,s=this.containers[n];i?(s.style.display="block",s.style.left="".concat(r?r.x:0,"px"),s.style.top="".concat(r?r.y:0,"px"),s.style.width="".concat(r?r.width:e,"px"),s.style.height="".concat(r?r.height:t,"px")):s.style.display="none"}}onRedraw(e){let{viewports:t,layers:n}=e;const r=t.reduce(((e,t)=>(e[t.id]=t,e)),{}),{lastViewports:i}=this;for(const a of this.getWidgets()){const{viewId:e}=a;if(e){const t=r[e];var s;if(t)a.onViewportChange&&!t.equals(i[e])&&a.onViewportChange(t),null===(s=a.onRedraw)||void 0===s||s.call(a,{viewports:[t],layers:n})}else{var o;if(a.onViewportChange)for(const e of t)e.equals(i[e.id])||a.onViewportChange(e);null===(o=a.onRedraw)||void 0===o||o.call(a,{viewports:t,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,t){for(const i of this.getWidgets()){var n;const{viewId:s}=i;var r;if(!s||s===(null===(n=e.viewport)||void 0===n?void 0:n.id))null===(r=i.onHover)||void 0===r||r.call(i,e,t)}}onEvent(e,t){const n=me[t.type];if(n)for(const s of this.getWidgets()){var r;const{viewId:o}=s;var i;if(!o||o===(null===(r=e.viewport)||void 0===r?void 0:r.id))null===(i=s[n.handler])||void 0===i||i.call(s,e,t)}}}const Bs={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Us{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd(e){let{deck:t}=e;const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,Bs),this.deck=t,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var t;this.isVisible&&e.id===(null===(t=this.lastViewport)||void 0===t?void 0:t.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const r=n(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,n){const r=this.element;if(r){if("string"===typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(n,"px)"),e&&"object"===typeof e&&"style"in e&&Object.assign(r.style,e.style)}}}var zs;const Gs=null===(zs=globalThis.loaders)||void 0===zs?void 0:zs.parseImageNode,js="undefined"!==typeof Image,Vs="undefined"!==typeof ImageBitmap,Ws=Boolean(Gs),Hs=!!Ut||Ws;function Xs(e){const t=Ks(e);if(!t)throw new Error("Not an image");return t}function qs(e){switch(Xs(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Ks(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const Ys=/^data:image\/svg\+xml/,Zs=/\.svg((\?|#).*)?$/;function Qs(e){return e&&(Ys.test(e)||Zs.test(e))}function $s(e,t){if(Qs(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Js(e,t,n){const r=function(e,t){if(Qs(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return $s(e,t)}(e,n),i=self.URL||self.webkitURL,s="string"!==typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((e,t)=>{try{n.onload=()=>e(n),n.onerror=e=>{const n=e instanceof Error?e.message:"error";t(new Error(n))}}catch(r){t(r)}}))}(s||r,t)}finally{s&&i.revokeObjectURL(s)}}const eo={};let to=!0;async function no(e,t,n){let r;if(Qs(n)){r=await Js(e,t,n)}else r=$s(e,n);const i=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||eo)return!1;return!0}(t)&&to||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),to=!1}return await createImageBitmap(e)}(r,i)}function ro(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=(i=t,[...i].map((e=>e.charCodeAt(0))));var i;for(let s=0;s<r.length;++s)if(r[s]!==e[s+n])return!1;return!0}(e,"ftyp",4)?0===(96&e[8])?null:function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}const io=!1,so=!0;function oo(e){const t=ao(e);return function(e){const t=ao(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,io);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,io),height:t.getUint32(20,io)}}(t)||function(e){const t=ao(e),n=t.byteLength>=3&&65496===t.getUint16(0,io)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,io);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,io),width:t.getUint16(s+7,io)};if(!r.has(e))return null;s+=2,s+=t.getUint16(s,io)}return null}(t)||function(e){const t=ao(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,io);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,so),height:t.getUint16(8,so)}}(t)||function(e){const t=ao(e),n=t.byteLength>=14&&16973===t.getUint16(0,io)&&t.getUint32(2,so)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,so),height:t.getUint32(22,so)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=ro(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function ao(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const lo={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.2",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{};let s;switch(function(e){switch(e){case"auto":case"data":return function(){if(Vs)return"imagebitmap";if(js)return"image";if(Hs)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return Vs||js||Hs;case"imagebitmap":return Vs;case"image":return js;case"data":return Hs;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(r)){case"imagebitmap":s=await no(e,t,i);break;case"image":s=await Js(e,t,i);break;case"data":s=await async function(e){var t;const{mimeType:n}=oo(e)||{},r=null===(t=globalThis.loaders)||void 0===t?void 0:t.parseImageNode;return bt(r),await r(e,n)}(e);break;default:bt(!1)}return"data"===r&&(s=qs(s)),s},tests:[e=>Boolean(oo(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const co={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const uo=function(){const e="9.0.40",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(e));return t||(de.log(1,"deck.gl ".concat(e))(),globalThis.deck=a(a({},globalThis.deck),{},{VERSION:e,version:e,log:de,_registerLoggers:st}),function(e){const t=zn();e=Array.isArray(e)?e:[e];for(const n of e){const e=wt(n);t.find((t=>e===t))||t.unshift(e)}}([co,[lo,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}(),ho=new le({id:"luma.gl"});const fo=new class{constructor(){s(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new dt({id:e})),this.stats.get(e)}};const po=function(){const e="9.0.28";if(globalThis.luma&&globalThis.luma.VERSION!==e)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(e));return globalThis.luma||(q()&&ho.log(1,"".concat(e," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:e,version:e,log:ho,stats:fo}),e}(),go={};function mo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";go[e]=go[e]||1;const t=go[e]++;return"".concat(e,"-").concat(t)}function _o(e){let t=!0;for(const n in e){t=!1;break}return t}class vo{constructor(e,t,n){if(s(this,"id",void 0),s(this,"props",void 0),s(this,"userData",{}),s(this,"_device",void 0),s(this,"destroyed",!1),s(this,"allocatedBytes",0),s(this,"_attachedResources",new Set),!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n=a({},t);for(const r in e)void 0!==e[r]&&(n[r]=e[r]);return n}(t,n);const r="undefined"!==this.props.id?this.props.id:mo(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("".concat(t,"s Active")).decrementCount()}trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get("".concat(t," Memory")).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get("".concat(e," Memory")).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}}s(vo,"defaultProps",{id:"undefined",handle:void 0,userData:void 0});class yo extends vo{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t){const n=a({},t);(t.usage||0)&yo.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array&&(n.indexType="uint16")),super(e,n,yo.defaultProps),s(this,"usage",void 0),s(this,"indexType",void 0),s(this,"updateTimestamp",void 0),s(this,"debugData",new ArrayBuffer(0)),this.usage=t.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}readSyncWebGL(e,t){throw new Error("not implemented")}_setDebugData(e,t,n){const r=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:n,yo.DEBUG_DATA_MAX_LENGTH);null===e?this.debugData=new ArrayBuffer(i):0===t&&n===e.byteLength?this.debugData=r.slice(0,i):this.debugData=r.slice(t,t+i)}}function bo(e){const t=function(e){const t=wo[e];return t}(Eo[e]),n=e.includes("norm"),r=!n&&!e.startsWith("float"),i=e.startsWith("s");return{dataType:Eo[e],byteLength:t,integer:r,signed:i,normalized:n}}s(yo,"defaultProps",a(a({},vo.defaultProps),{},{usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1})),s(yo,"MAP_READ",1),s(yo,"MAP_WRITE",2),s(yo,"COPY_SRC",4),s(yo,"COPY_DST",8),s(yo,"INDEX",16),s(yo,"VERTEX",32),s(yo,"UNIFORM",64),s(yo,"STORAGE",128),s(yo,"INDIRECT",256),s(yo,"QUERY_RESOLVE",512),s(yo,"DEBUG_DATA_MAX_LENGTH",32);const Eo={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},wo={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},So=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],To=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function xo(e){const t=To.exec(e);if(t){const[,e,n,r,i,s]=t;if(e){const t=bo("".concat(r).concat(n));return a({format:e,components:e.length,srgb:"-srgb"===i,unsized:"-unsized"===s,webgl:"-webgl"===s},t)}}return function(e){var t;const n=Ao[e];if(!n)throw new Error("Unknown format ".concat(e));return{format:n.format||"",components:n.components||(null===(t=n.format)||void 0===t?void 0:t.length)||1,byteLength:n.bpp||1,srgb:!1,unsized:!1}}(e)}const Ao={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};class Ro{}class Po{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;s(this,"features",void 0),s(this,"disabledFeatures",void 0),this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures[e]&&this.features.has(e)}}class Co{get[Symbol.toStringTag](){return"Device"}constructor(e){s(this,"id",void 0),s(this,"props",void 0),s(this,"userData",{}),s(this,"statsManager",fo),s(this,"_lumaData",{}),s(this,"timestamp",0),this.props=a(a({},Co.defaultProps),e),this.id=this.props.id||mo(this[Symbol.toStringTag].toLowerCase())}isTextureFormatCompressed(e){return t=e,So.some((e=>t.startsWith(e)));var t}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(e){return(e instanceof Promise||"string"===typeof e)&&(e={data:e}),this._createTexture(e)}createCommandEncoder(){throw new Error("not implemented")}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}_getBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=a({},e);return(e.usage||0)&yo.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":ho.warn("indices buffer content must be of integer type")()),t}}function ko(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}s(Co,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:Boolean(ho.get("debug")),spector:Boolean(ho.get("spector")||ho.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:e=>ho.error(e.message)}),s(Co,"VERSION",po);const Lo=new Map;class Mo{static registerDevices(e){for(const t of e)ko(t.type&&t.isSupported&&t.create),Lo.set(t.type,t)}static getAvailableDevices(){return Array.from(Lo).map((e=>e.type))}static getSupportedDevices(){return Array.from(Lo).filter((e=>e.isSupported())).map((e=>e.type))}static setDefaultDeviceProps(e){Object.assign(Co.defaultProps,e)}static async attachDevice(e){const t=Io(e.devices)||Lo;if(e.handle instanceof WebGL2RenderingContext){const n=t.get("webgl");if(n)return await n.attach(e.handle)}if(null===e.handle){const e=t.get("unknown");if(e)return await e.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(){var e,t,n,r;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=a(a({},Mo.defaultProps),i),i.gl&&(i.type="webgl");const s=Io(i.devices)||Lo;let o,l;switch(i.type){case"webgpu":if(o=s.get("webgpu"),o)return await o.create(i);break;case"webgl":if(l=s.get("webgl"),l)return await l.create(i);break;case"unknown":const a=s.get("unknown");if(a)return await a.create(i);break;case"best-available":if(o=s.get("webgpu"),null!==(e=o)&&void 0!==e&&null!==(t=e.isSupported)&&void 0!==t&&t.call(e))return await o.create(i);if(l=s.get("webgl"),null!==(n=l)&&void 0!==n&&null!==(r=n.isSupported)&&void 0!==r&&r.call(n))return await l.create(i)}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){return"webgl"===e||"experimental-webgl"===e?this.originalGetContext("webgl2",t):this.originalGetContext(e,t)}}}function Io(e){if(!e||0===(null===e||void 0===e?void 0:e.length))return null;const t=new Map;for(const n of e)t.set(n.type,n);return t}s(Mo,"defaultProps",a(a({},Co.defaultProps),{},{type:"best-available",devices:void 0})),s(Mo,"stats",fo),s(Mo,"log",ho);const Oo=q()&&"undefined"!==typeof document,No=()=>Oo&&"complete"===document.readyState,Fo={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class Do{static get isPageLoaded(){return No()}constructor(e){if(s(this,"id",void 0),s(this,"props",void 0),s(this,"canvas",void 0),s(this,"htmlCanvas",void 0),s(this,"offscreenCanvas",void 0),s(this,"type",void 0),s(this,"width",1),s(this,"height",1),s(this,"resizeObserver",void 0),s(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1}),this.props=a(a({},Fo),e),e=this.props,!q())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"===typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!t&&!No())throw new Error("Accessing '".concat(e,"' before page was loaded"));if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{var t,n;const r=function(e){const{width:t,height:n}=e,r=document.createElement("canvas");return r.id="lumagl-auto-created-canvas",r.width=t||1,r.height=n||1,r.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",r.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",r}(e),i=function(e){if("string"===typeof e){const t=document.getElementById(e);if(!t&&!No())throw new Error("Accessing '".concat(e,"' before page was loaded"));if(!t)throw new Error("".concat(e," is not an HTML element"));return t}if(e)return e;return document.body}((null===(t=e)||void 0===t?void 0:t.container)||null);i.insertBefore(r,i.firstChild),this.canvas=r,null!==(n=e)&&void 0!==n&&n.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.canvas&&this.update()})),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!==typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!==typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{var e;const[t]=this.getDrawingBufferSize(),n=this._canvasSizeInfo.clientWidth||(null===(e=this.htmlCanvas)||void 0===e?void 0:e.clientWidth);return n?t/n:1}catch(t){return 1}}cssToDevicePixels(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.cssToDeviceRatio(),[r,i]=this.getDrawingBufferSize();return function(e,t,n,r,i){const s=e,o=Bo(s[0],t,n);let a=Uo(s[1],t,r,i),l=Bo(s[0]+1,t,n);const c=l===n-1?l:l-1;let u;l=Uo(s[1]+1,t,r,i),i?(l=0===l?l:l+1,u=a,a=l):u=l===r-1?l:l-1;return{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}(e,n,r,i,t)}setDevicePixelRatio(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.htmlCanvas)return;let n="width"in t?t.width:this.htmlCanvas.clientWidth,r="height"in t?t.height:this.htmlCanvas.clientHeight;n&&r||(ho.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,r=this.htmlCanvas.height||1);const i=this._canvasSizeInfo;if(i.clientWidth!==n||i.clientHeight!==r||i.devicePixelRatio!==e){let t=e;const i=Math.floor(n*t),s=Math.floor(r*t);this.htmlCanvas.width=i,this.htmlCanvas.height=s;const[o,a]=this.getDrawingBufferSize();o===i&&a===s||(t=Math.min(o/n,a/r),this.htmlCanvas.width=Math.floor(n*t),this.htmlCanvas.height=Math.floor(r*t),ho.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=r,this._canvasSizeInfo.devicePixelRatio=e}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){var t;"lumagl-auto-created-canvas"===(null===(t=this.htmlCanvas)||void 0===t?void 0:t.id)&&(this.htmlCanvas.id=e)}}function Bo(e,t,n){return Math.min(Math.round(e*t),n-1)}function Uo(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}s(Do,"pageLoaded",function(){if(No()||"undefined"===typeof window)return Promise.resolve();return new Promise((e=>{window.addEventListener("load",(()=>e()))}))}());const zo={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Go=(e,t,n)=>t?e.enable(n):e.disable(n),jo=(e,t,n)=>e.hint(n,t),Vo=(e,t,n)=>e.pixelStorei(n,t),Wo=(e,t,n)=>{const r=36006===n?36009:36008;return e.bindFramebuffer(r,t)},Ho=(e,t,n)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(r,t)};function Xo(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const qo={3042:Go,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Go,2885:(e,t)=>e.cullFace(t),2929:Go,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Go,35723:jo,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>{var n;return null===(n=e.bindTransformFeedback)||void 0===n?void 0:n.call(e,36386,t)},34229:(e,t)=>e.bindVertexArray(t),36006:Wo,36010:Wo,34964:Ho,36662:Ho,36663:Ho,35053:Ho,35055:Ho,2886:(e,t)=>e.frontFace(t),33170:jo,2849:(e,t)=>e.lineWidth(t),32823:Go,32824:"polygonOffset",10752:"polygonOffset",35977:Go,32926:Go,32928:Go,32938:"sampleCoverage",32939:"sampleCoverage",3089:Go,3088:(e,t)=>e.scissor(...t),2960:Go,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:Go,10754:Go,12288:Go,12289:Go,12290:Go,12291:Go,12292:Go,12293:Go,12294:Go,12295:Go,3333:Vo,3317:Vo,37440:Vo,37441:Vo,37443:Vo,3330:Vo,3332:Vo,3331:Vo,3314:Vo,32878:Vo,3316:Vo,3315:Vo,32877:Vo,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n="number"===typeof t?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=2===(null===t||void 0===t?void 0:t.length)?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=Xo(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=Xo(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=Xo(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function Ko(e,t,n){return void 0!==t[e]?t[e]:n[e]}const Yo={blendEquation:(e,t,n)=>e.blendEquationSeparate(Ko(32777,t,n),Ko(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(Ko(32969,t,n),Ko(32968,t,n),Ko(32971,t,n),Ko(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(Ko(32824,t,n),Ko(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(Ko(32938,t,n),Ko(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,Ko(2962,t,n),Ko(2967,t,n),Ko(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,Ko(34816,t,n),Ko(36003,t,n),Ko(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,Ko(2964,t,n),Ko(2965,t,n),Ko(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,Ko(34817,t,n),Ko(34818,t,n),Ko(34819,t,n))},Zo={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return r?e({[r]:n}):{valueChanged:!0}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},Qo=(e,t)=>e.isEnabled(t),$o={3042:Qo,2884:Qo,2929:Qo,3024:Qo,32823:Qo,32926:Qo,32928:Qo,3089:Qo,2960:Qo,35977:Qo},Jo=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function ea(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const n={};for(const i in t){const r=Number(i),s=qo[i];s&&("string"===typeof s?n[s]=!0:s(e,t[i],r))}const r=e.state&&e.state.cache;if(r)for(const i in n){(0,Yo[i])(e,t,r)}}function ta(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zo;if("number"===typeof t){const n=t,r=$o[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const i of n){const t=$o[i];r[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return r}function na(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}class ra{constructor(e){let{copyState:t=!1,log:n=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,"gl",void 0),s(this,"program",null),s(this,"stateStack",[]),s(this,"enable",!0),s(this,"cache",void 0),s(this,"log",void 0),this.gl=e,this.cache=t?ta(e):Object.assign({},zo),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ko(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];ea(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const i in e){ko(void 0!==i);const s=e[i],o=this.cache[i];na(s,o)||(n=!0,t=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=s)}return{valueChanged:n,oldValue:t}}}function ia(e){return e.state}function sa(e,t){const{enable:n=!0,copyState:r}=t;if(ko(void 0!==r),!e.state){e.state=new ra(e,{copyState:r}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){const r=ia(e);r.program!==n&&(t(n),r.program=n)}}(e);for(const t in Zo){ca(e,t,Zo[t])}la(e,"getParameter"),la(e,"isEnabled")}return ia(e).enable=n,e}function oa(e){let t=ia(e);t||(sa(e,{copyState:!1}),t=ia(e)),t.push()}function aa(e){const t=ia(e);ko(t),t.pop()}function la(e,t){const n=e[t].bind(e);e[t]=function(t){if(void 0===t||Jo.has(t))return n(t);const r=ia(e);return t in r.cache||(r.cache[t]=n(t)),r.enable?r.cache[t]:n(t)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function ca(e,t,n){if(!e[t])return;const r=e[t].bind(e);e[t]=function(){const t=ia(e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];const{valueChanged:a,oldValue:l}=n(t._updateCache,...s);return a&&r(...s),l},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}const ua={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function ha(e,t,n){return void 0===n[t]&&(n[t]=e.getExtension(t)||null),n[t]}function da(e,t){const n=e.getParameter(7936),r=e.getParameter(7937);ha(e,"WEBGL_debug_renderer_info",t);const i=t.WEBGL_debug_renderer_info,s=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936)||n,o=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937)||r,a=e.getParameter(7938),l=fa(s,o),c=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(s,o),u=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(fa(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(s,o);return{type:"webgl",gpu:l,gpuType:u,gpuBackend:c,vendor:s,renderer:o,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function fa(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function pa(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const ga="texture-compression-bc",ma="texture-compression-astc",_a="texture-compression-etc2",va="texture-compression-pvrtc-webgl",ya="texture-compression-atc-webgl",ba="float32-renderable-webgl",Ea="float16-renderable-webgl",wa="snorm8-renderable-webgl",Sa="norm16-renderable-webgl",Ta="snorm16-renderable-webgl",xa="float32-filterable",Aa="float16-filterable-webgl",Ra="WEBGL_compressed_texture_s3tc",Pa="WEBGL_compressed_texture_s3tc_srgb",Ca="EXT_texture_compression_rgtc",ka="EXT_texture_compression_bptc",La="EXT_texture_norm16",Ma="EXT_render_snorm",Ia={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Ma],"norm16-renderable-webgl":[La],"snorm16-renderable-webgl":[La,Ma],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Ra,Pa,Ca,ka],"texture-compression-bc5-webgl":[Ca],"texture-compression-bc7-webgl":[ka],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};function Oa(e,t,n){return(Ia[t]||[]).every((t=>ha(e,t,n)))}const Na={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:wa},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:wa},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:Ea,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:Sa,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:Ta},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:wa},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:Ea,filter:Aa,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:Sa},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:Ta},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:ba,filter:xa},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:"rgb9e5ufloat_renderable-webgl"},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:ba,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:Sa},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:Sa},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:ba,filter:xa,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:Ea,filter:Aa},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:Sa,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:Ta},"rgb32float-webgl":{gl:34837,render:ba,filter:xa,gl2ext:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:ba,filter:xa,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Ra,f:ga},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Pa,f:ga},"bc1-rgba-unorm":{gl:33777,x:Ra,f:ga},"bc1-rgba-unorm-srgb":{gl:35916,x:Pa,f:ga},"bc2-rgba-unorm":{gl:33778,x:Ra,f:ga},"bc2-rgba-unorm-srgb":{gl:35918,x:Pa,f:ga},"bc3-rgba-unorm":{gl:33779,x:Ra,f:ga},"bc3-rgba-unorm-srgb":{gl:35919,x:Pa,f:ga},"bc4-r-unorm":{gl:36283,x:Ca,f:ga},"bc4-r-snorm":{gl:36284,x:Ca,f:ga},"bc5-rg-unorm":{gl:36285,x:Ca,f:ga},"bc5-rg-snorm":{gl:36286,x:Ca,f:ga},"bc6h-rgb-ufloat":{gl:36495,x:ka,f:ga},"bc6h-rgb-float":{gl:36494,x:ka,f:ga},"bc7-rgba-unorm":{gl:36492,x:ka,f:ga},"bc7-rgba-unorm-srgb":{gl:36493,x:ka,f:ga},"etc2-rgb8unorm":{gl:37492,f:_a},"etc2-rgb8unorm-srgb":{gl:37494,f:_a},"etc2-rgb8a1unorm":{gl:37496,f:_a},"etc2-rgb8a1unorm-srgb":{gl:37497,f:_a},"etc2-rgba8unorm":{gl:37493,f:_a},"etc2-rgba8unorm-srgb":{gl:37495,f:_a},"eac-r11unorm":{gl:37488,f:_a},"eac-r11snorm":{gl:37489,f:_a},"eac-rg11unorm":{gl:37490,f:_a},"eac-rg11snorm":{gl:37491,f:_a},"astc-4x4-unorm":{gl:37808,f:ma},"astc-4x4-unorm-srgb":{gl:37840,f:ma},"astc-5x4-unorm":{gl:37809,f:ma},"astc-5x4-unorm-srgb":{gl:37841,f:ma},"astc-5x5-unorm":{gl:37810,f:ma},"astc-5x5-unorm-srgb":{gl:37842,f:ma},"astc-6x5-unorm":{gl:37811,f:ma},"astc-6x5-unorm-srgb":{gl:37843,f:ma},"astc-6x6-unorm":{gl:37812,f:ma},"astc-6x6-unorm-srgb":{gl:37844,f:ma},"astc-8x5-unorm":{gl:37813,f:ma},"astc-8x5-unorm-srgb":{gl:37845,f:ma},"astc-8x6-unorm":{gl:37814,f:ma},"astc-8x6-unorm-srgb":{gl:37846,f:ma},"astc-8x8-unorm":{gl:37815,f:ma},"astc-8x8-unorm-srgb":{gl:37847,f:ma},"astc-10x5-unorm":{gl:37819,f:ma},"astc-10x5-unorm-srgb":{gl:37851,f:ma},"astc-10x6-unorm":{gl:37817,f:ma},"astc-10x6-unorm-srgb":{gl:37849,f:ma},"astc-10x8-unorm":{gl:37818,f:ma},"astc-10x8-unorm-srgb":{gl:37850,f:ma},"astc-10x10-unorm":{gl:37819,f:ma},"astc-10x10-unorm-srgb":{gl:37851,f:ma},"astc-12x10-unorm":{gl:37820,f:ma},"astc-12x10-unorm-srgb":{gl:37852,f:ma},"astc-12x12-unorm":{gl:37821,f:ma},"astc-12x12-unorm-srgb":{gl:37853,f:ma},"pvrtc-rgb4unorm-webgl":{gl:35840,f:va},"pvrtc-rgba4unorm-webgl":{gl:35842,f:va},"pvrtc-rbg2unorm-webgl":{gl:35841,f:va},"pvrtc-rgba2unorm-webgl":{gl:35843,f:va},"etc1-rbg-unorm-webgl":{gl:36196,f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{gl:35986,f:ya},"atc-rgba-unorm-webgl":{gl:35986,f:ya},"atc-rgbai-unorm-webgl":{gl:34798,f:ya}},Fa={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Da={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function Ba(e,t,n){const r=Na[t];if(!r)return!1;if(void 0===r.gl)return!1;const i=r.x||r.gl2ext;return!i||Boolean(ha(e,i,n))}function Ua(e){const t=Na[e],n=null===t||void 0===t?void 0:t.gl;if(void 0===n)throw new Error("Unsupported texture format ".concat(e));return n}function za(e){var t;const n=Na[e],r=Ua(e),i=xo(e);return{format:r,dataFormat:(null===n||void 0===n?void 0:n.dataFormat)||ja(i.format,i.integer,i.normalized,r),type:i.dataType?pa(i.dataType):(null===n||void 0===n||null===(t=n.types)||void 0===t?void 0:t[0])||5121,compressed:i.compressed}}function Ga(e){const t=za(e);return(Fa[t.dataFormat]||4)*(Da[t.type]||1)}function ja(e,t,n,r){if(6408===r||6407===r)return r;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;default:return 6408}}const Va={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class Wa extends Po{constructor(e,t,n){super([],n),s(this,"gl",void 0),s(this,"extensions",void 0),s(this,"testedFeatures",new Set),this.gl=e,this.extensions=t,ha(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in Ia}(e)&&Oa(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter((e=>"polygon-mode-webgl"!==e));for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(Va),...Object.keys(Ia)]}getWebGLFeature(e){const t=Va[e];return"string"===typeof t?Boolean(ha(this.gl,t,this.extensions)):Boolean(t)}}class Ha extends Ro{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}constructor(e){super(),s(this,"gl",void 0),s(this,"limits",{}),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]}}class Xa extends vo{get[Symbol.toStringTag](){return"Texture"}constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xa.defaultProps),s(this,"dimension",void 0),s(this,"format",void 0),s(this,"width",void 0),s(this,"height",void 0),s(this,"depth",void 0),s(this,"updateTimestamp",void 0),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=e.incrementTimestamp()}}s(Xa,"defaultProps",a(a({},vo.defaultProps),{},{data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0})),s(Xa,"COPY_SRC",1),s(Xa,"COPY_DST",2),s(Xa,"TEXTURE_BINDING",4),s(Xa,"STORAGE_BINDING",8),s(Xa,"RENDER_ATTACHMENT",16);class qa extends vo{get[Symbol.toStringTag](){return"Framebuffer"}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},qa.defaultProps),s(this,"width",void 0),s(this,"height",void 0),s(this,"colorAttachments",[]),s(this,"depthStencilAttachment",null),this.width=this.props.width,this.height=this.props.height}resize(e){let t=!e;if(e){const[n,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||n!==this.width,this.width=n,this.height=r}t&&(ho.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(this.width,"x").concat(this.height))(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((e=>{if("string"===typeof e){const t=this.createColorTexture(e);return this.attachResource(t),t.view}return e instanceof Xa?e.view:e}));const e=this.props.depthStencilAttachment;if(e)if("string"===typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else this.depthStencilAttachment=e instanceof Xa?e.view:e}createColorTexture(e){return this.device.createTexture({id:"color-attachment",usage:Xa.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}createDepthStencilTexture(e){return this.device.createTexture({id:"depth-stencil-attachment",usage:Xa.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,t){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const r=this.device._createTexture(a(a({},this.colorAttachments[n].props),{},{width:e,height:t}));this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const n=this.device._createTexture(a(a({},this.depthStencilAttachment.props),{},{width:e,height:t}));this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}}}s(qa,"defaultProps",a(a({},vo.defaultProps),{},{width:1,height:1,colorAttachments:[],depthStencilAttachment:null}));let Ka="";async function Ya(e,t){return await new Promise(((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(e,"."))),i.crossOrigin=(null===t||void 0===t?void 0:t.crossOrigin)||"anonymous",i.src=e.startsWith("http")?e:Ka+e}catch(i){r(i)}}))}async function Za(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",e),t&&(r.id=t),new Promise(((t,i)=>{r.onload=t,r.onerror=t=>i(new Error("Unable to load script '".concat(e,"': ").concat(t))),n.appendChild(r)}))}function Qa(e,t,n){if(function(e){for(const t in e)return!1;return!0}(t))return n(e);const{nocatch:r=!0}=t;let i;if(oa(e),ea(e,t),r)i=n(e),aa(e);else try{i=n(e)}finally{aa(e)}return i}function $a(e,t){const n=e,{gl:r}=n;if(t.cullMode)switch(t.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029)}if(t.frontFace&&r.frontFace(rl("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&r.enable(34383),void 0!==t.depthBias&&(r.enable(32823),r.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,r=rl("provokingVertex",t.provokingVertex,{first:36429,last:36430});null===e||void 0===e||e.provokingVertexWEBGL(r)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,r=rl("polygonMode",t.polygonMode,{fill:6914,line:6913});null===e||void 0===e||e.polygonModeWEBGL(1028,r),null===e||void 0===e||e.polygonModeWEBGL(1029,r)}t.polygonOffsetLine&&r.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&r.enable(12288),t.clipDistance1&&r.enable(12289),t.clipDistance2&&r.enable(12290),t.clipDistance3&&r.enable(12291),t.clipDistance4&&r.enable(12292),t.clipDistance5&&r.enable(12293),t.clipDistance6&&r.enable(12294),t.clipDistance7&&r.enable(12295)),void 0!==t.depthWriteEnabled&&r.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?r.enable(2929):r.disable(2929),r.depthFunc(Ja("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&ho.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,n=Ja("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,n,0,e),r.stencilFuncSeparate(1029,n,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=el("stencilPassOperation",t.stencilPassOperation),n=el("stencilFailOperation",t.stencilFailOperation),i=el("stencilDepthFailOperation",t.stencilDepthFailOperation);r.stencilOpSeparate(1028,n,i,e),r.stencilOpSeparate(1029,n,i,e)}if(t.blendColorOperation||t.blendAlphaOperation){r.enable(3042);const e=tl("blendColorOperation",t.blendColorOperation||"add"),n=tl("blendAlphaOperation",t.blendAlphaOperation||"add");r.blendEquationSeparate(e,n);const i=nl("blendColorSrcFactor",t.blendColorSrcFactor||"one"),s=nl("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=nl("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=nl("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");r.blendFuncSeparate(i,s,o,a)}}function Ja(e,t){return rl(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function el(e,t){return rl(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function tl(e,t){return rl(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function nl(e,t){return rl(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function rl(e,t,n){if(!(t in n))throw new Error(function(e,t){return"Illegal parameter ".concat(t," for ").concat(e)}(e,t));return n[t]}function il(e){const t={};return e.addressModeU&&(t[10242]=sl(e.addressModeU)),e.addressModeV&&(t[10243]=sl(e.addressModeV)),e.addressModeW&&(t[32882]=sl(e.addressModeW)),e.magFilter&&(t[10240]=ol(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e,t){if(!t)return ol(e);switch(e){case"nearest":return"nearest"===t?9984:9986;case"linear":return"nearest"===t?9985:9987}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=Ja("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function sl(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function ol(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}class al extends yo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),s(this,"device",void 0),s(this,"gl",void 0),s(this,"handle",void 0),s(this,"glTarget",void 0),s(this,"glUsage",void 0),s(this,"glIndexType",5123),s(this,"byteLength",void 0),s(this,"bytesUsed",void 0),this.device=e,this.gl=this.device.gl;const n="object"===typeof t?t.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,a(a({},this.props),{},{data:typeof this.props.data})),this.glTarget=function(e){if(e&yo.INDEX)return 34963;if(e&yo.VERTEX)return 34962;if(e&yo.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&yo.INDEX)return 35044;if(e&yo.VERTEX)return 35044;if(e&yo.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,t,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){ko(e>=0);let t=e;0===e&&(t=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)}async readAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.readSyncWebGL(e,t)}readSyncWebGL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;t=null!==t&&void 0!==t?t:this.byteLength-e;const n=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,t),n}}class ll extends vo{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t,ll.defaultProps)}}s(ll,"defaultProps",a(a({},vo.defaultProps),{},{type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1}));class cl extends ll{constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"handle",void 0),s(this,"parameters",void 0),this.device=e,this.parameters=il(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return"Sampler(".concat(this.id,",").concat(JSON.stringify(this.props),")")}_setSamplerParameters(e){for(const[t,n]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,n);break;default:this.device.gl.samplerParameteri(this.handle,e,n)}}}}class ul extends vo{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,ul.defaultProps)}}s(ul,"defaultProps",a(a({},vo.defaultProps),{},{format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}));class hl extends ul{constructor(e,t){super(e,a(a({},Xa.defaultProps),t)),s(this,"device",void 0),s(this,"gl",void 0),s(this,"handle",void 0),s(this,"texture",void 0),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}const dl={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0};class fl extends Xa{constructor(e,t){var n;super(e,a(a({},dl),{},{format:"rgba8unorm"},t)),s(this,"MAX_ATTRIBUTES",void 0),s(this,"device",void 0),s(this,"gl",void 0),s(this,"handle",void 0),s(this,"sampler",void 0),s(this,"view",void 0),s(this,"glFormat",void 0),s(this,"type",void 0),s(this,"dataFormat",void 0),s(this,"mipmaps",void 0),s(this,"target",void 0),s(this,"textureUnit",void 0),s(this,"loaded",!1),s(this,"_video",void 0),this.device=e,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,a(a({},this.props),{},{data:typeof this.props.data})),this.glFormat=6408,this.target=function(e){switch(e.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;default:throw new Error(e.dimension)}}(this.props),this.loaded=!1,"string"===typeof(null===(n=this.props)||void 0===n?void 0:n.data)&&Object.assign(this.props,{data:Ya(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}createView(e){return new hl(this.device,a(a({},e),{},{texture:this}))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("cube"===this.props.dimension)return this.initializeCube(e);let t=e.data;if(t instanceof Promise)return t.then((t=>this.initialize(Object.assign({},e,{pixels:t,data:t})))),this;const n="undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",(()=>this.initialize(e))),this;const{parameters:r={}}=e,{pixels:i=null,pixelStore:s={},textureUnit:o,mipmaps:l=!0}=e;t||(t=i);let{width:c,height:u,dataFormat:h,type:d,compressed:f=!1}=e;const{depth:p=0}=e,g=Ua(e.format);return({width:c,height:u,compressed:f,dataFormat:h,type:d}=this._deduceParameters({format:e.format,type:d,dataFormat:h,compressed:f,data:t,width:c,height:u})),this.width=c,this.height=u,this.glFormat=g,this.type=d,this.dataFormat=h,this.textureUnit=o,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=l,this.setImageData({data:t,width:c,height:u,depth:p,format:e.format,type:d,dataFormat:h,parameters:s,compressed:f}),this.setSampler(e.sampler),this._setSamplerParameters(r),this.view=this.createView(a(a({},this.props),{},{mipLevelCount:1,arrayLayerCount:1})),l&&this.device.isTextureFormatFilterable(e.format)&&this.generateMipmap(),n&&(this._video={video:t,parameters:r,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}initializeCube(e){const{mipmaps:t=!0,parameters:n={}}=e;return this.setCubeMapImageData(e).then((()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setSampler(e.sampler),this._setSamplerParameters(n)})),this}setSampler(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t instanceof cl?(this.sampler=t,e=t.props):(this.sampler=new cl(this.device,t),e=t);const n=il(e);return this._setSamplerParameters(n),this}resize(e){const{height:t,width:n,mipmaps:r=!1}=e;return n!==this.width||t!==this.height?this.initialize({width:n,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:r}):this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Qa(this.gl,e,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this}setImageData(e){if("3d"===this.props.dimension||"2d-array"===this.props.dimension)return this.setImageData3D(e);this.trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:r=0,glFormat:i=this.glFormat,offset:s=0,parameters:o={}}=e;let{data:a=null,type:l=this.type,width:c=this.width,height:u=this.height,dataFormat:h=this.dataFormat,compressed:d=!1}=e;a||(a=n),({type:l,dataFormat:h,compressed:d,width:c,height:u}=this._deduceParameters({format:this.props.format,type:l,dataFormat:h,compressed:d,data:a,width:c,height:u}));const{gl:f}=this;f.bindTexture(this.target,this.handle);let p=null;if(({data:a,dataType:p}=this._getDataType({data:a,compressed:d})),Qa(this.gl,o,(()=>{switch(p){case"null":case"browser-object":f.texImage2D(t,r,i,c,u,0,h,l,a);break;case"typed-array":f.texImage2D(t,r,i,c,u,0,h,l,a,s);break;case"buffer":this.device.gl.bindBuffer(35052,a.handle||a),this.device.gl.texImage2D(t,r,i,c,u,0,h,l,s),this.device.gl.bindBuffer(35052,null);break;case"compressed":for(const[e,n]of a.entries())f.compressedTexImage2D(t,e,n.format,n.width,n.height,0,n.data);break;default:ko(!1,"Unknown image data type")}})),a&&a.byteLength)this.trackAllocatedMemory(a.byteLength,"Texture");else{const e=Ga(this.props.format);this.trackAllocatedMemory(this.width*this.height*e,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:n=null,data:r=null,x:i=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,glFormat:c=this.glFormat,type:u=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:f=0,parameters:p={}}=e;if(({type:u,dataFormat:h,compressed:d,width:o,height:a}=this._deduceParameters({format:this.props.format,type:u,dataFormat:h,compressed:d,data:r,width:o,height:a})),ko(1===this.depth,"texSubImage not supported for 3D textures"),r||(r=n),r&&r.data){const e=r;r=e.data,o=e.shape[0],a=e.shape[1]}r instanceof al&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Qa(this.gl,p,(()=>{d?this.gl.compressedTexSubImage2D(t,l,i,s,o,a,c,r):null===r?this.gl.texSubImage2D(t,l,i,s,o,a,h,u,null):ArrayBuffer.isView(r)?this.gl.texSubImage2D(t,l,i,s,o,a,h,u,r,f):"undefined"!==typeof WebGLBuffer&&r instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,r),this.device.gl.texSubImage2D(t,l,i,s,o,a,h,u,f),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(t,l,i,s,o,a,h,u,r)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ho.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:n=!1}=e;return n?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof al?{data:t.handle,dataType:"buffer"}:"undefined"!==typeof WebGLBuffer&&t instanceof WebGLBuffer?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:r,height:i,dataFormat:s,type:o,compressed:a}=e;const l=za(t);return s=s||l.dataFormat,o=o||l.type,a=a||l.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:s,type:o,compressed:a,width:r,height:i,format:t,data:n}}_deduceImageSize(e,t,n){let r;return r="undefined"!==typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},ko(r,"Could not deduced texture size"),ko(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),ko(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}async setCubeMapImageData(e){const{gl:t}=this,{width:n,height:r,pixels:i,data:s,format:o=6408,type:a=5121}=e,l=i||s,c=await Promise.all(fl.FACES.map((e=>{const t=l[e];return Promise.all(Array.isArray(t)?t:[t])})));this.bind(),fl.FACES.forEach(((e,i)=>{c[i].length>1&&!1!==this.props.mipmaps&&ho.warn("".concat(this.id," has mipmap and multiple LODs."))(),c[i].forEach(((i,s)=>{n&&r?t.texImage2D(e,s,o,n,r,0,o,a,i):t.texImage2D(e,s,o,o,a,i)}))})),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:s,format:o=6408,type:a=5121}=e,{gl:l}=this,c=i||s;return this.bind(),c instanceof Promise?c.then((n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n})))):this.width||this.height?l.texImage2D(t,0,o,n,r,0,o,a,c):l.texImage2D(t,0,o,o,a,c),this}setImageData3D(e){const{level:t=0,dataFormat:n,format:r,type:i,width:s,height:o,depth:a=1,offset:l=0,data:c,parameters:u={}}=e;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const h=za(r);if(Qa(this.gl,u,(()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,t,h.format,s,o,a,0,h.dataFormat,h.type,c),c instanceof al&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,t,n,s,o,a,0,r,i,l))})),c&&c.byteLength)this.trackAllocatedMemory(c.byteLength,"Texture");else{const e=Ga(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*e,"Texture")}return this.loaded=!0,this}_setSamplerParameters(e){if(!_o(e)){!function(e){ho.log(1,"texture sampler parameters",e)()}(e),this.gl.bindTexture(this.target,this.handle);for(const[t,n]of Object.entries(e)){const e=Number(t),r=n;switch(e){case 33082:case 33083:this.gl.texParameterf(this.target,e,r);break;default:this.gl.texParameteri(this.target,e,r)}}this.gl.bindTexture(this.target,null)}}}s(fl,"FACES",[34069,34070,34071,34072,34073,34074]);class pl extends qa{get texture(){return this.colorAttachments[0]}constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"gl",void 0),s(this,"handle",void 0);const n=null===t.handle;if(this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),!n){e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const n=this.gl.bindFramebuffer(36160,this.handle);for(let e=0;e<this.colorAttachments.length;++e){const t=this.colorAttachments[e],n=36064+e;t&&this._attachOne(n,t)}if(this.depthStencilAttachment&&this._attachOne(function(e){const t=Na[e];if(null===t||void 0===t||!t.attachment)throw new Error("".concat(e," is not a depth stencil format"));return t.attachment}(this.depthStencilAttachment.props.format),this.depthStencilAttachment),!1!==t.check){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error("Framebuffer ".concat(function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return"".concat(e)}}(e)))}this.gl.bindFramebuffer(36160,n)}}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(e){return new fl(this.device,{id:"".concat(this.id,"-depth-stencil"),format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){if(null===this.handle)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===t&&(t=this.gl.drawingBufferHeight);for(const n of this.colorAttachments)n.texture.resize({width:e,height:t});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:e,height:t}),this}_attachOne(e,t){if(Array.isArray(t)){const[n,r=0,i=0]=t;return this._attachTexture(e,n,r,i),n}if(t instanceof fl)return this._attachTexture(e,t,0,0),t;if(t instanceof hl){const n=t;return this._attachTexture(e,n.texture,n.props.baseMipLevel,n.props.baseArrayLayer),t.texture}throw new Error("attach")}_attachTexture(e,t,n,r){const{gl:i}=this.device;switch(i.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:i.framebufferTextureLayer(36160,e,t.target,r,n);break;case 34067:const s=function(e){return e<34069?e+34069:e}(n);i.framebufferTexture2D(36160,e,s,t.handle,r);break;case 3553:i.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:ko(!1,"Illegal texture type")}i.bindTexture(t.target,null)}}class gl extends Do{constructor(e,t){super(t),s(this,"device",void 0),s(this,"presentationSize",void 0),s(this,"_framebuffer",null),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId("".concat(this.device.id,"-canvas")),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new pl(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl)if(this.canvas){const t=this.getDevicePixelRatio(null===e||void 0===e?void 0:e.useDevicePixels);this.setDevicePixelRatio(t,e)}else;}commit(){}}const ml={spector:ho.get("spector")||ho.get("spectorjs")};let _l=null,vl=!1;var yl;!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(yl||(yl={}));function bl(e){return e.luma=e.luma||{},e.luma}function El(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?t.debug?function(e,t){if(!globalThis.WebGLDebugUtils)return ho.warn("webgl-debug not loaded")(),e;const n=bl(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init(a(a({},yl),e));const r=globalThis.WebGLDebugUtils.makeDebugContext(e,Sl.bind(null,t),Tl.bind(null,t));for(const o in yl)o in r||"number"!==typeof yl[o]||(r[o]=yl[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=e,n.debugContext=s,s.debug=!0,s}(e,t):function(e){const t=bl(e);return t.realContext?t.realContext:e}(e):null}function wl(e,t){t=Array.from(t).map((e=>void 0===e?"undefined":e));let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n="".concat(n.slice(0,100)).concat(n.length>100?"...":""),"gl.".concat(e,"(").concat(n,")")}function Sl(e,t,n,r){r=Array.from(r).map((e=>void 0===e?"undefined":e));const i=globalThis.WebGLDebugUtils.glEnumToString(t),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o="".concat(i," in gl.").concat(n,"(").concat(s,")");if(ho.error(o)(),e.throwOnError)throw new Error(o)}function Tl(e,t,n){let r="";if(ho.level>=1&&(r=wl(t,n),ho.log(1,r)()),e.break&&e.break.length>0){r=r||wl(t,n);e.break.every((e=>-1!==r.indexOf(e)))}for(const i of n)if(void 0===i){if(r=r||wl(t,n),e.throwOnError)throw new Error("Undefined argument: ".concat(r));ho.error("Undefined argument: ".concat(r))()}}function xl(e,t,n,r){if(null!==r&&void 0!==r&&r.inlineSource){const r=function(e,t,n){let r="";for(let i=t-2;i<=t;i++){const s=e[i-1];void 0!==s&&(r+=Al(s,t,n))}return r}(t,n),i=e.linePos>0?"".concat(" ".repeat(e.linePos+5),"^^^\n"):"";return"\n".concat(r).concat(i).concat(e.type.toUpperCase(),": ").concat(e.message,"\n\n")}return null!==r&&void 0!==r&&r.html?"<div class='luma-compiler-log-error' style=\"color:red;\"><b> ".concat(e.type.toUpperCase(),": ").concat(e.message,"</b></div>"):"".concat(e.type.toUpperCase(),": ").concat(e.message)}function Al(e,t,n){const r=null!==n&&void 0!==n&&n.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return"".concat(function(e,t){let n="";for(let r=e.length;r<t;++r)n+=" ";return n+e}(String(t),4),": ").concat(r).concat(null!==n&&void 0!==n&&n.html?"<br/>":"\n")}function Rl(e,t){return{name:Pl(e,t),language:"glsl",version:Cl(e)}}function Pl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}function Cl(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}class kl extends vo{get[Symbol.toStringTag](){return"Shader"}constructor(e,t){super(e,a({id:Ll(t)},t),kl.defaultProps),s(this,"stage",void 0),s(this,"source",void 0),s(this,"compilationStatus","pending"),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.debug){case"never":return;case"errors":if("success"===this.compilationStatus)return}const e=await this.getCompilationInfo();"warnings"===this.props.debug&&0===(null===e||void 0===e?void 0:e.length)||this._displayShaderLog(e)}_displayShaderLog(e){var t,n;if("undefined"===typeof document||null===(t=document)||void 0===t||!t.createElement)return;const r=Rl(this.source).name,i="".concat(this.stage," ").concat(r);let s=function(e,t,n){let r="";const i=t.split(/\r?\n/),s=e.slice().sort(((e,t)=>e.lineNum-t.lineNum));switch((null===n||void 0===n?void 0:n.showSourceCode)||"no"){case"all":let t=0;for(let e=1;e<=i.length;e++)for(r+=Al(i[e-1],e,n);s.length>t&&s[t].lineNum===e;){const e=s[t++];r+=xl(e,i,e.lineNum,a(a({},n),{},{inlineSource:!1}))}return r;case"issues":case"no":for(const s of e)r+=xl(s,i,s.lineNum,{inlineSource:"no"!==(null===n||void 0===n?void 0:n.showSourceCode)});return r}}(e,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+='<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>'.concat(o,"</pre></code>"));const l=document.createElement("Button");l.innerHTML="\n<h1>Shader Compilation Error in ".concat(i,'</h1><br /><br />\n<code style="user-select:text;"><pre>\n').concat(s,"\n</pre></code>"),l.style.top="10px",l.style.left="10px",l.style.position="absolute",l.style.zIndex="9999",l.style.width="100%",l.style.textAlign="left",document.body.appendChild(l);const c=document.getElementsByClassName("luma-compiler-log-error");null!==(n=c[0])&&void 0!==n&&n.scrollIntoView&&c[0].scrollIntoView(),l.onclick=()=>{const e="data:text/plain,".concat(encodeURIComponent(this.source));navigator.clipboard.writeText(e)}}}function Ll(e){return Rl(e.source).name||e.id||mo("unnamed ".concat(e.stage,"-shader"))}function Ml(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}s(kl,"defaultProps",a(a({},vo.defaultProps),{},{language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"}));class Il extends kl{constructor(e,t){switch(super(e,t),s(this,"device",void 0),s(this,"handle",void 0),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){return function(e){const t=e.split(/\r?\n/),n=[];for(const r of t){if(r.length<=1)continue;const e=r.split(":");if(2===e.length){const[t,r]=e;n.push({message:r.trim(),type:Ml(t),lineNum:0,linePos:0});continue}const[t,i,s,...o]=e;let a=parseInt(s,10);isNaN(a)&&(a=0);let l=parseInt(i,10);isNaN(l)&&(l=0),n.push({message:o.join(":").trim(),type:Ml(t),lineNum:a,linePos:l})}return n}(this.device.gl.getShaderInfoLog(this.handle))}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return null===e||void 0===e?void 0:e.getTranslatedShaderSource(this.handle)}async _compile(e){e=(e=>e.startsWith("#version ")?e:"#version 100\n".concat(e))(e);const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),0!==ho.level){if(this.device.features.has("compilation-status-async-webgl"))ho.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),ho.info(2,"Shader ".concat(this.id," - async compilation complete: ").concat(this.compilationStatus))(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error("GLSL compilation errors in ".concat(this.props.stage," shader ").concat(this.props.id))}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}class Ol extends vo{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t,Ol.defaultProps)}}s(Ol,"defaultProps",a(a({},vo.defaultProps),{},{framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}));const Nl=6144,Fl=[1,2,4,8];class Dl extends Ol{constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"glParameters",void 0),this.device=e,oa(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){aa(this.device.gl)}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=a({},this.glParameters);this.props.framebuffer&&(t.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(t.colorMask=Fl.map((t=>Boolean(t&e.colorMask)))),this.glParameters=t,ea(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;null===t||void 0===t||t.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;null===e||void 0===e||e.endOcclusionQuery()}clear(){const e=a({},this.glParameters);let t=0;!1!==this.props.clearColor&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&Qa(this.device.gl,e,(()=>{this.device.gl.clear(t)}))}clearColorBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0];Qa(this.device.gl,{framebuffer:this.props.framebuffer},(()=>{switch(t.constructor){case Int32Array:this.device.gl.clearBufferiv(Nl,e,t);break;case Uint32Array:this.device.gl.clearBufferuiv(Nl,e,t);break;case Float32Array:default:this.device.gl.clearBufferfv(Nl,e,t)}}))}}class Bl extends vo{get[Symbol.toStringTag](){return"RenderPipeline"}constructor(e,t){super(e,t,Bl.defaultProps),s(this,"shaderLayout",void 0),s(this,"bufferLayout",void 0),s(this,"linkStatus","pending"),s(this,"hash",""),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}function Ul(e){return Array.isArray(e)?0===e.length||"number"===typeof e[0]?e:null:function(e){return!ArrayBuffer.isView(e)||e instanceof DataView?null:e}(e)}function zl(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((n=>{const r=e[n];var i;null!==Ul(i=r)||"number"===typeof i||"boolean"===typeof i?t.uniforms[n]=r:t.bindings[n]=r})),t}s(Bl,"defaultProps",a(a({},vo.defaultProps),{},{vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}}));const Gl={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},jl={f32:4,f16:2,i32:4,u32:4};function Vl(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,r]=e.split("x"),i=n,s=r?parseInt(r):1,o=bo(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(a.webglOnly=!0),a}function Wl(e,t){const n={};for(const r of e.attributes)n[r.name]=Hl(e,t,r.name);return n}function Hl(e,t,n){const r=function(e,t){const n=e.attributes.find((e=>e.name===t));n||ho.warn('shader layout attribute "'.concat(t,'" not present in shader'));return n||null}(e,n),i=function(e,t){Xl(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);if(n)return n;if(n=function(e,t){for(const r of e){var n;let e=r.byteStride;if("number"!==typeof r.byteStride)for(const t of r.attributes||[]){e+=Vl(t.format).byteLength}const i=null===(n=r.attributes)||void 0===n?void 0:n.find((e=>e.attribute===t));if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:e}}return null}(e,t),n)return n;return ho.warn('layout for attribute "'.concat(t,'" not present in buffer layout')),null}(t,n);if(!r)return null;const s=function(e){const[t,n]=Gl[e],r="i32"===t||"u32"===t,i="u32"!==t,s=jl[t]*n,o=function(e,t){let n;switch(e){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?n:"".concat(n,"x").concat(t)}(t,n);return{dataType:t,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}(r.type),o=(null===i||void 0===i?void 0:i.vertexFormat)||s.defaultVertexFormat,a=Vl(o);return{attributeName:(null===i||void 0===i?void 0:i.attributeName)||r.name,bufferName:(null===i||void 0===i?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(null===i||void 0===i?void 0:i.stepMode)||r.stepMode,byteOffset:(null===i||void 0===i?void 0:i.byteOffset)||0,byteStride:(null===i||void 0===i?void 0:i.byteStride)||0}}function Xl(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&ho.warn("BufferLayout ".concat(name," must have either 'attributes' or 'format' field"))}function ql(e,t){const{clamped:n=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const Kl={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Yl={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Zl{static getBytesPerElement(e){return ql(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){ko(e.size);return ql(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Zl(...[Kl,...t])}constructor(){s(this,"offset",void 0),s(this,"stride",void 0),s(this,"type",void 0),s(this,"size",void 0),s(this,"divisor",void 0),s(this,"normalized",void 0),s(this,"integer",void 0),s(this,"buffer",void 0),s(this,"index",void 0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>this._assign(e))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Zl.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Zl.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=function(e,t,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in t){const t=r[a]?"".concat(e,".").concat(r[a]):"N/A";ho.removed("".concat(e,".").concat(a),t)()}for(const a in i)if(a in t){const t=i[a];ho.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(t))()}let o=null;for(const[a,l]of Object.entries(s))a in t&&(ho.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(l))(),o=o||Object.assign({},t),o[l]=t[a],delete o[a]);return o||t}("Accessor",e,Yl),void 0!==e.type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalize&&(this.normalized=e.normalize),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"===typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),void 0===this.offset&&delete this.offset,void 0===this.stride&&delete this.stride,void 0===this.type&&delete this.type,void 0===this.size&&delete this.size,void 0===this.divisor&&delete this.divisor,void 0===this.normalized&&delete this.normalized,void 0===this.integer&&delete this.integer,void 0===this.buffer&&delete this.buffer,void 0===this.index&&delete this.index,this}}const Ql=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],$l={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function Jl(e){const t=$l[e];if(!t)throw new Error("uniform");const[n,r,,i]=t;return{format:i,components:r,glType:n}}function ec(e){const t=$l[e];if(!t)throw new Error("attribute");const[,n,,r,i]=t;return{attributeType:r,vertexFormat:i,components:n}}function tc(e,t){const n={attributes:[],bindings:[]};n.attributes=function(e,t){const n=[],r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o}=r,a=e.getAttribLocation(t,s);if(a>=0){const{attributeType:e}=ec(o),t=/instance/i.test(s)?"instance":"vertex";n.push({name:s,location:a,stepMode:t,type:e})}}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);const r=function(e,t){const n=(n,r)=>e.getActiveUniformBlockParameter(t,n,r),r=[],i=e.getProgramParameter(t,35382);for(let s=0;s<i;s++){const i={name:e.getActiveUniformBlockName(t,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},o=n(s,35395)||[],a=e.getActiveUniforms(t,o,35383),l=e.getActiveUniforms(t,o,35384),c=e.getActiveUniforms(t,o,35387),u=e.getActiveUniforms(t,o,35388);for(let n=0;n<i.uniformCount;++n){const r=e.getActiveUniform(t,o[n]);if(!r)throw new Error("activeInfo");i.uniforms.push({name:r.name,format:Jl(a[n]).format,type:a[n],arrayLength:l[n],byteOffset:c[n],byteStride:u[n]})}r.push(i)}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);for(const a of r){const e=a.uniforms.map((e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength})));n.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:e})}const i=function(e,t){const n=[],r=e.getProgramParameter(t,35718);for(let i=0;i<r;i++){const r=e.getActiveUniform(t,i);if(!r)throw new Error("activeInfo");const{name:s,size:o,type:l}=r,{name:c,isArray:u}=ic(s);let h=e.getUniformLocation(t,c);const d={location:h,name:c,size:o,type:l,isArray:u};if(n.push(d),d.size>1)for(let i=0;i<d.size;i++){const r="".concat(c,"[").concat(i,"]");h=e.getUniformLocation(t,r);const s=a(a({},d),{},{name:r,location:h});n.push(s)}}return n}(e,t);let s=0;for(const a of i)if(o=a.type,Ql.includes(o)){const{viewDimension:e,sampleType:t}=rc(a.type);n.bindings.push({type:"texture",name:a.name,location:s,viewDimension:e,sampleType:t}),a.textureUnit=s,s+=1}var o;i.length&&(n.uniforms=i);const l=function(e,t){const n=[],r=e.getProgramParameter(t,35971);for(let i=0;i<r;i++){const r=e.getTransformFeedbackVarying(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o,size:a}=r,{glType:l,components:c}=Jl(o),u={location:i,name:s,accessor:new Zl({type:l,size:a*c})};n.push(u)}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);return null!==l&&void 0!==l&&l.length&&(n.varyings=l),n}const nc={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function rc(e){const t=nc[e];if(!t)throw new Error("sampler");const[n,r]=t;return{viewDimension:n,sampleType:r}}function ic(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function sc(e,t,n,r){const i=e;let s=r;!0===s&&(s=1),!1===s&&(s=0);const o="number"===typeof s?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!==typeof r)throw new Error("samplers must be set to integers");return e.uniform1i(t,r);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return i.uniform1uiv(t,o,1);case 36294:return i.uniform2uiv(t,o,2);case 36295:return i.uniform3uiv(t,o,3);case 36296:return i.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return i.uniformMatrix2x3fv(t,!1,o);case 35686:return i.uniformMatrix2x4fv(t,!1,o);case 35687:return i.uniformMatrix3x2fv(t,!1,o);case 35688:return i.uniformMatrix3x4fv(t,!1,o);case 35689:return i.uniformMatrix4x2fv(t,!1,o);case 35690:return i.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}class oc extends Bl{constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"handle",void 0),s(this,"vs",void 0),s(this,"fs",void 0),s(this,"introspectedLayout",void 0),s(this,"uniforms",{}),s(this,"bindings",{}),s(this,"varyings",null),s(this,"_uniformCount",0),s(this,"_uniformSetters",{}),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:n,bufferMode:r=35981}=t;switch(n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,r)),this._linkShaders(),ho.time(1,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.introspectedLayout=tc(this.device.gl,this.handle),ho.timeEnd(1,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.shaderLayout=function(e,t){const n=a(a({},e),{},{attributes:e.attributes.map((e=>a({},e)))});for(const r of(null===t||void 0===t?void 0:t.attributes)||[]){const e=n.attributes.find((e=>e.name===r.name));e?(e.type=r.type||e.type,e.stepMode=r.stepMode||e.stepMode):ho.warn("shader layout attribute ".concat(r.name," not present in shader"))}return n}(this.introspectedLayout,t.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":ho.warn("Primitive topology ".concat(this.props.topology," is deprecated and will be removed in v9.1"))}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[n,r]of Object.entries(e)){const e=this.shaderLayout.bindings.find((e=>e.name===n))||this.shaderLayout.bindings.find((e=>e.name==="".concat(n,"Uniforms")));if(e){switch(r||ho.warn('Unsetting binding "'.concat(n,'" in render pipeline "').concat(this.id,'"'))(),e.type){case"uniform":if(!(r instanceof al)&&!(r.buffer instanceof al))throw new Error("buffer value");break;case"texture":if(!(r instanceof hl||r instanceof fl||r instanceof pl))throw new Error("texture value");break;case"sampler":ho.warn("Ignoring sampler ".concat(n))();break;default:throw new Error(e.type)}this.bindings[n]=r}else{const e=this.shaderLayout.bindings.map((e=>'"'.concat(e.name,'"'))).join(", ");null!==t&&void 0!==t&&t.disableWarnings||ho.warn('Unknown binding "'.concat(n,'" in render pipeline "').concat(this.id,'", expected one of ').concat(e))()}}}draw(e){var t;const{renderPass:n,parameters:r=this.props.parameters,topology:i=this.props.topology,vertexArray:s,vertexCount:o,instanceCount:a,isInstanced:l=!1,firstVertex:c=0,transformFeedback:u}=e,h=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(e)}}(i),d=Boolean(s.indexBuffer),f=null===(t=s.indexBuffer)||void 0===t?void 0:t.glIndexType;if("success"!==this.linkStatus)return ho.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - waiting for shader linking"))(),!1;if(!this._areTexturesRenderable()||0===o)return ho.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - textures not yet loaded"))(),!1;if(0===o)return ho.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - no vertices to draw"))(),!0;this.device.gl.useProgram(this.handle),s.bindBeforeRender(n),u&&u.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const p=n;return function(e,t,n,r){if(_o(t))return r(e);const i=e;oa(i.gl);try{return $a(e,t),ea(i.gl,n),r(e)}finally{aa(i.gl)}}(this.device,r,p.glParameters,(()=>{d&&l?this.device.gl.drawElementsInstanced(h,o||0,f,c,a||0):d?this.device.gl.drawElements(h,o||0,f,c):l?this.device.gl.drawArraysInstanced(h,c,o||0,a||0):this.device.gl.drawArrays(h,c,o||0),u&&u.end()})),s.unbindAfterRender(n),!0}setUniformsWebGL(e){const{bindings:t}=zl(e);Object.keys(t).forEach((e=>{ho.warn('Unsupported value "'.concat(JSON.stringify(t[e]),'" used in setUniforms() for key ').concat(e,". Use setBindings() instead?"))()})),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ho.time(4,"linkProgram for ".concat(this.id))(),e.linkProgram(this.handle),ho.timeEnd(4,"linkProgram for ".concat(this.id))(),ho.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}ho.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),ho.info(2,"RenderPipeline ".concat(this.id," - async linking complete: ").concat(this.linkStatus))();const t=this._getLinkStatus();this._reportLinkStatus(t)}_reportLinkStatus(e){var t;if("success"!==e){if("error"===this.vs.compilationStatus)throw this.vs.debugShader(),new Error("Error during compilation of shader ".concat(this.vs.id));if("error"===(null===(t=this.fs)||void 0===t?void 0:t.compilationStatus))throw this.fs.debugShader(),new Error("Error during compilation of shader ".concat(this.fs.id));throw new Error("Error during ".concat(e,": ").concat(this.device.gl.getProgramInfoLog(this.handle)))}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const[,t]of Object.entries(this.bindings))t instanceof fl&&(t.update(),e=e&&t.loaded);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,n=0;for(const r of this.shaderLayout.bindings){const i=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!i)throw new Error("No value for binding ".concat(r.name," in ").concat(this.id));switch(r.type){case"uniform":const{name:s}=r,o=e.getUniformBlockIndex(this.handle,s);if(4294967295===o)throw new Error("Invalid uniform block name ".concat(s));e.uniformBlockBinding(this.handle,n,o),i instanceof al?e.bindBufferBase(35345,n,i.handle):e.bindBufferRange(35345,n,i.buffer.handle,i.offset||0,i.size||i.buffer.byteLength-i.offset),n+=1;break;case"texture":if(!(i instanceof hl||i instanceof fl||i instanceof pl))throw new Error("texture");let a;if(i instanceof hl)a=i.texture;else if(i instanceof fl)a=i;else{if(!(i instanceof pl&&i.colorAttachments[0]instanceof hl))throw new Error("No texture");ho.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),a=i.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(a.target,a.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error("binding type '".concat(r.type,"' not supported in WebGL"))}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){var e;const{name:n,location:r,type:i,textureUnit:s}=t,o=null!==(e=this.uniforms[n])&&void 0!==e?e:s;void 0!==o&&sc(this.device.gl,r,i,o)}}}class ac extends vo{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,ac.defaultProps)}}s(ac,"defaultProps",a(a({},vo.defaultProps),{},{measureExecutionTime:void 0}));class lc extends vo{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,lc.defaultProps)}}s(lc,"defaultProps",a({},vo.defaultProps));class cc extends lc{constructor(e){super(e,{}),s(this,"device",void 0),s(this,"commands",[]),this.device=e}submitCommands(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.commands;for(const t of e)switch(t.name){case"copy-buffer-to-buffer":uc(this.device,t.options);break;case"copy-buffer-to-texture":hc(this.device,t.options);break;case"copy-texture-to-buffer":dc(this.device,t.options);break;case"copy-texture-to-texture":fc(this.device,t.options)}}}function uc(e,t){var n,r;const i=t.source,s=t.destination;e.gl.bindBuffer(36662,i.handle),e.gl.bindBuffer(36663,s.handle),e.gl.copyBufferSubData(36662,36663,null!==(n=t.sourceOffset)&&void 0!==n?n:0,null!==(r=t.destinationOffset)&&void 0!==r?r:0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function hc(e,t){throw new Error("Not implemented")}function dc(e,t){const{source:n,mipLevel:r=0,aspect:i="all",width:s=t.source.width,height:o=t.source.height,depthOrArrayLayers:a=0,origin:l=[0,0],destination:c,byteOffset:u=0,bytesPerRow:h,rowsPerImage:d}=t;if("all"!==i)throw new Error("not supported");if(0!==r||0!==a||h||d)throw new Error("not implemented");const{framebuffer:f,destroyFramebuffer:p}=pc(n);let g;try{const t=c,n=s||f.width,r=o||f.height,i=za(f.texture.props.format),a=i.dataFormat,h=i.type;e.gl.bindBuffer(35051,t.handle),g=e.gl.bindFramebuffer(36160,f.handle),e.gl.readPixels(l[0],l[1],n,r,a,h,u)}finally{e.gl.bindBuffer(35051,null),void 0!==g&&e.gl.bindFramebuffer(36160,g),p&&f.destroy()}}function fc(e,t){const{source:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destination:o}=t;let{width:a=t.destination.width,height:l=t.destination.height}=t;const{framebuffer:c,destroyFramebuffer:u}=pc(n),[h,d]=i,[f,p,g]=s,m=e.gl.bindFramebuffer(36160,c.handle);let _,v=null;if(!(o instanceof fl))throw new Error("invalid destination");switch(v=o,a=Number.isFinite(a)?a:v.width,l=Number.isFinite(l)?l:v.height,v.bind(0),_=v.target,_){case 3553:case 34067:e.gl.copyTexSubImage2D(_,r,f,p,h,d,a,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(_,r,f,p,g,h,d,a,l)}v&&v.unbind(),e.gl.bindFramebuffer(36160,m),u&&c.destroy()}function pc(e){if(e instanceof Xa){const{width:t,height:n,id:r}=e;return{framebuffer:e.device.createFramebuffer({id:"framebuffer-for-".concat(r),width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class gc extends ac{constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"commandBuffer",void 0),this.device=e,this.commandBuffer=new cc(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,n){}}class mc extends vo{get[Symbol.toStringTag](){return"VertexArray"}constructor(e,t){super(e,t,mc.defaultProps),s(this,"maxVertexAttributes",void 0),s(this,"attributeInfos",void 0),s(this,"indexBuffer",null),s(this,"attributes",void 0),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;const r=Wl(e,t),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}(t.renderPipeline.shaderLayout,t.renderPipeline.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,t){throw new Error("constant attributes not supported")}}let _c;function vc(e){return(!_c||_c.byteLength<e)&&(_c=new ArrayBuffer(e)),_c}s(mc,"defaultProps",a(a({},vo.defaultProps),{},{renderPipeline:null}));class yc extends mc{get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(e){return"Chrome"===(t||q()?X(t)?"Electron":(t||te.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node");var t}constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"handle",void 0),s(this,"buffer",null),s(this,"bufferValue",null),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){var e;(super.destroy(),this.buffer)&&(null===(e=this.buffer)||void 0===e||e.destroy());this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const n=t;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:r,type:i,stride:s,offset:o,normalized:a,integer:l,divisor:c}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),l?this.device.gl.vertexAttribIPointer(e,r,i,s,o):this.device.gl.vertexAttribPointer(e,r,i,a,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,c||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error("Unknown attribute location ".concat(e));const n=pa(t.bufferDataType);return{size:t.bufferComponents,type:n,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=yc.isConstantAttributeZeroSupported(this.device);(t||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const n=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),r=n.byteLength*e,i=n.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error("Buffer size is immutable, byte length ".concat(r," !== ").concat(this.buffer.byteLength,"."));let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),s=s||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(n,this.bufferValue),s){const e=function(e,t){return new e(vc(e.BYTES_PER_ELEMENT*t),0,t)}(t.constructor,i);!function(e){const{target:t,source:n,start:r=0,count:i=1}=e,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);e.target}({target:e,source:n,start:0,count:i}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class bc extends vo{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,bc.defaultProps)}}s(bc,"defaultProps",a(a({},vo.defaultProps),{},{layout:void 0,buffers:{}}));class Ec extends bc{constructor(e,t){super(e,t),s(this,"device",void 0),s(this,"gl",void 0),s(this,"handle",void 0),s(this,"layout",void 0),s(this,"buffers",{}),s(this,"unusedBuffers",{}),s(this,"bindOnUse",!0),s(this,"_bound",!1),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"point-list";this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":case"line-loop-webgl":return 1;case"triangle-list":case"triangle-strip":case"triangle-fan-webgl":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])}))}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(t);if(n<0)return this.unusedBuffers[e]=r,void ho.warn("".concat(this.id," unusedBuffers varying buffer ").concat(e))();this.buffers[n]={buffer:r,byteLength:i,byteOffset:s},this.bindOnUse||this._bindBuffer(n,r,s,i)}getBuffer(e){if(wc(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this.gl.bindTransformFeedback(36386,t),this):(this._bound?e=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,e=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),e)}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof al)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:n=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:n,byteLength:r}}_getVaryingIndex(e){if(wc(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:n,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const i=t&&t.handle;i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i)}}function wc(e){return"number"===typeof e?Number.isInteger(e):/^\d+$/.test(e)}class Sc extends vo{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,Sc.defaultProps)}}s(Sc,"defaultProps",a(a({},vo.defaultProps),{},{type:void 0,count:void 0}));class Tc extends Sc{get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),s(this,"device",void 0),s(this,"handle",void 0),s(this,"target",null),s(this,"_queryPending",!1),s(this,"_pollingPromise",null),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(null!==e&&void 0!==e&&e.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}}function xc(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ko(!1),0}}function Ac(e,t){var n;const{sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,sourceAttachment:o=36064}=t||{};let{target:a=null,sourceWidth:l,sourceHeight:c,sourceType:u}=t||{};const{framebuffer:h,deleteFramebuffer:d}=Pc(e);ko(h);const{gl:f,handle:p}=h;l=l||h.width,c=c||h.height;const g=o-36064;u=u||(null===(n=h.colorAttachments[g])||void 0===n||null===(n=n.texture)||void 0===n?void 0:n.type)||5121,a=function(e,t,n,r,i){if(e)return e;const s=ql(t=t||5121,{clamped:!1}),o=xc(n);return new s(r*i*o)}(a,u,s,l,c),u=u||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}(a);const m=f.bindFramebuffer(36160,p);return f.readPixels(r,i,l,c,s,u,a),f.bindFramebuffer(36160,m||null),d&&h.destroy(),a}function Rc(e,t){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=t||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=t||{};const{framebuffer:u,deleteFramebuffer:h}=Pc(e);ko(u),a=a||u.width,l=l||u.height;const d=u;c=c||5121;let f=n;if(!f){const e=o+a*l*xc(s)*function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return ko(!1),0}}(c);f=d.device.createBuffer({byteLength:e})}const p=e.device.createCommandEncoder();return p.copyTextureToBuffer({source:e,width:a,height:l,origin:[r,i],destination:f,byteOffset:o}),p.destroy(),h&&u.destroy(),f}function Pc(e){return e instanceof qa?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:Cc(e),deleteFramebuffer:!0}}function Cc(e,t){const{device:n,width:r,height:i,id:s}=e;return n.createFramebuffer(a(a({},t),{},{id:"framebuffer-for-".concat(s),width:r,height:i,colorAttachments:[e]}))}const kc="clear: bad arguments";class Lc extends Co{static isSupported(){return"undefined"!==typeof WebGL2RenderingContext}static attach(e){if(e instanceof Lc)return e;if((null===e||void 0===e?void 0:e.device)instanceof Co)return e.device;if(!function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new Lc({gl:e})}static async create(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ho.groupCollapsed(1,"WebGLDevice created")();const n=[];t.debug&&n.push(async function(){q()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Za("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),t.spector&&n.push(async function(){if(!globalThis.SPECTOR)try{await Za("https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js")}catch(e){ho.warn(String(e))}}()),"string"===typeof t.canvas&&n.push(Do.pageLoaded);const r=await Promise.allSettled(n);for(const o of r)"rejected"===o.status&&ho.error("Failed to initialize debug libraries ".concat(o.reason))();if(ho.probe(2,"DOM is loaded")(),null!==(e=t.gl)&&void 0!==e&&e.device)return ho.warn("reattaching existing device")(),Lc.attach(t.gl);const i=new Lc(t),s="Created ".concat(i.type).concat(i.debug?" debug":""," context: ").concat(i.info.vendor,", ").concat(i.info.renderer," for canvas: ").concat(i.canvasContext.id);return ho.probe(1,s)(),ho.table(1,i.info)(),ho.groupEnd(1)(),i}constructor(e){var t,n;super(a(a({},e),{},{id:e.id||mo("webgl-device")})),s(this,"type","webgl"),s(this,"handle",void 0),s(this,"features",void 0),s(this,"limits",void 0),s(this,"info",void 0),s(this,"canvasContext",void 0),s(this,"lost",void 0),s(this,"_resolveContextLost",void 0),s(this,"renderPass",null),s(this,"gl",void 0),s(this,"debug",!1),s(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1}),s(this,"_extensions",{}),s(this,"_polyfilled",!1),s(this,"spectorJS",void 0),s(this,"_constants",void 0);const r=null===(t=e.gl)||void 0===t?void 0:t.device;if(r)throw new Error("WebGL context already attached to device ".concat(r.id));const i=(null===(n=e.gl)||void 0===n?void 0:n.canvas)||e.canvas,o=!e.gl;this.canvasContext=new gl(this,a(a({},e),{},{autoResize:o,canvas:i})),this.lost=new Promise((e=>{this._resolveContextLost=e}));let l=e.gl||null;if(l||(l=function(e,t){t=a(a({},ua),t);let n=null;const r=e=>n=e.statusMessage||n;e.addEventListener("webglcontextcreationerror",r,!1);let i=null;if(i||(i=e.getContext("webgl2",t)),e.removeEventListener("webglcontextcreationerror",r,!1),!i)throw new Error("Failed to create WebGL context: ".concat(n||"Unknown error"));if(t.onContextLost){const{onContextLost:n}=t;e.addEventListener("webglcontextlost",(e=>n(e)),!1)}if(t.onContextRestored){const{onContextRestored:n}=t;e.addEventListener("webglcontextrestored",(e=>n(e)),!1)}return i}(this.canvasContext.canvas,a(a({},e),{},{onContextLost:e=>{var t;return null===(t=this._resolveContextLost)||void 0===t?void 0:t.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}}))),!l)throw new Error("WebGL context creation failed");this.handle=l,this.gl=l,this.gl.device=this,this.gl._version=2,e.spector&&(this.spectorJS=function(e){var t,n,r,i;if(null===(t=e=a(a({},ml),e))||void 0===t||!t.spector)return null;if(!_l&&globalThis.SPECTOR&&(ho.probe(1,"SPECTOR found and initialized")(),_l=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=_l)),!_l)return null;if(vl||(vl=!0,_l.spyCanvases(),null===(r=_l)||void 0===r||r.onCaptureStarted.add((e=>ho.info("Spector capture started:",e)())),null===(i=_l)||void 0===i||i.onCapture.add((e=>{var t,n,r;ho.info("Spector capture complete:",e)(),null===(t=_l)||void 0===t||t.getResultUI(),null===(n=_l)||void 0===n||n.resultView.display(),null===(r=_l)||void 0===r||r.resultView.addCapture(e)}))),null!==(n=e)&&void 0!==n&&n.canvas){var s,o;if("string"===typeof e.spector&&e.spector!==e.canvas.id)return _l;null===(s=_l)||void 0===s||s.startCapture(null===(o=e)||void 0===o?void 0:o.canvas,500),new Promise((e=>setTimeout(e,2e3))).then((e=>{var t;ho.info("Spector capture stopped after 2 seconds")(),null===(t=_l)||void 0===t||t.stopCapture()}))}return _l}(a(a({},this.props),{},{canvas:this.handle.canvas}))),this.info=da(this.gl,this._extensions),this.limits=new Ha(this.gl),this.features=new Wa(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),o&&this.canvasContext.resize();const{enable:c=!0,copyState:u=!1}=e;sa(this.gl,{enable:c,copyState:u,log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ho.log(1,...t)()}}),e.debug&&(this.gl=El(this.gl,a(a({},e),{},{throwOnError:!0})),this.debug=!0,ho.level=Math.max(ho.level,1),ho.warn("WebGL debug mode activated. Performance reduced.")())}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(e){return Ba(this.gl,e,this._extensions)}isTextureFormatFilterable(e){return function(e,t,n){if(!Ba(e,t,n))return!1;if(t.startsWith("depth")||t.startsWith("stencil"))return!1;try{if(xo(t).signed)return!1}catch(r){return!1}return t.endsWith("32float")?Boolean(ha(e,"OES_texture_float_linear, extensions",n)):!t.endsWith("16float")||Boolean(ha(e,"OES_texture_half_float_linear, extensions",n))}(this.gl,e,this._extensions)}isTextureFormatRenderable(e){return function(e,t,n){return!!Ba(e,t,n)&&"number"!==typeof t}(this.gl,e,this._extensions)}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._getBufferProps(e);return new al(this,t)}_createTexture(e){return new fl(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new cl(this,e)}createShader(e){return new Il(this,e)}createFramebuffer(e){return new pl(this,e)}createVertexArray(e){return new yc(this,e)}createTransformFeedback(e){return new Ec(this,e)}createQuerySet(e){return new Tc(this,e)}createRenderPipeline(e){return new oc(this,e)}beginRenderPass(e){return new Dl(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(e){return new gc(this,e)}submit(){var e;null===(e=this.renderPass)||void 0===e||e.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return Ac(e,t)}readPixelsToBufferWebGL(e,t){return Rc(e,t)}setParametersWebGL(e){ea(this.gl,e)}getParametersWebGL(e){return ta(this.gl,e)}withParametersWebGL(e,t){return Qa(this.gl,e,t)}clearWebGL(e){!function(e,t){const{framebuffer:n=null,color:r=null,depth:i=null,stencil:s=null}=t||{},o={};n&&(o.framebuffer=n);let a=0;r&&(a|=16384,!0!==r&&(o.clearColor=r)),i&&(a|=256,!0!==i&&(o.clearDepth=i)),s&&(a|=1024,!0!==i&&(o.clearStencil=i)),ko(0!==a,kc);const l=e.gl;Qa(l,o,(()=>{l.clear(a)}))}(this,e)}resetWebGL(){ho.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),ea(this.gl,zo)}loseDevice(){var e;let t=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(t=!0,n.loseContext()),null===(e=this._resolveContextLost)||void 0===e||e.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){oa(this.gl)}popState(){aa(this.gl)}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){t=t||this.gl2||this.gl;const n=Number(e);for(const r in t)if(t[r]===n)return"GL.".concat(r);return String(e)}setConstantAttributeWebGL(e,t){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const r=this._constants[e];switch(r&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(r,t)&&ho.info(1,"setConstantAttributeWebGL(".concat(e,") could have been skipped, value unchanged"))(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n);break;default:ko(!1)}}(this,e,t);break;case Int32Array:!function(e,t,n){e.gl.vertexAttribI4iv(t,n)}(this,e,t);break;case Uint32Array:!function(e,t,n){e.gl.vertexAttribI4uiv(t,n)}(this,e,t);break;default:ko(!1)}}getExtension(e){return ha(this.gl,e,this._extensions),this._extensions}}s(Lc,"type","webgl");let Mc=0;const Ic={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Mo.stats.get("animation-loop-".concat(Mc++)),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class Oc{constructor(e){if(s(this,"device",null),s(this,"canvas",null),s(this,"props",void 0),s(this,"animationProps",null),s(this,"timeline",null),s(this,"stats",void 0),s(this,"cpuTime",void 0),s(this,"gpuTime",void 0),s(this,"frameRate",void 0),s(this,"display",void 0),s(this,"needsRedraw","initialized"),s(this,"_initialized",!1),s(this,"_running",!1),s(this,"_animationFrameId",null),s(this,"_nextFramePromise",null),s(this,"_resolveNextFrame",null),s(this,"_cpuStartTime",0),this.props=a(a({},Ic),e),!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new dt({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return null!==(e=this.device)&&void 0!==e&&e.isLost||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e?void 0:e.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=(null===(e=this.device.canvasContext)||void 0===e?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){var e,t;if(!this.device)return{width:1,height:1,aspect:1};const[n,r]=(null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e?void 0:e.getPixelSize())||[1,1];let i=1;const s=null===(t=this.device)||void 0===t||null===(t=t.canvasContext)||void 0===t?void 0:t.canvas;return s&&s.clientHeight?i=s.clientWidth/s.clientHeight:n>0&&r>0&&(i=n/r),{width:n,height:r,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e;this.props.autoResizeDrawingBuffer&&(null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e||e.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}var Nc=n(895);const Fc={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}(n,(t=>t.pointerId===e.pointerId))||n.push(e)),t.call(this,e)}}(Nc.PointerEventInput),Nc.MouseInput.prototype.handler=function(e){let t=Fc[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.buttons&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const Dc=Nc.Manager,Bc=Nc;class Uc{constructor(e,t,n){this.element=e,this.callback=t,this.options=a({enable:!0},n)}}const zc=Bc?[[Bc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Bc.Rotate,{enable:!1}],[Bc.Pinch,{enable:!1}],[Bc.Swipe,{enable:!1}],[Bc.Pan,{threshold:0,enable:!1}],[Bc.Press,{enable:!1}],[Bc.Tap,{event:"doubletap",taps:2,enable:!1}],[Bc.Tap,{event:"anytap",enable:!1}],[Bc.Tap,{enable:!1}]]:null,Gc={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},jc={doubletap:["tap"]},Vc={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Wc={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Hc={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Xc={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},qc="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Kc="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let Yc=!1;try{const e={get passive(){return Yc=!0,!0}};Kc.addEventListener("test",null,e),Kc.removeEventListener("test",null)}catch(Zm){Yc=!1}const Zc=-1!==qc.indexOf("firefox"),{WHEEL_EVENTS:Qc}=Wc,$c="wheel",Jc=4.000244140625;class eu extends Uc{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;Kc.WheelEvent&&(Zc&&e.deltaMode===Kc.WheelEvent.DOM_DELTA_PIXEL&&(t/=Kc.devicePixelRatio),e.deltaMode===Kc.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%Jc===0&&(t=Math.floor(t/Jc)),e.shiftKey&&t&&(t*=.25),this.callback({type:$c,center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},this.events=(this.options.events||[]).concat(Qc),this.events.forEach((t=>e.addEventListener(t,this.handleEvent,!!Yc&&{passive:!1})))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===$c&&(this.options.enable=t)}}const{MOUSE_EVENTS:tu}=Wc,nu="pointermove",ru="pointerover",iu="pointerout",su="pointerenter",ou="pointerleave";class au extends Uc{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(tu),this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===nu&&(this.enableMoveEvent=t),e===ru&&(this.enableOverEvent=t),e===iu&&(this.enableOutEvent=t),e===su&&(this.enableEnterEvent=t),e===ou&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(ru,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(iu,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(su,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(ou,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(nu,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:lu}=Wc,cu="keydown",uu="keyup";class hu extends Uc{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:cu,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:uu,srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(lu),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===cu&&(this.enableDownEvent=t),e===uu&&(this.enableUpEvent=t)}}const du="contextmenu";class fu extends Uc{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:du,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===du&&(this.options.enable=t)}}const pu={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const gu={srcElement:"root",priority:0};class mu{constructor(e){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:s,handlersByElement:o}=this;let l=gu;"string"===typeof n||n&&n.addEventListener?l=a(a({},gu),{},{srcElement:n}):n&&(l=a(a({},gu),n));let c=o.get(l.srcElement);c||(c=[],o.set(l.srcElement,c));const u={type:e,handler:t,srcElement:l.srcElement,priority:l.priority};r&&(u.once=!0),i&&(u.passive=!0),s.push(u),this._active=this._active||!u.passive;let h=c.length-1;for(;h>=0&&!(c[h].priority>=u.priority);)h--;c.splice(h+1,0,u)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.type===e&&s.handler===t){n.splice(i,1);const e=r.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&r.delete(s.srcElement)}}this._active=n.some((e=>!e.passive))}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},s=[];for(let o=0;o<n.length;o++){const{type:l,handler:c,once:u}=n[o];if(c(a(a({},e),{},{type:l,stopPropagation:r,stopImmediatePropagation:i})),u&&s.push(n[o]),t)break}for(let e=0;e<s.length;e++){const{type:t,handler:n}=s[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return a(a(a(a({},e),function(e){const t=pu[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r}=e.srcEvent;let i=!1,s=!1,o=!1;return 2===t?(i=Boolean(1&n),s=Boolean(4&n),o=Boolean(2&n)):(i=0===r,s=1===r,o=2===r),{leftButton:i,middleButton:s,rightButton:o}}(e)),function(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),i=r.width/t.offsetWidth||1,s=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/i,y:(n.y-r.top-t.clientTop)/s}}}(e,t)),{},{preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t})}}const _u={events:null,recognizers:null,recognizerOptions:{},Manager:Dc,touchAction:"none",tabIndex:0};class vu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;this._onBasicInput=e=>{const{srcEvent:t}=e,n=Vc[t.type];n&&this.manager.emit(n,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options=a(a({},_u),t),this.events=new Map,this.setElement(e);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||zc}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Gc).forEach((e=>{const t=this.manager.get(e);t&&Gc[e].forEach((e=>{t.recognizeWith(e)}))}));for(const r in t.recognizerOptions){const e=this.manager.get(r);if(e){const n=t.recognizerOptions[r];delete n.enable,e.set(n)}}this.wheelInput=new eu(e,this._onOtherEvent,{enable:!1}),this.moveInput=new au(e,this._onOtherEvent,{enable:!1}),this.keyInput=new hu(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new fu(e,this._onOtherEvent,{enable:!1});for(const[r,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(r,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const i=jc[e];i&&!this.options.recognizers&&i.forEach((i=>{const s=n.get(i);t?(s.requireFailure(e),r.dropRequireFailure(i)):s.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!==typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,r,i);return}const{manager:s,events:o}=this,a=Xc[e]||e;let l=o.get(a);l||(l=new mu(this),o.set(a,l),l.recognizerName=Hc[a]||a,s&&s.on(a,l.handleEvent)),l.add(e,t,n,r,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,r=Xc[e]||e,i=n.get(r);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:e}=i;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}}function yu(){}const bu={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:yu,onWebGLInitialized:yu,onResize:yu,onViewStateChange:yu,onInteractionStateChange:yu,onBeforeRender:yu,onAfterRender:yu,onLoad:yu,onError:e=>de.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class Eu{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new dt({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=me[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:s}=i,o=s&&(s[t.handler]||s.props[t.handler]),a=this.props[t.handler];let l=!1;o&&(l=o.call(s,i,e)),l||(null===a||void 0===a||a(i,e),this.widgetManager.onEvent(i,e))},this._onPointerDown=e=>{const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props=a(a({},bu),e),(e=this.props).viewState&&e.initialViewState&&de.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device?this.device=e.device:e.gl&&(e.gl instanceof WebGLRenderingContext&&de.error("WebGL1 context not supported.")(),this.device=Lc.attach(e.gl));let t=this.device;t||(Mo.registerDevices([Lc]),t=Mo.createDevice(a(a({},e.deviceProps),{},{canvas:this._createCanvas(e)}))),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&er.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,n,r,i,s,o,a,l,c;(null===(e=this.animationLoop)||void 0===e||e.stop(),null===(t=this.animationLoop)||void 0===t||t.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(n=this.layerManager)||void 0===n||n.finalize(),this.layerManager=null,null===(r=this.viewManager)||void 0===r||r.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(s=this.deckRenderer)||void 0===s||s.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(a=this.eventManager)||void 0===a||a.destroy(),this.eventManager=null,null===(l=this.widgetManager)||void 0===l||l.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas)||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(e){var t;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&de.removed("onLayerHover","onHover")(),"onLayerClick"in e&&de.removed("onLayerClick","onClick")(),e.initialViewState&&!vi(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),null===(t=this.animationLoop)||void 0===t||t.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return t=t||n||r||i||s,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Ii(this.viewManager),this.viewManager.views}getViewports(e){return Ii(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var t;null===(t=this.layerManager)||void 0===t||t.removeDefaultShaderModule(e)}_pick(e,t,n){Ii(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const i=this.deckPicker[e](a({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects()},n));return r.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),Ii(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(n||0===n){var r;const t=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){var e,t;const{canvas:n}=this;if(!n)return;const r=null!==(e=n.clientWidth)&&void 0!==e?e:n.width,i=null!==(t=n.clientHeight)&&void 0!==t?t:n.height;var s,o;r===this.width&&i===this.height||(this.width=r,this.height=i,null===(s=this.viewManager)||void 0===s||s.setProps({width:r,height:i}),null===(o=this.layerManager)||void 0===o||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(e,t){const{gl:n,onError:r,useDevicePixels:i}=t;return new Oc({device:e,useDevicePixels:i,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:r})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new $i({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:s}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let o=s,a=!1;for(const n of i){var t;o=n,a=(null===(t=n.layer)||void 0===t?void 0:t.onHover(n,e.event))||a}var n,r;if(!a)null===(n=(r=this.props).onHover)||void 0===n||n.call(r,o,e.event),this.widgetManager.onHover(o,e.event);e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var t,n;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=null===(n=this.device.canvasContext)||void 0===n?void 0:n.canvas);this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Lc&&this.props.onWebGLInitialized(this.device.gl);const r=new u;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new vu(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const s in me)this.eventManager.on(s,this._onEvent);this.viewManager=new yi({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new _i(this.device,{deck:this,stats:this.stats,viewport:i,timeline:r}),this.effectManager=new ws({deck:this,device:this.device}),this.deckRenderer=new Rs(this.device),this.deckPicker=new Is(this.device),this.widgetManager=new Ds({deck:this,parentElement:null===(t=this.canvas)||void 0===t?void 0:t.parentElement}),this.widgetManager.addDefault(new Us),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){var n;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s=a({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects()},t);null===(n=this.deckRenderer)||void 0===n||n.renderLayers(s),"screen"===s.pass&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),de.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=a(a({},this.viewState),{},{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=Mo.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}Eu.defaultProps=bu,Eu.VERSION=uo;const wu=Eu,Su="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Tu(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}function xu(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function Au(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function Ru(e,t,n){if(!t||t>4)throw new Error("size ".concat(t));const r=t;let i=xu(e);if("uint8"===i&&n&&1===r)return"unorm8-webgl";if("uint8"===i&&n&&3===r)return"unorm8x3-webgl";if("uint8"===i||"sint8"===i){if(1===r||3===r)throw new Error("size: ".concat(t));return n&&(i=i.replace("int","norm")),"".concat(i,"x").concat(r)}if("uint16"===i||"sint16"===i){if(1===r||3===r)throw new Error("size: ".concat(t));return n&&(i=i.replace("int","norm")),"".concat(i,"x").concat(r)}return 1===r?i:"".concat(i,"x").concat(r)}const Pu=xu;function Cu(e,t){return{attribute:e,format:t.size>1?"".concat(t.type,"x").concat(t.size):t.type,byteOffset:t.offset||0}}function ku(e){return e.stride||e.size*e.bytesPerElement}function Lu(e,t){t.offset&&de.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ku(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return a(a({},t),{},{offset:r,stride:n})}class Mu{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,i="float64"===r;let s,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),s=i?"float32":!r&&t.isIndexed?"uint32":r||"float32";let l=function(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Au(e)}}(r||s);this.doublePrecision=i,i&&!1===t.fp64&&(l=Float32Array),this.value=null,this.settings=a(a({},t),{},{defaultType:l,defaultValue:o,logicalType:r,type:s,normalized:s.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT}),this.state=a(a({},n),{},{externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1})}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*ku(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),er.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n={};if(this.state.constant){const r=this.value;if(t){const i=Lu(this.getAccessor(),t),s=i.offset/r.BYTES_PER_ELEMENT,o=i.size||this.size;n[e]=r.subarray(s,s+o)}else n[e]=r}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n["".concat(e,"64Low")]=n[e]:n["".concat(e,"64Low")]=new Float32Array(this.size)),n}_getBufferLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getAccessor(),r=[],i={name:this.id,byteStride:ku(n),attributes:r};if(this.doublePrecision){const i=function(e,t){const n=Lu(e,t);return{high:n,low:a(a({},n),{},{offset:n.offset+4*e.size})}}(n,t||{});r.push(Cu(e,a(a({},n),i.high)),Cu("".concat(e,"64Low"),a(a({},n),i.low)))}else if(t){const i=Lu(n,t);r.push(Cu(e,a(a({},n),i)))}else r.push(Cu(e,n));return i}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,i=n*r;if(t&&i&&t.length>=i){const n=new Array(r).fill(1/0),s=new Array(r).fill(-1/0);for(let e=0;e<i;)for(let i=0;i<r;i++){const r=t[e++];r<n[i]&&(n[i]=r),r>s[i]&&(s[i]=r)}e=[n,s]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof yo?{buffer:e}:e;const r=a(a({},this.settings),n);if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)r.type="float32";else{const e=Pu(n.value);r.type=r.normalized?e.replace("int","norm"):e}}r.bytesPerElement=n.value.BYTES_PER_ELEMENT,r.stride=ku(r)}if(t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:i}=this;const s=ku(r),o=(r.vertexOffset||0)*s;if(this.doublePrecision&&e instanceof Float64Array&&(e=Sr(e,r)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const a=e.byteLength+o+2*s;(!i||i.byteLength<a)&&(i=this._createBuffer(a)),i.write(e,o)}return this.setAccessor(r),!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?Sr(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,r=n.allocatedValue,i=er.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=i;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<i.byteLength+s)&&(o=this._createBuffer(i.byteLength+s),t&&r&&o.write(r instanceof Float64Array?Sr(r,this):r,s)),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||de.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map((e=>(e+128)/255*2-1));case"snorm16":return new Float32Array(e).map((e=>(e+32768)/65535*2-1));case"unorm8":return new Float32Array(e).map((e=>e/255));case"unorm16":return new Float32Array(e).map((e=>e/65535));default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=i;for(;--e>=0;)t[n+e]=r[e];return t}switch(i){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let s=i;for(;--s>=0;)t[n+s]=Number.isFinite(e[s])?e[s]:r[s]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){var t;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer(a(a({},null===(t=this._buffer)||void 0===t?void 0:t.props),{},{id:this.id,usage:n?yo.INDEX:yo.VERTEX,indexType:n?r:void 0,byteLength:e})),this._buffer}}const Iu=[],Ou=[];function Nu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=Iu;const i={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?r=e:e.length>0&&(Ou.length=e.length,r=Ou):r=Iu,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function Fu(e){return e&&e[Symbol.asyncIterator]}function Du(e,t){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=t,a=e.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((e.length-c)/l);return(t,r)=>{let{index:i,target:a}=r;if(!s){const t=i*l+c;for(let r=0;r<n;r++)a[r]=e[t+r];return a}const h=s[i],d=s[i+1]||u;let f;if(o){f=new Array(d-h);for(let t=h;t<d;t++){const r=t*l+c;a=new Array(n);for(let t=0;t<n;t++)a[t]=e[r+t];f[t-h]=a}}else if(l===n)f=e.subarray(h*n+c,d*n+c);else{f=new e.constructor((d-h)*n);let t=0;for(let r=h;r<d;r++){const i=r*l+c;for(let r=0;r<n;r++)f[t++]=e[i+r]}}return f}}const Bu=[],Uu=[[0,1/0]];const zu={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function Gu(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return a(a(a(a({},zu[n]),t),e),{},{type:n})}class ju extends Mu{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Uu}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t,n,r;(t=this.state).layoutChanged||(t.layoutChanged=(n=e,r=this.getAccessor(),!(n.type===r.type&&n.size===r.size&&ku(n)===ku(r)&&(n.offset||0)===(r.offset||0)))),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition;return Gu(Array.isArray(t)?e[t.find((t=>e[t]))]:e[t],n)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===Uu)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let s=0;s<r;s++){const r=e[s];r[1]<t[0]?(n.push(r),i=s+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=Uu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Bu}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==Uu),!0))}updateBuffer(e){let{numInstances:t,data:n,props:r,context:i}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[e,a]of s)o.call(i,this,{data:n,startRow:e,endRow:a,props:r,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of s){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){if(void 0===e||"function"===typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const i=e;Ii(ArrayBuffer.isView(i.value),"invalid ".concat(r.accessor));const s=Boolean(i.size)&&i.size!==this.size;return n.binaryAccessor=Du(i.value,{size:i.size||this.size,stride:i.stride,offset:i.offset,startIndices:t,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:r}=this.settings;if(n.stepMode="dynamic"===r?e?e.isInstanced?"instance":"vertex":"instance":null!==r&&void 0!==r?r:"vertex",!t)return n;for(const i in t){const e=super._getBufferLayout(i,t[i]);n.attributes.push(...e.attributes)}return n}_autoUpdater(e,t){let{data:n,startRow:r,endRow:i,props:s,numInstances:o}=t;if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:d,transform:f}=a,p=l.binaryAccessor||("function"===typeof d?d:s[d]);Ii("function"===typeof p,'accessor "'.concat(d,'" is not a function'));let g=e.getVertexOffset(r);const{iterable:m,objectInfo:_}=Nu(n,r,i);for(const v of m){_.index++;let t=p(v,_);if(f&&(t=f.call(this,t)),h){const n=(_.index<h.length-1?h[_.index+1]:o)-h[_.index];if(t&&Array.isArray(t[0])){let n=g;for(const r of t)e._normalizeValue(r,c,n),n+=u}else t&&t.length>u?c.set(t,g):(e._normalizeValue(t,_.target,0),ct({target:c,source:_.target,start:g,count:n}));g+=n*u}else e._normalizeValue(t,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Vu="#version 300 es\n".concat("out vec4 transform_output;\nvoid main() {\ntransform_output = vec4(0);\n}");function Wu(e){const{input:t,inputChannels:n,output:r}=e||{};if(!t)return Vu;if(!n)throw new Error("inputChannels");const i=function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error("invalid channels: ".concat(e))}}(n),s=function(e,t){switch(t){case 1:return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case 2:return"vec4(".concat(e,", 0.0, 1.0)");case 3:return"vec4(".concat(e,", 1.0)");case 4:return e;default:throw new Error("invalid channels: ".concat(t))}}(t,n);return"#version 300 es\nin ".concat(i," ").concat(t,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(s,";\n}")}class Hu{constructor(e){if(s(this,"name",void 0),s(this,"uniforms",{}),s(this,"modifiedUniforms",{}),s(this,"modified",!0),s(this,"bindingLayout",{}),s(this,"needsRedraw","initialized"),this.name=null===e||void 0===e?void 0:e.name,null!==e&&void 0!==e&&e.name&&null!==e&&void 0!==e&&e.shaderLayout){var t;const n=null===e||void 0===e||null===(t=e.shaderLayout.bindings)||void 0===t?void 0:t.find((t=>"uniform"===t.type&&t.name===(null===e||void 0===e?void 0:e.name)));if(!n)throw new Error(null===e||void 0===e?void 0:e.name);const r=n;for(const e of r.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw("".concat(this.name,".").concat(t,"=").concat(n))}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){(function(e,t){if(e!==t)return!1;const n=Ul(e);if(!n)return!1;const r=Ul(t);if(r&&n.length===r.length)for(let i=0;i<n.length;++i)if(r[i]!==n[i])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=function(e){const t=Ul(e);return t?t.slice():e}(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}const Xu={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function qu(e){const t=Xu[e];return ko(e),t}function Ku(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}class Yu{constructor(e){s(this,"layout",{}),s(this,"byteLength",void 0);let t=0;for(const[r,i]of Object.entries(e)){const e=qu(i),{type:n,components:s}=e;t=Ku(t,s);const o=t;t+=s,this.layout[r]={type:n,size:s,offset:o}}t+=(4-t%4)%4;const n=4*t;this.byteLength=Math.max(n,1024)}getData(e){const t=vc(Math.max(this.byteLength,1024)),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,i]of Object.entries(e)){const e=this.layout[r];if(!e){ho.warn("Supplied uniform value ".concat(r," not present in uniform block layout"))();continue}const{type:t,size:s,offset:o}=e,a=n[t];if(1===s){if("number"!==typeof i&&"boolean"!==typeof i){ho.warn("Supplied value for single component uniform ".concat(r," is not a number: ").concat(i))();continue}a[o]=Number(i)}else{const e=Ul(i);if(!e){ho.warn("Supplied value for multi component / array uniform ".concat(r," is not a numeric array: ").concat(i))();continue}a.set(e,o)}}return new Uint8Array(t)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class Zu{constructor(e){s(this,"uniformBlocks",new Map),s(this,"uniformBufferLayouts",new Map),s(this,"uniformBuffers",new Map);for(const[t,n]of Object.entries(e)){const e=t,r=new Yu(n.uniformTypes||{});this.uniformBufferLayouts.set(e,r);const i=new Hu({name:t});i.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,i)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,n]of Object.entries(e))this.uniformBlocks.get(t).setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e).byteLength}getUniformBufferData(e){const t=this.uniformBlocks.get(e).getAllUniforms();return this.uniformBufferLayouts.get(e).getData(t)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const r=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:yo.UNIFORM|yo.COPY_DST,byteLength:r}),s=this.getUniformBufferData(t);return i.write(s),i}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:yo.UNIFORM|yo.COPY_DST,byteLength:n});this.uniformBuffers.set(t,r)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||(e=n)}return e&&ho.log(3,"UniformStore.updateUniformBuffers(): ".concat(e))(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=!1;if(this.uniformBuffers.get(e)&&t.needsRedraw){n||(n=t.needsRedraw);const r=this.getUniformBufferData(e);this.uniformBuffers.get(e).write(r);const i=this.uniformBlocks.get(e).getAllUniforms();ho.log(4,"Writing to uniform buffer ".concat(String(e)),r,i)()}return n}}function Qu(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Qu(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!Qu(e[s],t[s],n-1))return!1}return!0}return!1}class $u{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Ju{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,t){if(e){t(eh.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(th.instance)}}}class eh extends Ju{}eh.instance=new eh;class th extends Ju{}th.instance=new th;class nh extends Ju{constructor(){super()}}class rh extends nh{constructor(e,t,n,r,i,s){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=r,this.startLine=i,this.endLine=s}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class ih extends nh{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class sh extends nh{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class oh extends nh{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class ah extends nh{constructor(e,t,n,r){super(),this.init=e,this.condition=t,this.increment=n,this.body=r}get astNodeType(){return"for"}search(e){var t,n,r;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(r=this.increment)||void 0===r||r.search(e),this.searchBlock(this.body,e)}}class lh extends nh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class ch extends nh{constructor(e,t,n){super(),this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class uh extends nh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class hh extends nh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var dh,fh,ph,gh,mh;!function(e){e.increment="++",e.decrement="--"}(dh||(dh={})),function(e){e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}}(dh||(dh={}));class _h extends nh{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}!function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="}(fh||(fh={})),function(e){e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}}(fh||(fh={}));class vh extends nh{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class yh extends nh{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}search(e){for(const t of this.args)t.search(e);e(this)}}class bh extends nh{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}}class Eh extends nh{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"body"}}class wh extends nh{constructor(e,t,n,r){super(),this.condition=e,this.body=t,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Sh extends nh{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Th extends nh{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class xh extends nh{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Ah extends nh{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class Rh extends nh{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class Ph extends nh{constructor(){super()}get astNodeType(){return"discard"}}class Ch extends nh{constructor(){super()}get astNodeType(){return"break"}}class kh extends nh{constructor(){super()}get astNodeType(){return"continue"}}class Lh extends nh{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class Mh extends Lh{constructor(e,t,n,r){super(e),this.members=t,this.startLine=n,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}}class Ih extends Lh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}}class Oh extends Lh{constructor(e,t,n,r){super(e),this.storage=t,this.type=n,this.access=r}get astNodeType(){return"pointer"}}class Nh extends Lh{constructor(e,t,n,r){super(e),this.attributes=t,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class Fh extends Lh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}}class Dh extends Ju{constructor(){super()}}class Bh extends Dh{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class Uh extends Dh{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}evaluate(e){return this.args[0].evaluate(e)}}class zh extends Dh{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return 180*this.args[0].evaluate(e)/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const t of this.args)t.search(e);e(this)}}class Gh extends Dh{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const t=e.constants.get(this.name);if(!t)throw new Error("Cannot evaluate node");return t.evaluate(e)}}class jh extends Dh{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}evaluate(e){var t,n;if(this.initializer instanceof Uh){const r=null===(t=this.postfix)||void 0===t?void 0:t.evaluateString(e),i=null===(n=this.initializer.type)||void 0===n?void 0:n.name,s=e.structs.get(i),o=null===s||void 0===s?void 0:s.getMemberIndex(r);if(void 0!==o&&-1!=o){return this.initializer.args[o].evaluate(e)}return this.initializer.evaluate(e)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class Vh extends Dh{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class Wh extends Dh{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Hh extends Dh{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class Xh extends Dh{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class qh extends Dh{constructor(){super()}}class Kh extends qh{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class Yh extends qh{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error("Unknown operator ".concat(this.operator))}}search(e){this.left.search(e),this.right.search(e)}}class Zh extends Ju{constructor(){super()}}class Qh extends Zh{constructor(e,t){super(),this.selector=e,this.body=t}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class $h extends Zh{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Jh extends Ju{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class ed extends Ju{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class td extends Ju{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}}class nd extends Ju{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}!function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"}(gh||(gh={}));class rd{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}}class id{}ph=id,id.none=new rd("",gh.reserved,""),id.eof=new rd("EOF",gh.token,""),id.reserved={asm:new rd("asm",gh.reserved,"asm"),bf16:new rd("bf16",gh.reserved,"bf16"),do:new rd("do",gh.reserved,"do"),enum:new rd("enum",gh.reserved,"enum"),f16:new rd("f16",gh.reserved,"f16"),f64:new rd("f64",gh.reserved,"f64"),handle:new rd("handle",gh.reserved,"handle"),i8:new rd("i8",gh.reserved,"i8"),i16:new rd("i16",gh.reserved,"i16"),i64:new rd("i64",gh.reserved,"i64"),mat:new rd("mat",gh.reserved,"mat"),premerge:new rd("premerge",gh.reserved,"premerge"),regardless:new rd("regardless",gh.reserved,"regardless"),typedef:new rd("typedef",gh.reserved,"typedef"),u8:new rd("u8",gh.reserved,"u8"),u16:new rd("u16",gh.reserved,"u16"),u64:new rd("u64",gh.reserved,"u64"),unless:new rd("unless",gh.reserved,"unless"),using:new rd("using",gh.reserved,"using"),vec:new rd("vec",gh.reserved,"vec"),void:new rd("void",gh.reserved,"void")},id.keywords={array:new rd("array",gh.keyword,"array"),atomic:new rd("atomic",gh.keyword,"atomic"),bool:new rd("bool",gh.keyword,"bool"),f32:new rd("f32",gh.keyword,"f32"),i32:new rd("i32",gh.keyword,"i32"),mat2x2:new rd("mat2x2",gh.keyword,"mat2x2"),mat2x3:new rd("mat2x3",gh.keyword,"mat2x3"),mat2x4:new rd("mat2x4",gh.keyword,"mat2x4"),mat3x2:new rd("mat3x2",gh.keyword,"mat3x2"),mat3x3:new rd("mat3x3",gh.keyword,"mat3x3"),mat3x4:new rd("mat3x4",gh.keyword,"mat3x4"),mat4x2:new rd("mat4x2",gh.keyword,"mat4x2"),mat4x3:new rd("mat4x3",gh.keyword,"mat4x3"),mat4x4:new rd("mat4x4",gh.keyword,"mat4x4"),ptr:new rd("ptr",gh.keyword,"ptr"),sampler:new rd("sampler",gh.keyword,"sampler"),sampler_comparison:new rd("sampler_comparison",gh.keyword,"sampler_comparison"),struct:new rd("struct",gh.keyword,"struct"),texture_1d:new rd("texture_1d",gh.keyword,"texture_1d"),texture_2d:new rd("texture_2d",gh.keyword,"texture_2d"),texture_2d_array:new rd("texture_2d_array",gh.keyword,"texture_2d_array"),texture_3d:new rd("texture_3d",gh.keyword,"texture_3d"),texture_cube:new rd("texture_cube",gh.keyword,"texture_cube"),texture_cube_array:new rd("texture_cube_array",gh.keyword,"texture_cube_array"),texture_multisampled_2d:new rd("texture_multisampled_2d",gh.keyword,"texture_multisampled_2d"),texture_storage_1d:new rd("texture_storage_1d",gh.keyword,"texture_storage_1d"),texture_storage_2d:new rd("texture_storage_2d",gh.keyword,"texture_storage_2d"),texture_storage_2d_array:new rd("texture_storage_2d_array",gh.keyword,"texture_storage_2d_array"),texture_storage_3d:new rd("texture_storage_3d",gh.keyword,"texture_storage_3d"),texture_depth_2d:new rd("texture_depth_2d",gh.keyword,"texture_depth_2d"),texture_depth_2d_array:new rd("texture_depth_2d_array",gh.keyword,"texture_depth_2d_array"),texture_depth_cube:new rd("texture_depth_cube",gh.keyword,"texture_depth_cube"),texture_depth_cube_array:new rd("texture_depth_cube_array",gh.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new rd("texture_depth_multisampled_2d",gh.keyword,"texture_depth_multisampled_2d"),texture_external:new rd("texture_external",gh.keyword,"texture_external"),u32:new rd("u32",gh.keyword,"u32"),vec2:new rd("vec2",gh.keyword,"vec2"),vec3:new rd("vec3",gh.keyword,"vec3"),vec4:new rd("vec4",gh.keyword,"vec4"),bitcast:new rd("bitcast",gh.keyword,"bitcast"),block:new rd("block",gh.keyword,"block"),break:new rd("break",gh.keyword,"break"),case:new rd("case",gh.keyword,"case"),continue:new rd("continue",gh.keyword,"continue"),continuing:new rd("continuing",gh.keyword,"continuing"),default:new rd("default",gh.keyword,"default"),diagnostic:new rd("diagnostic",gh.keyword,"diagnostic"),discard:new rd("discard",gh.keyword,"discard"),else:new rd("else",gh.keyword,"else"),enable:new rd("enable",gh.keyword,"enable"),fallthrough:new rd("fallthrough",gh.keyword,"fallthrough"),false:new rd("false",gh.keyword,"false"),fn:new rd("fn",gh.keyword,"fn"),for:new rd("for",gh.keyword,"for"),function:new rd("function",gh.keyword,"function"),if:new rd("if",gh.keyword,"if"),let:new rd("let",gh.keyword,"let"),const:new rd("const",gh.keyword,"const"),loop:new rd("loop",gh.keyword,"loop"),while:new rd("while",gh.keyword,"while"),private:new rd("private",gh.keyword,"private"),read:new rd("read",gh.keyword,"read"),read_write:new rd("read_write",gh.keyword,"read_write"),return:new rd("return",gh.keyword,"return"),requires:new rd("requires",gh.keyword,"requires"),storage:new rd("storage",gh.keyword,"storage"),switch:new rd("switch",gh.keyword,"switch"),true:new rd("true",gh.keyword,"true"),alias:new rd("alias",gh.keyword,"alias"),type:new rd("type",gh.keyword,"type"),uniform:new rd("uniform",gh.keyword,"uniform"),var:new rd("var",gh.keyword,"var"),override:new rd("override",gh.keyword,"override"),workgroup:new rd("workgroup",gh.keyword,"workgroup"),write:new rd("write",gh.keyword,"write"),r8unorm:new rd("r8unorm",gh.keyword,"r8unorm"),r8snorm:new rd("r8snorm",gh.keyword,"r8snorm"),r8uint:new rd("r8uint",gh.keyword,"r8uint"),r8sint:new rd("r8sint",gh.keyword,"r8sint"),r16uint:new rd("r16uint",gh.keyword,"r16uint"),r16sint:new rd("r16sint",gh.keyword,"r16sint"),r16float:new rd("r16float",gh.keyword,"r16float"),rg8unorm:new rd("rg8unorm",gh.keyword,"rg8unorm"),rg8snorm:new rd("rg8snorm",gh.keyword,"rg8snorm"),rg8uint:new rd("rg8uint",gh.keyword,"rg8uint"),rg8sint:new rd("rg8sint",gh.keyword,"rg8sint"),r32uint:new rd("r32uint",gh.keyword,"r32uint"),r32sint:new rd("r32sint",gh.keyword,"r32sint"),r32float:new rd("r32float",gh.keyword,"r32float"),rg16uint:new rd("rg16uint",gh.keyword,"rg16uint"),rg16sint:new rd("rg16sint",gh.keyword,"rg16sint"),rg16float:new rd("rg16float",gh.keyword,"rg16float"),rgba8unorm:new rd("rgba8unorm",gh.keyword,"rgba8unorm"),rgba8unorm_srgb:new rd("rgba8unorm_srgb",gh.keyword,"rgba8unorm_srgb"),rgba8snorm:new rd("rgba8snorm",gh.keyword,"rgba8snorm"),rgba8uint:new rd("rgba8uint",gh.keyword,"rgba8uint"),rgba8sint:new rd("rgba8sint",gh.keyword,"rgba8sint"),bgra8unorm:new rd("bgra8unorm",gh.keyword,"bgra8unorm"),bgra8unorm_srgb:new rd("bgra8unorm_srgb",gh.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new rd("rgb10a2unorm",gh.keyword,"rgb10a2unorm"),rg11b10float:new rd("rg11b10float",gh.keyword,"rg11b10float"),rg32uint:new rd("rg32uint",gh.keyword,"rg32uint"),rg32sint:new rd("rg32sint",gh.keyword,"rg32sint"),rg32float:new rd("rg32float",gh.keyword,"rg32float"),rgba16uint:new rd("rgba16uint",gh.keyword,"rgba16uint"),rgba16sint:new rd("rgba16sint",gh.keyword,"rgba16sint"),rgba16float:new rd("rgba16float",gh.keyword,"rgba16float"),rgba32uint:new rd("rgba32uint",gh.keyword,"rgba32uint"),rgba32sint:new rd("rgba32sint",gh.keyword,"rgba32sint"),rgba32float:new rd("rgba32float",gh.keyword,"rgba32float"),static_assert:new rd("static_assert",gh.keyword,"static_assert")},id.tokens={decimal_float_literal:new rd("decimal_float_literal",gh.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new rd("hex_float_literal",gh.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new rd("int_literal",gh.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new rd("uint_literal",gh.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new rd("ident",gh.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new rd("and",gh.token,"&"),and_and:new rd("and_and",gh.token,"&&"),arrow:new rd("arrow ",gh.token,"->"),attr:new rd("attr",gh.token,"@"),forward_slash:new rd("forward_slash",gh.token,"/"),bang:new rd("bang",gh.token,"!"),bracket_left:new rd("bracket_left",gh.token,"["),bracket_right:new rd("bracket_right",gh.token,"]"),brace_left:new rd("brace_left",gh.token,"{"),brace_right:new rd("brace_right",gh.token,"}"),colon:new rd("colon",gh.token,":"),comma:new rd("comma",gh.token,","),equal:new rd("equal",gh.token,"="),equal_equal:new rd("equal_equal",gh.token,"=="),not_equal:new rd("not_equal",gh.token,"!="),greater_than:new rd("greater_than",gh.token,">"),greater_than_equal:new rd("greater_than_equal",gh.token,">="),shift_right:new rd("shift_right",gh.token,">>"),less_than:new rd("less_than",gh.token,"<"),less_than_equal:new rd("less_than_equal",gh.token,"<="),shift_left:new rd("shift_left",gh.token,"<<"),modulo:new rd("modulo",gh.token,"%"),minus:new rd("minus",gh.token,"-"),minus_minus:new rd("minus_minus",gh.token,"--"),period:new rd("period",gh.token,"."),plus:new rd("plus",gh.token,"+"),plus_plus:new rd("plus_plus",gh.token,"++"),or:new rd("or",gh.token,"|"),or_or:new rd("or_or",gh.token,"||"),paren_left:new rd("paren_left",gh.token,"("),paren_right:new rd("paren_right",gh.token,")"),semicolon:new rd("semicolon",gh.token,";"),star:new rd("star",gh.token,"*"),tilde:new rd("tilde",gh.token,"~"),underscore:new rd("underscore",gh.token,"_"),xor:new rd("xor",gh.token,"^"),plus_equal:new rd("plus_equal",gh.token,"+="),minus_equal:new rd("minus_equal",gh.token,"-="),times_equal:new rd("times_equal",gh.token,"*="),division_equal:new rd("division_equal",gh.token,"/="),modulo_equal:new rd("modulo_equal",gh.token,"%="),and_equal:new rd("and_equal",gh.token,"&="),or_equal:new rd("or_equal",gh.token,"|="),xor_equal:new rd("xor_equal",gh.token,"^="),shift_right_equal:new rd("shift_right_equal",gh.token,">>="),shift_left_equal:new rd("shift_left_equal",gh.token,"<<=")},id.simpleTokens={"@":ph.tokens.attr,"{":ph.tokens.brace_left,"}":ph.tokens.brace_right,":":ph.tokens.colon,",":ph.tokens.comma,"(":ph.tokens.paren_left,")":ph.tokens.paren_right,";":ph.tokens.semicolon},id.literalTokens={"&":ph.tokens.and,"&&":ph.tokens.and_and,"->":ph.tokens.arrow,"/":ph.tokens.forward_slash,"!":ph.tokens.bang,"[":ph.tokens.bracket_left,"]":ph.tokens.bracket_right,"=":ph.tokens.equal,"==":ph.tokens.equal_equal,"!=":ph.tokens.not_equal,">":ph.tokens.greater_than,">=":ph.tokens.greater_than_equal,">>":ph.tokens.shift_right,"<":ph.tokens.less_than,"<=":ph.tokens.less_than_equal,"<<":ph.tokens.shift_left,"%":ph.tokens.modulo,"-":ph.tokens.minus,"--":ph.tokens.minus_minus,".":ph.tokens.period,"+":ph.tokens.plus,"++":ph.tokens.plus_plus,"|":ph.tokens.or,"||":ph.tokens.or_or,"*":ph.tokens.star,"~":ph.tokens.tilde,_:ph.tokens.underscore,"^":ph.tokens.xor,"+=":ph.tokens.plus_equal,"-=":ph.tokens.minus_equal,"*=":ph.tokens.times_equal,"/=":ph.tokens.division_equal,"%=":ph.tokens.modulo_equal,"&=":ph.tokens.and_equal,"|=":ph.tokens.or_equal,"^=":ph.tokens.xor_equal,">>=":ph.tokens.shift_right_equal,"<<=":ph.tokens.shift_left_equal},id.regexTokens={decimal_float_literal:ph.tokens.decimal_float_literal,hex_float_literal:ph.tokens.hex_float_literal,int_literal:ph.tokens.int_literal,uint_literal:ph.tokens.uint_literal,ident:ph.tokens.ident},id.storage_class=[ph.keywords.function,ph.keywords.private,ph.keywords.workgroup,ph.keywords.uniform,ph.keywords.storage],id.access_mode=[ph.keywords.read,ph.keywords.write,ph.keywords.read_write],id.sampler_type=[ph.keywords.sampler,ph.keywords.sampler_comparison],id.sampled_texture_type=[ph.keywords.texture_1d,ph.keywords.texture_2d,ph.keywords.texture_2d_array,ph.keywords.texture_3d,ph.keywords.texture_cube,ph.keywords.texture_cube_array],id.multisampled_texture_type=[ph.keywords.texture_multisampled_2d],id.storage_texture_type=[ph.keywords.texture_storage_1d,ph.keywords.texture_storage_2d,ph.keywords.texture_storage_2d_array,ph.keywords.texture_storage_3d],id.depth_texture_type=[ph.keywords.texture_depth_2d,ph.keywords.texture_depth_2d_array,ph.keywords.texture_depth_cube,ph.keywords.texture_depth_cube_array,ph.keywords.texture_depth_multisampled_2d],id.texture_external_type=[ph.keywords.texture_external],id.any_texture_type=[...ph.sampled_texture_type,...ph.multisampled_texture_type,...ph.storage_texture_type,...ph.depth_texture_type,...ph.texture_external_type],id.texel_format=[ph.keywords.r8unorm,ph.keywords.r8snorm,ph.keywords.r8uint,ph.keywords.r8sint,ph.keywords.r16uint,ph.keywords.r16sint,ph.keywords.r16float,ph.keywords.rg8unorm,ph.keywords.rg8snorm,ph.keywords.rg8uint,ph.keywords.rg8sint,ph.keywords.r32uint,ph.keywords.r32sint,ph.keywords.r32float,ph.keywords.rg16uint,ph.keywords.rg16sint,ph.keywords.rg16float,ph.keywords.rgba8unorm,ph.keywords.rgba8unorm_srgb,ph.keywords.rgba8snorm,ph.keywords.rgba8uint,ph.keywords.rgba8sint,ph.keywords.bgra8unorm,ph.keywords.bgra8unorm_srgb,ph.keywords.rgb10a2unorm,ph.keywords.rg11b10float,ph.keywords.rg32uint,ph.keywords.rg32sint,ph.keywords.rg32float,ph.keywords.rgba16uint,ph.keywords.rgba16sint,ph.keywords.rgba16float,ph.keywords.rgba32uint,ph.keywords.rgba32sint,ph.keywords.rgba32float],id.const_literal=[ph.tokens.int_literal,ph.tokens.uint_literal,ph.tokens.decimal_float_literal,ph.tokens.hex_float_literal,ph.keywords.true,ph.keywords.false],id.literal_or_ident=[ph.tokens.ident,ph.tokens.int_literal,ph.tokens.uint_literal,ph.tokens.decimal_float_literal,ph.tokens.hex_float_literal],id.element_count_expression=[ph.tokens.int_literal,ph.tokens.uint_literal,ph.tokens.ident],id.template_types=[ph.keywords.vec2,ph.keywords.vec3,ph.keywords.vec4,ph.keywords.mat2x2,ph.keywords.mat2x3,ph.keywords.mat2x4,ph.keywords.mat3x2,ph.keywords.mat3x3,ph.keywords.mat3x4,ph.keywords.mat4x2,ph.keywords.mat4x3,ph.keywords.mat4x4,ph.keywords.atomic,ph.keywords.bitcast,...ph.any_texture_type],id.attribute_name=[ph.tokens.ident,ph.keywords.block,ph.keywords.diagnostic],id.assignment_operators=[ph.tokens.equal,ph.tokens.plus_equal,ph.tokens.minus_equal,ph.tokens.times_equal,ph.tokens.division_equal,ph.tokens.modulo_equal,ph.tokens.and_equal,ph.tokens.or_equal,ph.tokens.xor_equal,ph.tokens.shift_right_equal,ph.tokens.shift_left_equal],id.increment_operators=[ph.tokens.plus_plus,ph.tokens.minus_minus];class sd{constructor(e,t,n){this.type=e,this.lexeme=t,this.line=n}toString(){return this.lexeme}isTemplateType(){return-1!=id.template_types.indexOf(this.type)}isArrayType(){return this.type==id.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class od{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!==e&&void 0!==e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw"Invalid syntax at line ".concat(this._line);return this._tokens.push(new sd(id.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=id.simpleTokens[e];if(t)return this._addToken(t),!0;let n=id.none;const r=this._isAlpha(e),i="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(r){const t=id.keywords[e];if(t)return this._addToken(t),!0}if(r||i)return this._addToken(id.tokens.ident),!0;for(;;){let t=this._findType(e);const r=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==r)return this._current++,e+=r,this._addToken(id.tokens.minus_equal),!0;if("-"==r)return this._current++,e+=r,this._addToken(id.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=id.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==id.tokens.paren_right)&&">"!=r)return this._addToken(t),!0}if(">"==e&&(">"==r||"="==r)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===id.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===id.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===id.none){let r=e,i=0;const s=2;for(let e=0;e<s;++e)if(r+=this._peekAhead(e),t=this._findType(r),t!==id.none){i=e;break}if(t===id.none)return n!==id.none&&(this._current--,this._addToken(n),!0);e=r,this._current+=i+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==id.none&&(this._addToken(n),!0)}_findType(e){for(const n in id.regexTokens){const t=id.regexTokens[n];if(this._match(e,t.rule))return t}const t=id.literalTokens[e];return t||id.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"==e||e>="0"&&e<="9"}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new sd(e,t,this._line))}}class ad{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new $u,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const e of this._deferArrayCountEval){const t=e.arrayType,r=e.countNode;if(r instanceof Gh){const e=r.name,i=this._context.constants.get(e);if(i)try{const e=i.evaluate(this._context);t.count=e}catch(n){}}}this._deferArrayCountEval.length=0}return t}_initialize(e){if(e)if("string"==typeof e){const t=new od(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,t){return{token:e,message:t,toString:function(){return"".concat(t)}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==id.eof}_match(e){if(e instanceof rd)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),t)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;return-1!=e.indexOf(n)}return t.type==e}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(id.tokens.semicolon)&&!this._isAtEnd(););if(this._match(id.keywords.alias)){const e=this._type_alias();return this._consume(id.tokens.semicolon,"Expected ';'"),e}if(this._match(id.keywords.diagnostic)){const e=this._diagnostic();return this._consume(id.tokens.semicolon,"Expected ';'"),e}if(this._match(id.keywords.requires)){const e=this._requires_directive();return this._consume(id.tokens.semicolon,"Expected ';'"),e}if(this._match(id.keywords.enable)){const e=this._enable_directive();return this._consume(id.tokens.semicolon,"Expected ';'"),e}const e=this._attribute();if(this._check(id.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(id.tokens.semicolon,"Expected ';'."),t}if(this._check(id.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(id.tokens.semicolon,"Expected ';'."),t}if(this._check(id.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(id.tokens.semicolon,"Expected ';'."),t}if(this._check(id.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(id.tokens.semicolon,"Expected ';'."),t}if(this._check(id.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),t}if(this._check(id.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),t}return null}_function_decl(){if(!this._match(id.keywords.fn))return null;const e=this._currentLine,t=this._consume(id.tokens.ident,"Expected function name.").toString();this._consume(id.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(id.tokens.paren_right))do{if(this._check(id.tokens.paren_right))break;const e=this._attribute(),t=this._consume(id.tokens.ident,"Expected argument name.").toString();this._consume(id.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r,n.push(new Jh(t,i,e)))}while(this._match(id.tokens.comma));this._consume(id.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(id.tokens.arrow)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}const i=this._compound_statement(),s=this._currentLine;return new rh(t,n,r,i,e,s)}_compound_statement(){const e=[];for(this._consume(id.tokens.brace_left,"Expected '{' for block.");!this._check(id.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(id.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(id.tokens.semicolon)&&!this._isAtEnd(););if(this._check(id.tokens.attr)&&this._attribute(),this._check(id.keywords.if))return this._if_statement();if(this._check(id.keywords.switch))return this._switch_statement();if(this._check(id.keywords.loop))return this._loop_statement();if(this._check(id.keywords.for))return this._for_statement();if(this._check(id.keywords.while))return this._while_statement();if(this._check(id.keywords.continuing))return this._continuing_statement();if(this._check(id.keywords.static_assert))return this._static_assert_statement();if(this._check(id.tokens.brace_left))return this._compound_statement();let e=null;return e=this._check(id.keywords.return)?this._return_statement():this._check([id.keywords.var,id.keywords.let,id.keywords.const])?this._variable_statement():this._match(id.keywords.discard)?new Ph:this._match(id.keywords.break)?new Ch:this._match(id.keywords.continue)?new kh:this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),null!=e&&this._consume(id.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(id.keywords.static_assert))return null;const e=this._optional_paren_expression();return new ih(e)}_while_statement(){if(!this._match(id.keywords.while))return null;const e=this._optional_paren_expression();this._check(id.tokens.attr)&&this._attribute();const t=this._compound_statement();return new sh(e,t)}_continuing_statement(){if(!this._match(id.keywords.continuing))return null;const e=this._compound_statement();return new oh(e)}_for_statement(){if(!this._match(id.keywords.for))return null;this._consume(id.tokens.paren_left,"Expected '('.");const e=this._check(id.tokens.semicolon)?null:this._for_init();this._consume(id.tokens.semicolon,"Expected ';'.");const t=this._check(id.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(id.tokens.semicolon,"Expected ';'.");const n=this._check(id.tokens.paren_right)?null:this._for_increment();this._consume(id.tokens.paren_right,"Expected ')'."),this._check(id.tokens.attr)&&this._attribute();const r=this._compound_statement();return new ah(e,t,n,r)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(id.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(id.tokens.equal)&&(t=this._short_circuit_or_expression()),new lh(e.name,e.type,e.storage,e.access,t)}if(this._match(id.keywords.let)){const e=this._consume(id.tokens.ident,"Expected name for let.").toString();let t=null;if(this._match(id.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(id.tokens.equal,"Expected '=' for let.");const n=this._short_circuit_or_expression();return new uh(e,t,null,null,n)}if(this._match(id.keywords.const)){const e=this._consume(id.tokens.ident,"Expected name for const.").toString();let t=null;if(this._match(id.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(id.tokens.equal,"Expected '=' for const.");const n=this._short_circuit_or_expression();return new hh(e,t,null,null,n)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(id.increment_operators))return this._current=e,null;const n=this._consume(id.increment_operators,"Expected increment operator");return new _h(n.type===id.tokens.plus_plus?dh.increment:dh.decrement,t)}_assignment_statement(){let e=null;if(this._check(id.tokens.brace_right))return null;let t=this._match(id.tokens.underscore);if(t||(e=this._unary_expression()),!t&&null==e)return null;const n=this._consume(id.assignment_operators,"Expected assignment operator."),r=this._short_circuit_or_expression();return new vh(fh.parse(n.lexeme),e,r)}_func_call_statement(){if(!this._check(id.tokens.ident))return null;const e=this._current,t=this._consume(id.tokens.ident,"Expected function name."),n=this._argument_expression_list();return null===n?(this._current=e,null):new yh(t.lexeme,n)}_loop_statement(){if(!this._match(id.keywords.loop))return null;this._check(id.tokens.attr)&&this._attribute(),this._consume(id.tokens.brace_left,"Expected '{' for loop.");const e=[];let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.push(n);else e.push(t);t=this._statement()}let n=null;return this._match(id.keywords.continuing)&&(n=this._compound_statement()),this._consume(id.tokens.brace_right,"Expected '}' for loop."),new bh(e,n)}_switch_statement(){if(!this._match(id.keywords.switch))return null;const e=this._optional_paren_expression();this._check(id.tokens.attr)&&this._attribute(),this._consume(id.tokens.brace_left,"Expected '{' for switch.");const t=this._switch_body();if(null==t||0==t.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(id.tokens.brace_right,"Expected '}' for switch."),new Eh(e,t)}_switch_body(){const e=[];if(this._match(id.keywords.case)){const t=this._case_selectors();this._match(id.tokens.colon),this._check(id.tokens.attr)&&this._attribute(),this._consume(id.tokens.brace_left,"Exected '{' for switch case.");const n=this._case_body();this._consume(id.tokens.brace_right,"Exected '}' for switch case."),e.push(new Qh(t,n))}if(this._match(id.keywords.default)){this._match(id.tokens.colon),this._check(id.tokens.attr)&&this._attribute(),this._consume(id.tokens.brace_left,"Exected '{' for switch default.");const t=this._case_body();this._consume(id.tokens.brace_right,"Exected '}' for switch default."),e.push(new $h(t))}if(this._check([id.keywords.default,id.keywords.case])){const t=this._switch_body();e.push(t[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(id.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(id.keywords.fallthrough))return this._consume(id.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(id.keywords.if))return null;const e=this._optional_paren_expression();this._check(id.tokens.attr)&&this._attribute();const t=this._compound_statement();let n=[];this._match_elseif()&&(this._check(id.tokens.attr)&&this._attribute(),n=this._elseif_statement(n));let r=null;return this._match(id.keywords.else)&&(this._check(id.tokens.attr)&&this._attribute(),r=this._compound_statement()),new wh(e,t,n,r)}_match_elseif(){return this._tokens[this._current].type===id.keywords.else&&this._tokens[this._current+1].type===id.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(new ed(t,n)),this._match_elseif()&&(this._check(id.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(id.keywords.return))return null;const e=this._short_circuit_or_expression();return new Sh(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(id.tokens.or_or);)e=new Yh(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(id.tokens.and_and);)e=new Yh(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(id.tokens.or);)e=new Yh(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(id.tokens.xor);)e=new Yh(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(id.tokens.and);)e=new Yh(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([id.tokens.equal_equal,id.tokens.not_equal])?new Yh(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([id.tokens.less_than,id.tokens.greater_than,id.tokens.less_than_equal,id.tokens.greater_than_equal]);)e=new Yh(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([id.tokens.shift_left,id.tokens.shift_right]);)e=new Yh(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([id.tokens.plus,id.tokens.minus]);)e=new Yh(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([id.tokens.star,id.tokens.forward_slash,id.tokens.modulo]);)e=new Yh(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([id.tokens.minus,id.tokens.bang,id.tokens.tilde,id.tokens.star,id.tokens.and])?new Kh(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(id.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(id.tokens.bracket_right,"Expected ']'.");const t=new Xh(e),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(id.tokens.period)){const e=this._consume(id.tokens.ident,"Expected member name."),t=this._postfix_expression(),n=new Bh(e.lexeme);return t&&(n.postfix=t),n}return null}_getStruct(e){if(this._context.aliases.has(e)){return this._context.aliases.get(e).type}if(this._context.structs.has(e)){return this._context.structs.get(e)}return null}_primary_expression(){if(this._match(id.tokens.ident)){const e=this._previous().toString();if(this._check(id.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getStruct(e);return null!=n?new Uh(n,t):new zh(e,t)}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return new jh(e,t.value)}return new Gh(e)}if(this._match(id.const_literal))return new Vh(parseFloat(this._previous().toString()));if(this._check(id.tokens.paren_left))return this._paren_expression();if(this._match(id.keywords.bitcast)){this._consume(id.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(id.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return new Wh(e,t)}const e=this._type_decl(),t=this._argument_expression_list();return new Uh(e,t)}_argument_expression_list(){if(!this._match(id.tokens.paren_left))return null;const e=[];do{if(this._check(id.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(id.tokens.comma));return this._consume(id.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(id.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(id.tokens.paren_right),new Hh([e])}_paren_expression(){this._consume(id.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(id.tokens.paren_right,"Expected ')'."),new Hh([e])}_struct_decl(){if(!this._match(id.keywords.struct))return null;const e=this._currentLine,t=this._consume(id.tokens.ident,"Expected name for struct.").toString();this._consume(id.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(id.tokens.brace_right);){const e=this._attribute(),t=this._consume(id.tokens.ident,"Expected variable name.").toString();this._consume(id.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r),this._check(id.tokens.brace_right)?this._match(id.tokens.comma):this._consume(id.tokens.comma,"Expected ',' for struct member."),n.push(new td(t,i,e))}this._consume(id.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,i=new Mh(t,n,e,r);return this._context.structs.set(t,i),i}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(id.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(id.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(id.keywords.const))return null;const e=this._consume(id.tokens.ident,"Expected variable name");let t=null;if(this._match(id.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let n=null;if(this._match(id.tokens.equal)){const e=this._short_circuit_or_expression();if(e instanceof Uh)n=e;else if(e instanceof jh&&e.initializer instanceof Uh)n=e.initializer;else try{const t=e.evaluate(this._context);n=new Vh(t)}catch(ph){n=e}}const r=new hh(e.toString(),t,"","",n);return this._context.constants.set(r.name,r),r}_global_let_decl(){if(!this._match(id.keywords.let))return null;const e=this._consume(id.tokens.ident,"Expected variable name");let t=null;if(this._match(id.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let n=null;return this._match(id.tokens.equal)&&(n=this._const_expression()),new uh(e.toString(),t,"","",n)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(id.keywords.var))return null;let e="",t="";this._match(id.tokens.less_than)&&(e=this._consume(id.storage_class,"Expected storage_class.").toString(),this._match(id.tokens.comma)&&(t=this._consume(id.access_mode,"Expected access_mode.").toString()),this._consume(id.tokens.greater_than,"Expected '>'."));const n=this._consume(id.tokens.ident,"Expected variable name");let r=null;if(this._match(id.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}return new lh(n.toString(),r,e,t,null)}_override_decl(){if(!this._match(id.keywords.override))return null;const e=this._consume(id.tokens.ident,"Expected variable name");let t=null;if(this._match(id.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return new ch(e.toString(),t,null)}_diagnostic(){this._consume(id.tokens.paren_left,"Expected '('");const e=this._consume(id.tokens.ident,"Expected severity control name.");this._consume(id.tokens.comma,"Expected ','");const t=this._consume(id.tokens.ident,"Expected diagnostic rule name.");return this._consume(id.tokens.paren_right,"Expected ')'"),new Ah(e.toString(),t.toString())}_enable_directive(){const e=this._consume(id.tokens.ident,"identity expected.");return new Th(e.toString())}_requires_directive(){const e=[this._consume(id.tokens.ident,"identity expected.").toString()];for(;this._match(id.tokens.comma);){const t=this._consume(id.tokens.ident,"identity expected.");e.push(t.toString())}return new xh(e)}_type_alias(){const e=this._consume(id.tokens.ident,"identity expected.");this._consume(id.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=new Rh(e.toString(),t);return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([id.tokens.ident,...id.texel_format,id.keywords.bool,id.keywords.f32,id.keywords.i32,id.keywords.u32])){const e=this._advance(),t=e.toString();return this._context.structs.has(t)?this._context.structs.get(t):this._context.aliases.has(t)?this._context.aliases.get(t).type:new Lh(e.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(id.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(id.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(id.tokens.comma)&&(n=this._consume(id.access_mode,"Expected access_mode for pointer").toString()),this._consume(id.tokens.greater_than,"Expected '>' for type.")),new Ih(e,t,n)}if(this._match(id.keywords.ptr)){let e=this._previous().toString();this._consume(id.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(id.storage_class,"Expected storage_class for pointer");this._consume(id.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(id.tokens.comma)&&(r=this._consume(id.access_mode,"Expected access_mode for pointer").toString()),this._consume(id.tokens.greater_than,"Expected '>' for pointer."),new Oh(e,t.toString(),n,r)}const t=this._attribute();if(this._match(id.keywords.array)){let e=null,r=-1;const i=this._previous();let s=null;if(this._match(id.tokens.less_than)){e=this._type_decl(),this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);let t="";if(this._match(id.tokens.comma)){s=this._shift_expression();try{t=s.evaluate(this._context).toString(),s=null}catch(n){t="1"}}this._consume(id.tokens.greater_than,"Expected '>' for array."),r=t?parseInt(t):0}const o=new Nh(i.toString(),t,e,r);return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(id.sampler_type))return new Fh(this._previous().toString(),null,null);if(this._match(id.depth_texture_type))return new Fh(this._previous().toString(),null,null);if(this._match(id.sampled_texture_type)||this._match(id.multisampled_texture_type)){const e=this._previous();this._consume(id.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(id.tokens.greater_than,"Expected '>' for sampler type."),new Fh(e.toString(),t,null)}if(this._match(id.storage_texture_type)){const e=this._previous();this._consume(id.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(id.texel_format,"Invalid texel format.").toString();this._consume(id.tokens.comma,"Expected ',' after texel format.");const n=this._consume(id.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(id.tokens.greater_than,"Expected '>' for sampler type."),new Fh(e.toString(),t,n)}return null}_attribute(){let e=[];for(;this._match(id.tokens.attr);){const t=this._consume(id.attribute_name,"Expected attribute name"),n=new nd(t.toString(),null);if(this._match(id.tokens.paren_left)){if(n.value=this._consume(id.literal_or_ident,"Expected attribute value").toString(),this._check(id.tokens.comma)){this._advance();do{const e=this._consume(id.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(id.tokens.comma))}this._consume(id.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}}class ld{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class cd{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class ud extends ld{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class hd extends ld{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}}class dd extends ld{constructor(e,t,n,r){super(e,n),this.format=t,this.access=r}get isTemplate(){return!0}}!function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"}(mh||(mh={}));class fd{constructor(e,t,n,r,i,s,o){this.name=e,this.type=t,this.group=n,this.binding=r,this.attributes=i,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class pd{constructor(e,t){this.name=e,this.type=t}}class gd{constructor(e,t){this.align=e,this.size=t}}class md{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r,this.interpolation=null}}class _d{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r}}class vd{constructor(e,t,n,r){this.name=e,this.type=t,this.attributes=n,this.id=r}}class yd{constructor(e,t){this.name=e,this.type=t}}class bd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t}}class Ed{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class wd{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Sd{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Ed,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}update(e){const t=(new ad).parse(e);for(const n of t)n instanceof rh&&this._functions.set(n.name,new wd(n));for(const n of t)if(n instanceof Mh){const e=this._getTypeInfo(n,null);e instanceof ud&&this.structs.push(e)}for(const n of t)if(n instanceof Rh)this.aliases.push(this._getAliasInfo(n));else if(n instanceof ch){const e=n,t=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this._getTypeInfo(e.type,e.attributes):null;this.overrides.push(new vd(e.name,r,e.attributes,t))}else if(this._isUniformVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=new fd(e.name,i,t,r,e.attributes,mh.Uniform,e.access);this.uniforms.push(s)}else if(this._isStorageVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new fd(e.name,i,t,r,e.attributes,s?mh.StorageTexture:mh.Storage,e.access);this.storage.push(o)}else if(this._isTextureVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new fd(e.name,i,t,r,e.attributes,s?mh.StorageTexture:mh.Texture,e.access);s?this.storage.push(o):this.textures.push(o)}else if(this._isSamplerVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=new fd(e.name,i,t,r,e.attributes,mh.Sampler,e.access);this.samplers.push(s)}else if(n instanceof rh){const e=this._getAttribute(n,"vertex"),t=this._getAttribute(n,"fragment"),r=this._getAttribute(n,"compute"),i=e||t||r,s=new bd(n.name,null===i||void 0===i?void 0:i.name);s.startLine=n.startLine,s.endLine=n.endLine,this.functions.push(s),this._functions.get(n.name).info=s,i?(this._functions.get(n.name).inUse=!0,s.inUse=!0,s.resources=this._findResources(n,!!i),s.inputs=this._getInputs(n.args),s.outputs=this._getOutputs(n.returnType),this.entry[i.name].push(s)):(s.arguments=n.args.map((e=>new yd(e.name,this._getTypeInfo(e.type,e.attributes)))),s.returnType=n.returnType?this._getTypeInfo(n.returnType,n.attributes):null)}else;for(const n of this._functions.values())n.info&&(n.info.inUse=n.inUse,this._addCalls(n.node,n.info.calls));for(const n of this._functions.values())n.node.search((e=>{var t;if("varExpr"===e.astNodeType){const r=e;for(const e of this.overrides)r.name==e.name&&(null===(t=n.info)||void 0===t||t.overrides.push(e))}}));for(const n of this.uniforms)this._markStructsInUse(n.type);for(const n of this.storage)this._markStructsInUse(n.type)}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const r of e.calls){const e=null===(n=this._functions.get(r.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t){for(const n of this.uniforms)if(n.group==e&&n.binding==t)return n;for(const n of this.storage)if(n.group==e&&n.binding==t)return n;for(const n of this.textures)if(n.group==e&&n.binding==t)return n;for(const n of this.samplers)if(n.group==e&&n.binding==t)return n;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this._getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],r=this,i=[];return e.search((s=>{if(s instanceof eh)i.push({});else if(s instanceof th)i.pop();else if(s instanceof lh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Uh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(s instanceof uh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Gh){const e=s;if(i.length>0){if(i[i.length-1][e.name])return}const t=r._findResource(e.name);t&&n.push(t)}else if(s instanceof zh){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}else if(s instanceof yh){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}})),[...new Map(n.map((e=>[e.name,e]))).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.storage){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.textures){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.samplers){t(n.group,n.binding);e[n.group][n.binding]=n}return e}_getOutputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0===t&&(t=[]),e instanceof Mh)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof Mh)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const r=this._getTypeInfo(n.type,n.type.attributes),i=this._parseInt(e.value),s=new _d(n.name,r,e.name,i);t.push(s)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new _d("",n,t.name,r)}return null}_getInputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0===t&&(t=[]);for(const n of e)if(n.type instanceof Mh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof Mh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),r=this._getTypeInfo(e.type,e.attributes),i=this._parseInt(t.value),s=new md(e.name,r,t.name,i);return null!==n&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new pd(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,t){if(this._types.has(e))return this._types.get(e);if(e instanceof Nh){const n=e,r=n.format?this._getTypeInfo(n.format,n.attributes):null,i=new hd(n.name,t);return i.format=r,i.count=n.count,this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof Mh){const n=e,r=new ud(n.name,t);r.startLine=n.startLine,r.endLine=n.endLine;for(const e of n.members){const t=this._getTypeInfo(e.type,e.attributes);r.members.push(new cd(e.name,t,e.attributes))}return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof Fh){const n=e,r=n.format instanceof Lh,i=n.format?r?this._getTypeInfo(n.format,null):new ld(n.format,null):null,s=new dd(n.name,i,t,n.access);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Ih){const n=e,r=n.format?this._getTypeInfo(n.format,null):null,i=new dd(n.name,r,t,n.access);return this._types.set(e,i),this._updateTypeInfo(i),i}const n=new ld(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n;const r=this._getTypeSize(e);if(e.size=null!==(t=null===r||void 0===r?void 0:r.size)&&void 0!==t?t:0,e instanceof hd&&e.format){const t=this._getTypeSize(e.format);e.stride=null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:0,this._updateTypeInfo(e.format)}e instanceof ud&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,r=0,i=0,s=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const c=l.align,u=l.size;n=this._roundUp(c,n+r),r=u,i=n,s=Math.max(s,c),a.offset=n,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(s,i+r),e.align=s}_getTypeSize(e){var t,n;if(null===e||void 0===e)return null;const r=this._getAttributeNum(e.attributes,"size",0),i=this._getAttributeNum(e.attributes,"align",0);if(e instanceof cd&&(e=e.type),e instanceof ld){const t=this._getAlias(e.name);null!==t&&(e=t)}{const n=Sd._typeInfo[e.name];if(void 0!==n){const s="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new gd(Math.max(i,n.align/s),Math.max(r,n.size/s))}}{const t=Sd._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const n="h"===e.name[e.name.length-1]?2:1;return new gd(Math.max(i,t.align/n),Math.max(r,t.size/n))}}if(e instanceof hd){let t=e,s=8,o=8;const a=this._getTypeSize(t.format);null!==a&&(o=a.size,s=a.align);return o=t.count*this._getAttributeNum(null!==(n=null===e||void 0===e?void 0:e.attributes)&&void 0!==n?n:null,"stride",this._roundUp(s,o)),r&&(o=r),new gd(Math.max(i,s),Math.max(r,o))}if(e instanceof ud){let t=0,n=0,s=0,o=0,a=0;for(const r of e.members){const e=this._getTypeSize(r.type);null!==e&&(t=Math.max(e.align,t),s=this._roundUp(e.align,s+o),o=e.size,a=s)}return n=this._roundUp(t,a+o),new gd(Math.max(i,t),Math.max(r,n))}return null}_isUniformVar(e){return e instanceof lh&&"uniform"==e.storage}_isStorageVar(e){return e instanceof lh&&"storage"==e.storage}_isTextureVar(e){return e instanceof lh&&null!==e.type&&-1!=Sd._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof lh&&null!==e.type&&-1!=Sd._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const r=n.attributes;for(let i of r)if(i.name==t)return i;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let r of e)if(r.name==t){let e=null!==r&&null!==r.value?r.value:n;return e instanceof Array&&(e=e[0]),"number"===typeof e?e:"string"===typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}}function Td(e){const t={attributes:[],bindings:[]};let n;try{n=function(e){try{return new Sd(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"===typeof t&&null!==t&&void 0!==t&&t.message&&(e+=": ".concat(t.message," ")),"object"===typeof t&&null!==t&&void 0!==t&&t.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(o){return ho.error(o.message)(),t}for(const a of n.uniforms){const e=[];for(const t of(null===(r=a.type)||void 0===r?void 0:r.members)||[]){var r;e.push({name:t.name,type:xd(t.type)})}t.bindings.push({type:"uniform",name:a.name,location:a.binding,group:a.group,members:e})}const i=n.entry.vertex[0],s=(null===i||void 0===i?void 0:i.inputs.length)||0;for(let a=0;a<s;a++){const e=i.inputs[a];if("location"===e.locationType){const n=xd(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:n})}}return t}function xd(e){return e.format?"".concat(e.name,"<").concat(e.format.name,">"):e.name}Sd._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Sd._textureTypes=id.any_texture_type.map((e=>e.name)),Sd._samplerTypes=id.sampler_type.map((e=>e.name));class Ad{constructor(e){s(this,"id",void 0),s(this,"userData",{}),s(this,"topology",void 0),s(this,"bufferLayout",[]),s(this,"vertexCount",void 0),s(this,"indices",void 0),s(this,"attributes",void 0),this.id=e.id||mo("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&ko(this.indices.usage===yo.INDEX)}destroy(){var e;null===(e=this.indices)||void 0===e||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(e){return e.byteLength/12}}function Rd(e,t){if(t instanceof Ad)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:yo.INDEX,data:n})}(e,t),{attributes:r,bufferLayout:i}=function(e,t){const n=[],r={};for(const[s,o]of Object.entries(t.attributes)){let t=s;switch(s){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}r[t]=e.createBuffer({data:o.value,id:"".concat(s,"-buffer")});const{value:i,size:a,normalized:l}=o;n.push({name:t,format:Ru(i,a,l)})}const i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}(e,t);return new Ad({topology:t.topology||"triangle-list",bufferLayout:i,vertexCount:t.vertexCount,indices:n,attributes:r})}class Pd{constructor(e){s(this,"modules",void 0),s(this,"moduleUniforms",void 0),s(this,"moduleBindings",void 0),s(this,"moduleUniformsChanged",void 0);const t=A(Object.values(e).filter((e=>e.dependencies)));for(const n of t)e[n.name]=n;ho.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[n,r]of Object.entries(e)){const e=n;this.moduleUniforms[e]=r.defaultUniforms||{},this.moduleBindings[e]={}}}destroy(){}setProps(e){for(const n of Object.keys(e)){var t;const r=n,i=e[r],s=this.modules[r];if(!s){ho.warn("Module ".concat(n," not found"))();continue}const o=this.moduleUniforms[r],l=this.moduleBindings[r],c=(null===(t=s.getUniforms)||void 0===t?void 0:t.call(s,i,o))||i,{uniforms:u,bindings:h}=zl(c);this.moduleUniforms[r]=a(a({},o),u),this.moduleBindings[r]=a(a({},l),h)}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[n,r]of Object.entries(this.moduleUniforms))for(const[i,s]of Object.entries(r)){var t;e["".concat(n,".").concat(i)]={type:null===(t=this.modules[n].uniformTypes)||void 0===t?void 0:t[i],value:String(s)}}return e}}class Cd extends vo{get[Symbol.toStringTag](){return"ComputePipeline"}constructor(e,t){super(e,t,Cd.defaultProps),s(this,"hash","")}}s(Cd,"defaultProps",a(a({},vo.defaultProps),{},{shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}));class kd{static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new kd(e),e._lumaData.defaultPipelineFactory}constructor(e){s(this,"device",void 0),s(this,"_hashCounter",0),s(this,"_hashes",{}),s(this,"_renderPipelineCache",{}),s(this,"_computePipelineCache",{}),this.device=e}createRenderPipeline(e){const t=a(a({},Bl.defaultProps),e),n=this._hashRenderPipeline(t);if(!this._renderPipelineCache[n]){const e=this.device.createRenderPipeline(a(a({},t),{},{id:t.id?"".concat(t.id,"-cached"):void 0}));e.hash=n,this._renderPipelineCache[n]={pipeline:e,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const t=a(a({},Cd.defaultProps),e),n=this._hashComputePipeline(t);if(!this._computePipelineCache[n]){const e=this.device.createComputePipeline(a(a({},t),{},{id:t.id?"".concat(t.id,"-cached"):void 0}));e.hash=n,this._computePipelineCache[n]={pipeline:e,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const t=e.hash,n=e instanceof Cd?this._computePipelineCache:this._renderPipelineCache;n[t].useCount--,0===n[t].useCount&&(n[t].pipeline.destroy(),delete n[t])}_hashComputePipeline(e){const t=this._getHash(e.shader.source);return"".concat(t)}_hashRenderPipeline(e){const t=this._getHash(e.vs.source),n=e.fs?this._getHash(e.fs.source):0,r=this._getHash(JSON.stringify(e.bufferLayout));if("webgl"===this.device.type)return"".concat(t,"/").concat(n,"V").concat("-","BL").concat(r);{const i=this._getHash(JSON.stringify(e.parameters));return"".concat(t,"/").concat(n,"V").concat("-","T").concat(e.topology,"P").concat(i,"BL").concat(r)}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}s(kd,"defaultProps",a({},Bl.defaultProps));class Ld{static getDefaultShaderFactory(e){var t;return(t=e._lumaData).defaultShaderFactory||(t.defaultShaderFactory=new Ld(e)),e._lumaData.defaultShaderFactory}constructor(e){s(this,"device",void 0),s(this,"_cache",{}),this.device=e}createShader(e){const t=this._hashShader(e);let n=this._cache[t];if(!n){const r=this.device.createShader(a(a({},e),{},{id:e.id?"".concat(e.id,"-cached"):void 0}));this._cache[t]=n={shader:r,useCount:0}}return n.useCount++,n.shader}release(e){const t=this._hashShader(e),n=this._cache[t];n&&(n.useCount--,0===n.useCount&&(delete this._cache[t],n.shader.destroy()))}_hashShader(e){return"".concat(e.stage,":").concat(e.source)}}s(Ld,"defaultProps",a({},kl.defaultProps));let Md=null,Id=null;class Od{constructor(e,t){var n,r,i;s(this,"device",void 0),s(this,"id",void 0),s(this,"source",void 0),s(this,"vs",void 0),s(this,"fs",void 0),s(this,"pipelineFactory",void 0),s(this,"shaderFactory",void 0),s(this,"userData",{}),s(this,"parameters",void 0),s(this,"topology",void 0),s(this,"bufferLayout",void 0),s(this,"isInstanced",void 0),s(this,"instanceCount",0),s(this,"vertexCount",void 0),s(this,"indexBuffer",null),s(this,"bufferAttributes",{}),s(this,"constantAttributes",{}),s(this,"bindings",{}),s(this,"uniforms",{}),s(this,"vertexArray",void 0),s(this,"transformFeedback",null),s(this,"pipeline",void 0),s(this,"shaderInputs",void 0),s(this,"_uniformStore",void 0),s(this,"_attributeInfos",{}),s(this,"_gpuGeometry",null),s(this,"_getModuleUniforms",void 0),s(this,"props",void 0),s(this,"_pipelineNeedsUpdate","newly created"),s(this,"_needsRedraw","initializing"),s(this,"_destroyed",!1),s(this,"_lastDrawTimestamp",-1),s(this,"_lastLogTime",0),s(this,"_logOpen",!1),s(this,"_drawCount",0),this.props=a(a({},Od.defaultProps),t),t=this.props,this.id=t.id||mo("model"),this.device=e,Object.assign(this.userData,t.userData);const o=Object.fromEntries((null===(n=this.props.modules)||void 0===n?void 0:n.map((e=>[e.name,e])))||[]);this.setShaderInputs(t.shaderInputs||new Pd(o));const l=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),c=((null===(r=this.props.modules)||void 0===r?void 0:r.length)>0?this.props.modules:null===(i=this.shaderInputs)||void 0===i?void 0:i.getModules())||[];if("webgpu"===this.device.type&&this.props.source){var u;(u=this.props).shaderLayout||(u.shaderLayout=Td(this.props.source));const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleShader(a(a({platformInfo:l},this.props),{},{modules:c}));this.source=e,this._getModuleUniforms=t}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleShaderPair(a(a({platformInfo:l},this.props),{},{modules:c}));this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||kd.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||Ld.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniforms(t.uniforms),t.moduleSettings&&this.updateModuleSettings(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),null===(e=this._gpuGeometry)||void 0===e||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){let t;this.predraw();try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),_o(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:n}=this.vertexArray,r=n?n.byteLength/("uint32"===n.indexType?4:2):void 0;t=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:r,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(e),t?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",t}setGeometry(e){var t;null===(t=this._gpuGeometry)||void 0===t||t.destroy();const n=e&&Rd(this.device,e);n&&(this.setTopology(n.topology||"triangle-list"),this.bufferLayout=Nd(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)),this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){this.bufferLayout=this._gpuGeometry?Nd(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){Qu(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new Zu(this.shaderInputs.modules);for(const t of Object.keys(this.shaderInputs.modules)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings["".concat(t,"Uniforms")]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){e.indices&&ho.warn("Model:".concat(this.id," setAttributes() - indexBuffer should be set using setIndexBuffer()"))();for(const[r,i]of Object.entries(e)){var n;const e=this.bufferLayout.find((e=>Fd(e).includes(r)));if(!e){ho.warn("Model(".concat(this.id,'): Missing layout for buffer "').concat(r,'".'))();continue}const s=Fd(e);let o=!1;for(const t of s){const e=this._attributeInfos[t];e&&(this.vertexArray.setBuffer(e.location,i),o=!0)}o||(null!==(n=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==n?n:this.props.disableWarnings)||ho.warn("Model(".concat(this.id,'): Ignoring buffer "').concat(i.id,'" for unknown attribute "').concat(r,'"'))()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[r,i]of Object.entries(e)){var n;const e=this._attributeInfos[r];e?this.vertexArray.setConstantWebGL(e.location,i):(null!==(n=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==n?n:this.props.disableWarnings)||ho.warn('Model "'.concat(this.id,': Ignoring constant supplied for unknown attribute "').concat(r,'"'))()}this.setNeedsRedraw("constants")}setUniforms(e){_o(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettings(e){const{bindings:t,uniforms:n}=zl(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof ul?e=Math.max(e,t.texture.updateTimestamp):t instanceof yo||t instanceof Xa?e=Math.max(e,t.updateTimestamp):t instanceof ll||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t=a({},e.attributes);for(const[n]of Object.entries(t))this.pipeline.shaderLayout.attributes.find((e=>e.name===n))||"positions"===n||delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(ho.log(1,"Model ".concat(this.id,': Recreating pipeline because "').concat(this._pipelineNeedsUpdate,'".'))(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:"".concat(this.id,"-vertex"),stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let r=null;this.source?r=n:this.fs&&(r=this.shaderFactory.createShader({id:"".concat(this.id,"-fragment"),stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline(a(a({},this.props),{},{bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:n,fs:r})),this._attributeInfos=Wl(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=ho.level>3?0:1e4;ho.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,ho.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:ho.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){var t;const n={},r="Values";if(0===e.attributes.length&&(null===(t=e.varyings)||void 0===t||!t.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const i of e.attributes)if(i){const e="".concat(i.location," ").concat(i.name,": ").concat(i.type);n["in ".concat(e)]={[r]:i.stepMode||"vertex"}}for(const i of e.varyings||[]){const e="".concat(i.location," ").concat(i.name);n["out ".concat(e)]={[r]:JSON.stringify(i.accessor)}}return n}(this.pipeline.shaderLayout,this.id);ho.table(2,e)();const t=this.shaderInputs.getDebugTable();for(const[r,i]of Object.entries(this.uniforms))t[r]={value:i};ho.table(2,t)();const n=this._getAttributeDebugTable();ho.table(2,this._attributeInfos)(),ho.table(2,n)(),ho.groupEnd(2)(),this._logOpen=!1}}_logFramebuffer(e){const t=ho.get("framebuffer");if(this._drawCount++,!t||this._drawCount++>3&&this._drawCount%60)return;const n=e.props.framebuffer;n&&function(e,t){let{id:n,minimap:r,opaque:i,top:s="0",left:o="0",rgbaScale:a=1}=t;Md||(Md=document.createElement("canvas"),Md.id=n,Md.title=n,Md.style.zIndex="100",Md.style.position="absolute",Md.style.top=s,Md.style.left=o,Md.style.border="blue 1px solid",Md.style.transform="scaleY(-1)",document.body.appendChild(Md),Id=Md.getContext("2d")),Md.width===e.width&&Md.height===e.height||(Md.width=e.width/2,Md.height=e.height/2,Md.style.width="400px",Md.style.height="400px");const l=e.device.readPixelsToArrayWebGL(e),c=Id.createImageData(e.width,e.height);for(let u=0;u<l.length;u+=4)c.data[0+u+0]=l[u+0]*a,c.data[0+u+1]=l[u+1]*a,c.data[0+u+2]=l[u+2]*a,c.data[0+u+3]=i?255:l[u+3]*a;Id.putImageData(c,0,0)}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos))e[n.location]={name:t,type:n.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[n.location],n.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=Au(t);return(e instanceof yo?new n(e.debugData):e).toString()}}function Nd(e,t){const n=[...e];for(const r of t){const e=n.findIndex((e=>e.name===r.name));e<0?n.push(r):n[e]=r}return n}function Fd(e){var t;return e.attributes?null===(t=e.attributes)||void 0===t?void 0:t.map((e=>e.attribute)):[e.name]}s(Od,"defaultProps",a(a({},Bl.defaultProps),{},{source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:j.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0}));class Dd{static isSupported(e){var t;return"webgl"===(null===e||void 0===e||null===(t=e.info)||void 0===t?void 0:t.type)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Od.defaultProps;s(this,"device",void 0),s(this,"model",void 0),s(this,"transformFeedback",void 0),ko(Dd.isSupported(e),"BufferTransform not yet implemented on WebGPU"),this.device=e,this.model=new Od(this.device,a({id:t.id||"buffer-transform-model",fs:t.fs||Wu(),topology:t.topology||"point-list"},t)),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}update(){console.warn("TextureTransform#update() not implemented")}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(t instanceof yo)return t.readAsync();const{buffer:n,byteOffset:r=0,byteLength:i=n.byteLength}=t;return n.readAsync(r,i)}}function Bd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.fround(e),i=e-r;return t[n]=r,t[n+1]=i,t}function Ud(e){return e-Math.fround(e)}function zd(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;Bd(e[4*r+n],t,2*i)}return t}const Gd={ONE:1};const jd={name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\nconst float SPLIT = 4097.0;\nfloat t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat a_hi = t * ONE - (t - a);\nfloat a_lo = a * ONE - a_hi;\n#else\nfloat a_hi = t - (t - a);\nfloat a_lo = a - a_hi;\n#endif\nreturn vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\nvec2 b = split(a.x);\nb.y += a.y;\nreturn b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat sum = (a + b) * ONE;\nfloat err = b - (sum - a) * ONE;\n#else\nfloat sum = a + b;\nfloat err = b - (sum - a);\n#endif\nreturn vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\nfloat s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat v = (s * ONE - a) * ONE;\nfloat err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\nfloat v = s - a;\nfloat err = (a - (s - v)) + (b - v);\n#endif\nreturn vec2(s, err);\n}\nvec2 twoSub(float a, float b) {\nfloat s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat v = (s * ONE - a) * ONE;\nfloat err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\nfloat v = s - a;\nfloat err = (a - (s - v)) - (b + v);\n#endif\nreturn vec2(s, err);\n}\nvec2 twoSqr(float a) {\nfloat prod = a * a;\nvec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nfloat err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\na_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\nfloat err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\nreturn vec2(prod, err);\n}\nvec2 twoProd(float a, float b) {\nfloat prod = a * b;\nvec2 a_fp64 = split(a);\nvec2 b_fp64 = split(b);\nfloat err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\na_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\nreturn vec2(prod, err);\n}\nvec2 sum_fp64(vec2 a, vec2 b) {\nvec2 s, t;\ns = twoSum(a.x, b.x);\nt = twoSum(a.y, b.y);\ns.y += t.x;\ns = quickTwoSum(s.x, s.y);\ns.y += t.y;\ns = quickTwoSum(s.x, s.y);\nreturn s;\n}\nvec2 sub_fp64(vec2 a, vec2 b) {\nvec2 s, t;\ns = twoSub(a.x, b.x);\nt = twoSub(a.y, b.y);\ns.y += t.x;\ns = quickTwoSum(s.x, s.y);\ns.y += t.y;\ns = quickTwoSum(s.x, s.y);\nreturn s;\n}\nvec2 mul_fp64(vec2 a, vec2 b) {\nvec2 prod = twoProd(a.x, b.x);\nprod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nprod = split2(prod);\n#endif\nprod = quickTwoSum(prod.x, prod.y);\nprod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nprod = split2(prod);\n#endif\nprod = quickTwoSum(prod.x, prod.y);\nreturn prod;\n}\nvec2 div_fp64(vec2 a, vec2 b) {\nfloat xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nvec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\nvec2 yn = a * xn;\n#endif\nfloat diff = (sub_fp64(a, mul_fp64(b, yn))).x;\nvec2 prod = twoProd(xn, diff);\nreturn sum_fp64(yn, prod);\n}\nvec2 sqrt_fp64(vec2 a) {\nif (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\nif (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\nfloat x = 1.0 / sqrt(a.x);\nfloat yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\nvec2 yn_sqr = twoSqr(yn) * ONE;\n#else\nvec2 yn_sqr = twoSqr(yn);\n#endif\nfloat diff = sub_fp64(a, yn_sqr).x;\nvec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\nreturn sum_fp64(split(yn), prod);\n#else\nreturn sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",getUniforms:function(){return Gd},fp64ify:Bd,fp64LowPart:Ud,fp64ifyMatrix4:zd};function Vd(e){const{source:t,target:n,start:r=0,size:i,getData:s}=e,o=e.end||n.length,a=t.length,l=o-r;if(a>l)return void n.set(t.subarray(0,l),r);if(n.set(t,r),!s)return;let c=a;for(;c<l;){const e=s(c,t);for(let t=0;t<i;t++)n[r+c]=e[t]||0,c++}}function Wd(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function Hd(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function Xd(e){e.push(e.shift())}function qd(e){let{device:t,source:n,target:r}=e;var i;(!r||r.byteLength<n.byteLength)&&(null===(i=r)||void 0===i||i.destroy(),r=t.createBuffer({byteLength:n.byteLength,usage:n.usage}));return r}function Kd(e){let{device:t,buffer:n,attribute:r,fromLength:i,toLength:s,fromStartIndices:o,getData:a=e=>e}=e;const l=r.doublePrecision&&r.value instanceof Float64Array?2:1,c=r.size*l,u=r.byteOffset,h=r.settings.bytesPerElement<4?u/r.settings.bytesPerElement*4:u,d=r.startIndices,f=o&&d,p=r.isConstant;if(!f&&n&&i>=s)return n;const g=r.value instanceof Float64Array?Float32Array:r.value.constructor,m=p?r.value:new g(r.getBuffer().readSyncWebGL(u,s*g.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!p){const e=a;a=(t,n)=>r.normalizeConstant(e(t,n))}const _=p?(e,t)=>a(m,t):(e,t)=>a(m.subarray(e+u,e+u+c),t),v=n?new Float32Array(n.readSyncWebGL(h,4*i).buffer):new Float32Array(0),y=new Float32Array(s);var b;(function(e){let{source:t,target:n,size:r,getData:i,sourceStartIndices:s,targetStartIndices:o}=e;if(!s||!o)return Vd({source:t,target:n,size:r,getData:i}),n;let a=0,l=0;const c=i&&((e,t)=>i(e+l,t)),u=Math.min(s.length,o.length);for(let h=1;h<u;h++){const e=s[h]*r,i=o[h]*r;Vd({source:t.subarray(a,e),target:n,start:l,end:i,size:r,getData:c}),a=e,l=i}l<n.length&&Vd({source:[],target:n,start:l,size:r,getData:c})}({source:v,target:y,sourceStartIndices:o,targetStartIndices:d,size:c,getData:_}),!n||n.byteLength<y.byteLength+h)&&(null===(b=n)||void 0===b||b.destroy(),n=t.createBuffer({byteLength:y.byteLength+h,usage:35050}));return n.write(y,h),n}class Yd{constructor(e){let{device:t,attribute:n,timeline:r}=e;this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Ai(r),this.attribute=n,this.attributeInTransition=function(e){const{device:t,settings:n,value:r}=e,i=new ju(t,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(e,t){const{doublePrecision:n,settings:r,value:i,size:s}=e,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=e.settings;if(l)for(const u of Object.values(l)){var c;a=Math.max(a,null!==(c=u.vertexOffset)&&void 0!==c?c:0)}return(r.noAlloc?i.length:(t+a)*s)*o}(this.attribute,t),this.transition.start(a(a({},e),{},{duration:n}))}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}const Zd="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",Qd="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function $d(e){return e.doublePrecision&&e.value instanceof Float64Array}const Jd="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",ef="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const tf={interpolation:class extends Yd{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="interpolation",this.transform=function(e,t){const n=t.size,r=Wd(n),i=Hd(n),s=t.getBufferLayout();if($d(t))return new Dd(e,{vs:Qd,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[jd],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new Dd(e,{vs:Zd,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:i,attribute:s}=this;Xd(i),i[0]=Kd({device:this.device,buffer:i[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),i[1]=qd({device:this.device,source:i[0],target:i[1]}),this.setBuffer(i[1]);const{transform:o}=this,a=o.model;let l=Math.floor(this.currentLength/s.size);$d(s)&&(l/=2),a.setVertexCount(l),s.isConstant?(a.setAttributes({aFrom:i[0]}),a.setConstantAttributes({aTo:s.value})):a.setAttributes({aFrom:i[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:i[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r));const{model:i}=this.transform;i.setUniforms({time:r}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends Yd{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}(t),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(t,this.texture),this.transform=function(e,t){const n=Wd(t.size),r=Hd(t.size);return new Dd(e,{vs:Jd,fs:ef,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:i,attribute:s}=this;for(let a=0;a<2;a++)i[a]=Kd({device:this.device,buffer:i[a],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});i[2]=qd({device:this.device,source:i[0],target:i[2]}),this.setBuffer(i[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this,i=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]}),t.model.setUniforms({stiffness:i.stiffness,damping:i.damping}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),Xd(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class nf{constructor(e,t){let{id:n,timeline:r}=t;if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:r}=e;this.numInstances=r||1;for(const i in t){const e=t[i],r=e.getTransitionSetting(n);r&&this._updateAttribute(i,e,r)}for(const i in this.transitions){const e=t[i];e&&e.getTransitionSetting(n)||this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let i=!r||r.type!==n.type;if(i){r&&this._removeTransition(e);const s=tf[n.type];s?this.transitions[e]=new s({attribute:t,timeline:this.timeline,device:this.device}):(de.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const rf="attributeManager.invalidate";class sf{constructor(e){let{id:t="attribute-manager",stats:n,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mergeBoundsMemoized=Ie(Tr),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new nf(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);ot(rf,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);ot(rf,this,"all")}update(e){let{data:t,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}=e,l=!1;ot("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const e=this.attributes[c],i=e.settings.accessor;e.startIndices=r,e.numInstances=n,s[c]&&de.removed("props.".concat(c),"data.attributes.".concat(c))(),e.setExternalBuffer(o[c])||e.setBinaryValue("string"===typeof i?o[i]:void 0,t.startIndices)||"string"===typeof i&&!o[i]&&e.setConstantValue(s[i])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:n,data:t,props:s,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&ot("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return a(a({},this.attributes),this.attributeTransitionManager.getAttributes())}getBounds(e){const t=e.map((e=>{var t;return null===(t=this.attributes[e])||void 0===t?void 0:t.getBounds()}));return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,r=a({},n.getAttributes());for(const i in t){const s=t[i];s.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=s)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map((t=>t.getBufferLayout(e)))}_add(e,t){for(const n in e){const r=e[n],i=a(a({},r),{},{id:n,size:(r.isIndexed?1:r.size)||1},t);this.attributes[n]=new ju(this.device,i)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)}))}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,i=r[e];return i&&i.forEach((e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)})),i}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(ot("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&ot("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,ot("attribute.updateEnd",t,n))}}const of=1e-5;function af(e,t,n,r,i){const s=t-e;return(n-t)*i+-s*r+s+t}function lf(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}const cf={interpolation:class extends Ai{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:i}}=this,s=i(e/r);this._value=sr(t,n,s)}},spring:class extends Ai{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:i=e,_currValue:s=e}=this;let o=function(e,t,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=af(e[o],t[o],n[o],r,i);return s}return af(e,t,n,r,i)}(i,s,t,n,r);const a=lf(o,t),l=lf(o,s);a<of&&l<of&&(o=t,this.end()),this._prevValue=s,this._currValue=o}}};class uf{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=Gu(r)))return;const s=cf[r.type];if(!s)return void de.error("unsupported transition type '".concat(r.type,"'"))();const o=new s(this.timeline);o.start(a(a({},r),{},{fromValue:t,toValue:n})),i.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function hf(e,t){const n=ff({newProps:e,oldProps:t,propTypes:e[Je],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&i&&(n=i(e.data,t.data)||n);return n}(e,t);let i=!1;return r||(i=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(mf(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const i in e.updateTriggers)if("all"!==i){mf(e,t,i)&&(n[i]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:gf(e,t),transitionsChanged:df(e,t)}}function df(e,t){if(!e.transitions)return!1;const n={},r=e[Je];let i=!1;for(const s in e.transitions){const o=r[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&pf(e[s],t[s],o)&&(n[s]=!0,i=!0)}return!!i&&n}function ff(e){let{newProps:t,oldProps:n,ignoreProps:r={},propTypes:i={},triggerName:s="props"}=e;if(n===t)return!1;if("object"!==typeof t||null===t)return"".concat(s," changed shallowly");if("object"!==typeof n||null===n)return"".concat(s," changed shallowly");for(const o of Object.keys(t))if(!(o in r)){if(!(o in n))return"".concat(s,".").concat(o," added");const e=pf(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}for(const o of Object.keys(n))if(!(o in r)){if(!(o in t))return"".concat(s,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const e=pf(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}}return!1}function pf(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function gf(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function mf(e,t,n){let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;return ff({oldProps:i,newProps:r,triggerName:n})}function _f(e){if(null===(t=e)||"object"!==typeof t)throw new Error("count(): argument not an object");var t;if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function vf(e,t){if(!t)return e;const n=a(a({},e),t);if("defines"in t&&(n.defines=a(a({},e.defines),t.defines)),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some((e=>"project64"===e.name)))){const e=n.modules.findIndex((e=>"project32"===e.name));e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r=a({},e.inject);for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}const yf=[0,0,0];function bf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.projectPosition(e);if(n&&t instanceof xi){const[n,i,s=0]=e,o=t.getDistanceScales([n,i]);r[2]=s*o.unitsPerMeter[2]}return r}function Ef(e,t){let{viewport:n,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:o}=t,[a,l,c=0]=e;switch(r&&([a,l,c]=Se([],[a,l,c,1],r)),i){case fe.LNGLAT:return bf([a,l,c],n,o);case fe.LNGLAT_OFFSETS:return bf([a+s[0],l+s[1],c+(s[2]||0)],n,o);case fe.METER_OFFSETS:return bf(ni(s,[a,l,c]),n,o);case fe.CARTESIAN:default:return n.isGeospatial?[a+s[0],l+s[1],c+s[2]]:n.projectPosition([a,l,c])}}function wf(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:r}=e;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=e;return i===fe.DEFAULT&&(i=t.isGeospatial?fe.LNGLAT:fe.CARTESIAN),void 0===s&&(s=i),void 0===o&&(o=r),{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=yf,shaderCoordinateOrigin:u=yf,offsetMode:h=!1}=l?ze(n,r,i):{},d=Ef(e,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const e=n.projectPosition(c||u);gr(d,d,e)}return d}const Sf={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Tf={};const xf={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||Pf(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>vi(e,t,1)},accessor:{validate(e,t){const n=Cf(e);return"function"===n||n===Cf(t.value)},equal:(e,t,n)=>"function"===typeof t||vi(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||Pf(e),equal(e,t,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?vi(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?vi(e,t,i):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:r}=n.props;return r?r(e):"string"===typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const r=n.context;return r&&r.device?function(e,t,n,r){if(n instanceof Xa)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=t.createTexture(a(a({},n),{},{sampler:a(a(a({},Sf),i),r)}));return Tf[s.id]=e,s}(n.id,r.device,e,a(a({},t.parameters),n.props.textureParameters)):null},release:(e,t,n)=>{var r,i;r=n.id,(i=e)&&i instanceof Xa&&Tf[i.id]===r&&(i.delete(),delete Tf[i.id])}}};function Af(e,t){switch(Cf(t)){case"object":return Rf(e,t);case"array":return Rf(e,{type:"array",value:t,compare:!1});case"boolean":return Rf(e,{type:"boolean",value:t});case"number":return Rf(e,{type:"number",value:t});case"function":return Rf(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function Rf(e,t){return"type"in t?a(a({name:e},xf[t.type]),t):"value"in t?a({name:e,type:Cf(t.value)},t):{name:e,type:"object",value:t}}function Pf(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function Cf(e){return Pf(e)?"array":null===e?"null":typeof e}const kf="_mergedDefaultProps";function Lf(e,t){if(!(e instanceof Df.constructor))return{};let n=kf;if(t)for(const i of t){const e=i.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const r=Of(e,n);return r||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const r=Object.getPrototypeOf(e),i=Lf(r),s=Of(e,"defaultProps")||{},o=function(e){const t={},n={},r={};for(const[i,s]of Object.entries(e)){const e=null===s||void 0===s?void 0:s.deprecatedFor;if(e)r[i]=Array.isArray(e)?e:[e];else{const e=Af(i,s);t[i]=e,n[i]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[Je],o.propTypes),c=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[et],o.deprecatedProps);for(const u of t){const e=Lf(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[Je]),Object.assign(c,e[et]))}(function(e,t){const n=function(e){const t=e.componentName;t||de.warn("".concat(e.name,".componentName not specified"))();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},r={};for(const i in t){const e=t[i],{name:s,value:o}=e;e.async&&(n[s]=o,r[s]=Mf(s))}e[tt]=n,e[nt]={},Object.defineProperties(e,r)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r="".concat(this.id,": ").concat(n);for(const i of t[n])If(this,i)||(this[i]=e);de.deprecated(r,t[n].join("/"))()}})}(a,c),a[Je]=l,a[et]=c,0!==t.length||If(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function Mf(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||Fu(t)?this[nt][e]=t:this[rt][e]=t},get(){if(this[rt]){if(e in this[rt]){return this[rt][e]||this[tt][e]}if(e in this[nt]){const t=this[$e]&&this[$e].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[tt][e]}}return this[tt][e]}}}function If(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Of(e,t){return If(e,t)&&e[t]}let Nf=0;class Ff{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=function(e,t){let n;for(let s=t.length-1;s>=0;s--){const e=t[s];"extensions"in e&&(n=e.extensions)}const r=Lf(e.constructor,n),i=Object.create(r);i[$e]=e,i[nt]={},i[rt]={};for(let s=0;s<t.length;++s){const e=t[s];for(const t in e)i[t]=e[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=Nf++}clone(e){const{props:t}=this,n={};for(const r in t[tt])r in t[rt]?n[r]=t[rt][r]:r in t[nt]&&(n[r]=t[nt][r]);return new this.constructor(a(a(a({},t),n),e))}}Ff.componentName="Component",Ff.defaultProps={};const Df=Ff,Bf=Object.freeze({});class Uf{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Bf}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[$e]||this.component;const t=e[rt]||{},n=e[nt]||e,r=e[tt]||{};for(const i in t){const e=t[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e),t[i]=this.getAsyncProp(i)}for(const i in n){const e=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):Fu(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then((t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))})).catch((t=>{this._onError(e,t)}))}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let i=[],s=0;var o,a=!1,l=!1;try{for(var c,u=yn(t);a=!(c=await u.next()).done;a=!1){const t=c.value;{if(!this.component)return;const{dataTransform:n}=this.component.props;i=n?n(t,i):i.concat(t),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:s,endRow:i.length}]}),s=i.length,this._setAsyncPropValue(e,i,r)}}}catch(Zm){l=!0,o=Zm}finally{try{a&&null!=u.return&&await u.return()}finally{if(l)throw o}}this._onResolve(e,i)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[Je];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class zf extends Uf{constructor(e){let{attributeManager:t,layer:n}=e;super(n),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=null===n||void 0===n?void 0:n.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const Gf=2**24-1,jf=Object.freeze([]),Vf=Ie((e=>{let{oldViewport:t,viewport:n}=e;return t.equals(n)}));let Wf=new Uint8ClampedArray(0);const Hf={data:{type:"data",value:jf,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:n,layer:r,loaders:i,loadOptions:s,signal:o}=t;const{resourceManager:l}=r.context;var c;(s=s||r.getLoadOptions(),i=i||r.props.loaders,o)&&(s=a(a({},s),{},{fetch:a(a({},null===(c=s)||void 0===c?void 0:c.fetch),{},{signal:o})}));let u=l.contains(e);return u||s||(l.add({resourceId:e,data:Qn(e,i),persistent:!1}),u=!0),u?l.subscribe({resourceId:e,onChange:e=>{var t;return null===(t=r.internalState)||void 0===t?void 0:t.reloadAsyncProp(n,e)},consumerId:r.id,requestId:n}):Qn(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:fe.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Xf extends Df{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Xe,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ii(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=Ef(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,s]=oi(n,t.pixelProjectionMatrix);return 2===e.length?[r,i]:[r,i,s]}unproject(e){Ii(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Ii(this.internalState);return wf(e,a({viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem},t))}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}setShaderModuleProps(){for(const e of this.getModels())e.shaderInputs.setProps(...arguments)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===fe.DEFAULT||e===fe.LNGLAT||e===fe.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Ii(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:_f(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=vf(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=vf(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,i=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((e=>e.getNeedsPickingBuffer.call(this,e)));if(r!==i){this.internalState.hasPickingBuffer=i;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(i&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||i||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:r}=e;const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(e,t){var n,r,i,s;(t&&(e=new Error("".concat(t,": ").concat(e.message),{cause:e})),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,e))||(null===(i=this.context)||void 0===i||null===(s=i.onError)||void 0===s||s.call(i,e,this))}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&Vf({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const r=Math.floor(Wf.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>Gf&&de.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Wf=er.allocate(Wf,n,{size:4,copy:!0,maxCount:Math.max(n,Gf)});const e=Math.floor(Wf.length/4),t=[];for(let n=r;n<e;n++)this.encodePickingColor(n,t),Wf[4*n+0]=t[0],Wf[4*n+1]=t[1],Wf[4*n+2]=t[2]}e.value=Wf.subarray(0,4*n)}_setModelAttributes(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Object.keys(t).length)return;if(r){const n=this.getAttributeManager();e.setBufferLayout(n.getBufferLayouts(e)),t=n.getAttributes()}const i=(null===(n=e.userData)||void 0===n?void 0:n.excludeAttributes)||{},s={},o={};for(const a in t){if(i[a])continue;const n=t[a].getValue();for(const r in n){const i=n[r];i instanceof yo?t[a].settings.isIndexed?e.setIndexBuffer(i):s[r]=i:i&&(o[r]=i)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r,s=i&&t.attributes&&t.attributes[i.id];if(s&&s.value){const n=s.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=i.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const i=r.getVertexOffset(e),s=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(s-i),i)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Wf.buffer&&(n.value=Wf.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ii(!this.internalState),Ii(Number.isFinite(this.props.coordinateSystem)),ot("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new zf({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(de.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new uf(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ot("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ot("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,i=n.viewport,s=this._updateUniformTransition();r.propsInTransition=s,n.viewport=r.viewport||i,this.props=s;try{const e=this._getUpdateParams(),t=this.getModels();if(n.device)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const n of this.props.extensions)n.updateState.call(this,e,n);const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=i,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){ot("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{renderPass:t,moduleParameters:n=null,uniforms:r={},parameters:i={}}=e;this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;const a=this.props.opacity;r.opacity=Math.pow(a,1/2.2);try{if(n){const{isActive:e,isAttribute:t}=n.picking;this.setModuleParameters(n),this.setShaderModuleProps({picking:{isActive:e,isAttribute:t}})}const{getPolygonOffset:e}=this.props,s=e&&e(r)||[0,0];o.device.setParametersWebGL({polygonOffset:s});for(const t of this.getModels())t.setParameters(i);o.device.withParametersWebGL(i,(()=>{const e={renderPass:t,moduleParameters:n,uniforms:r,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}))}finally{this.props=s}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const i=e[r],s=t[r];i&&Array.isArray(s)&&(t.dataChanged=Array.isArray(i)?s.concat(i):i,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&ot("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=hf(e,t);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged){var r;this.internalState.uniformTransitions.add(i,t[i],e[i],null===(r=e.transitions)||void 0===r?void 0:r[i])}return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[Je];for(const n in t){const r=t[n],{validate:i}=r;if(i&&!i(e[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"===typeof n&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new sf(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const i=this.state.model;null!==i&&void 0!==i&&i.isInstanced&&i.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=n;if(t||r.autoHighlight!==s||r.highlightedObjectIndex!==o||r.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||r.autoHighlight!==s||o!==r.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Xf.defaultProps=Hf,Xf.layerName="Layer";const qf=Xf,Kf={position:"absolute",zIndex:-1};function Yf(t,n){if("function"===typeof t)return t(n);if(Array.isArray(t))return t.map((e=>Yf(e,n)));if(Zf(t)){if(function(e){var t;return null===(t=e.props)||void 0===t?void 0:t.mapStyle}(t))return n.style=Kf,(0,e.cloneElement)(t,n);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(t))return(0,e.cloneElement)(t,n)}return t}function Zf(e){return e&&"object"===typeof e&&"type"in e||!1}function Qf(t){if("function"===typeof t)return(0,e.createElement)(Si,{},t);if(Array.isArray(t))return t.map(Qf);if(Zf(t)){if(t.type===e.Fragment)return Qf(t.props.children);if(Tu(t.type,Si))return t}return t}const $f={mixBlendMode:null};function Jf(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const ep=e.forwardRef((function(t,n){const[r,i]=(0,e.useState)(0),s=(0,e.useRef)({control:null,version:r,forceUpdate:()=>i((e=>e+1))}).current,o=(0,e.useRef)(null),l=(0,e.useRef)(null),c=(0,e.useMemo)((()=>function(t){let{children:n,layers:r=[],views:i=null}=t;const s=[],o=[],a={};return e.Children.forEach(Qf(n),(e=>{if(Zf(e)){const t=e.type;if(Tu(t,qf)){const n=function(e,t){const n={},r=e.defaultProps||{};for(const i in t)r[i]!==t[i]&&(n[i]=t[i]);return new e(n)}(t,e.props);o.push(n)}else s.push(e);if(Tu(t,Si)&&t!==Si&&e.props.id){const n=new t(e.props);a[n.id]=n}}else e&&s.push(e)})),Object.keys(a).length>0&&(Array.isArray(i)?i.forEach((e=>{a[e.id]=e})):i&&(a[i.id]=i),i=Object.values(a)),r=o.length>0?[...o,...r]:r,{layers:r,children:s,views:i}}(t)),[t.layers,t.views,t.children]);let u=!0;const h=e=>{var n;return u&&t.viewState?(s.viewStateUpdateRequested=e,null):(s.viewStateUpdateRequested=null,null===(n=t.onViewStateChange)||void 0===n?void 0:n.call(t,e))},d=e=>{var n;u?s.interactionStateUpdateRequested=e:(s.interactionStateUpdateRequested=null,null===(n=t.onInteractionStateChange)||void 0===n||n.call(t,e))},f=(0,e.useMemo)((()=>{const e=a(a({},t),{},{style:null,width:"100%",height:"100%",parent:o.current,canvas:l.current,layers:c.layers,views:c.views,onViewStateChange:h,onInteractionStateChange:d});return delete e._customRender,s.deck&&s.deck.setProps(e),e}),[t]);(0,e.useEffect)((()=>{const e=t.Deck||wu;return s.deck=function(e,t,n){const r=new t(a(a({},n),{},{_customRender:t=>{e.redrawReason=t;const n=r.getViewports();e.lastRenderedViewports!==n?e.forceUpdate():Jf(e)}}));return r}(s,e,a(a({},f),{},{parent:o.current,canvas:l.current})),()=>{var e;return null===(e=s.deck)||void 0===e?void 0:e.finalize()}}),[]),Su((()=>{Jf(s);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=s;e&&h(e),t&&d(t)})),(0,e.useImperativeHandle)(n,(()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(s)),[]);const p=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:g,width:m="100%",height:_="100%",id:v,style:y}=t,{containerStyle:b,canvasStyle:E}=(0,e.useMemo)((()=>function(e){let{width:t,height:n,style:r}=e;const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:n},s={left:0,top:0};if(r)for(const o in r)o in $f?s[o]=r[o]:i[o]=r[o];return{containerStyle:i,canvasStyle:s}}({width:m,height:_,style:y})),[m,_,y]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===p||s.version!==r){s.lastRenderedViewports=p,s.version=r;const t=function(t){let{children:n,deck:r,ContextProvider:i}=t;const{viewManager:s}=r||{};if(!s||!s.views.length)return[];const o={},a=s.views[0].id;for(const e of n){let t=a,n=e;Zf(e)&&Tu(e.type,Si)&&(t=e.props.id||a,n=e.props.children);const r=s.getViewport(t),i=s.getViewState(t);if(r){i.padding=r.padding;const{x:e,y:s,width:a,height:l}=r;n=Yf(n,{x:e,y:s,width:a,height:l,viewport:r,viewState:i}),o[t]||(o[t]={viewport:r,children:[]}),o[t].children.push(n)}}return Object.keys(o).map((t=>{const{viewport:n,children:s}=o[t],{x:a,y:l,width:c,height:u}=n,h={position:"absolute",left:a,top:l,width:c,height:u},d="view-".concat(t),f=(0,e.createElement)("div",{key:d,id:d,style:h},...s);if(i){const s={viewport:n,container:r.canvas.offsetParent,eventManager:r.eventManager,onViewStateChange:e=>{e.viewId=t,r._onViewStateChange(e)}};return(0,e.createElement)(i,{key:d,value:s},f)}return f}))}({children:c.children,deck:s.deck,ContextProvider:g}),n=(0,e.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:l,style:E});s.control=(0,e.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:o,style:b},[n,t])}return u=!1,s.control})),tp=ep,np=e.createContext(null);function rp(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!rp(e[n],t[n]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n){if(!t.hasOwnProperty(i))return!1;if(!rp(e[i],t[i]))return!1}return!0}return!1}function ip(e,t){if(!e.getProjection)return;const n=e.getProjection();rp(n,t.getProjection())||t.setProjection(n)}function sp(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function op(e,t){const n=t.viewState||t;let r=!1;if("zoom"in n){const t=e.zoom;e.zoom=n.zoom,r=r||t!==e.zoom}if("bearing"in n){const t=e.bearing;e.bearing=n.bearing,r=r||t!==e.bearing}if("pitch"in n){const t=e.pitch;e.pitch=n.pitch,r=r||t!==e.pitch}if(n.padding&&!e.isPaddingEqual(n.padding)&&(r=!0,e.padding=n.padding),"longitude"in n&&"latitude"in n){const t=e.center;e.center=new t.constructor(n.longitude,n.latitude),r=r||t!==e.center}return r}const ap=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function lp(e){if(!e)return null;if("string"===typeof e)return e;if("toJS"in e&&(e=e.toJS()),!e.layers)return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map((e=>{let n=null;"interactive"in e&&(n=Object.assign({},e),delete n.interactive);const r=t[e.ref];if(r){n=n||Object.assign({},e),delete n.ref;for(const e of ap)e in r&&(n[e]=r[e])}return n||e}));return a(a({},e),{},{layers:n})}const cp={version:8,sources:{},layers:[]},up={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},hp={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},dp={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},fp=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],pp=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class gp{constructor(e,t,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{const t=this.props[dp[e.type]];t?t(e):"error"===e.type&&console.error(e.error)},this._onPointerEvent=e=>{"mousemove"!==e.type&&"mouseout"!==e.type||this._updateHover(e);const t=this.props[up[e.type]];t&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),t(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){const t=this.props[hp[e.type]];t&&t(e)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=t,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const n=this._updateSettings(e,t);n&&this._createShadowTransform(this._map);const r=this._updateSize(e),i=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(n||r||i&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const n=gp.savedMaps.pop();if(!n)return null;const r=n.map,i=r.getContainer();for(t.className=i.className;i.childNodes.length>0;)t.appendChild(i.childNodes[0]);r._container=t;const s=r._resizeObserver;s&&(s.disconnect(),s.observe(t)),n.setProps(a(a({},e),{},{styleDiffing:!1})),r.resize();const{initialViewState:o}=e;return o&&(o.bounds?r.fitBounds(o.bounds,a(a({},o.fitBoundsOptions),{},{duration:0})):n._updateViewState(o,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",(()=>r.fire("load"))),r._update(),n}_initialize(e){const{props:t}=this,{mapStyle:n=cp}=t,r=a(a(a({},t),t.initialViewState),{},{accessToken:t.mapboxAccessToken||mp()||null,container:e,style:lp(n)}),i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),t.gl){const e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),t.cursor&&(s.getCanvas().style.cursor=t.cursor),this._createShadowTransform(s);const o=s._render;s._render=e=>{this._inRender=!0,o.call(s,e),this._inRender=!1};const l=s._renderTaskQueue.run;s._renderTaskQueue.run=e=>{l.call(s._renderTaskQueue,e),this._onBeforeRepaint()},s.on("render",(()=>this._onAfterRepaint()));const c=s.fire;s.fire=this._fireEvent.bind(this,c),s.on("resize",(()=>{this._renderTransform.resize(s.transform.width,s.transform.height)})),s.on("styledata",(()=>{this._updateStyleComponents(this.props,{}),ip(s.transform,this._renderTransform)})),s.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const a in up)s.on(a,this._onPointerEvent);for(const a in hp)s.on(a,this._onCameraEvent);for(const a in dp)s.on(a,this._onEvent);this._map=s}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");null===e||void 0===e||e.remove(),gp.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=function(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const e=this._map;if(t.width!==e.transform.width||t.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const n=this._map,r=this._renderTransform,{zoom:i,pitch:s,bearing:o}=r,l=n.isMoving();l&&(r.cameraElevationReference="sea");const c=op(r,a(a({},sp(n.transform)),e));if(l&&(r.cameraElevationReference="ground"),c&&t){const e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=i!==r.zoom),e.rotate||(e.rotate=o!==r.bearing),e.pitch||(e.pitch=s!==r.pitch)}return l||op(n.transform,e),c}_updateSettings(e,t){const n=this._map;let r=!1;for(const i of fp)if(i in e&&!rp(e[i],t[i])){r=!0;const t=n["set".concat(i[0].toUpperCase()).concat(i.slice(1))];null===t||void 0===t||t.call(n,e[i])}return r}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:t=cp,styleDiffing:n=!0}=e,r={diff:n};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(lp(t),r),!0}return!1}_updateStyleComponents(e,t){const n=this._map;let r=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!rp(e.light,t.light)&&(r=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!rp(e.fog,t.fog)&&(r=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!rp(e.terrain,t.terrain)&&(e.terrain&&!n.getSource(e.terrain.source)||(r=!0,n.setTerrain(e.terrain)))),r}_updateHandlers(e,t){var n,r;const i=this._map;let s=!1;for(const o of pp){const a=null===(n=e[o])||void 0===n||n;rp(a,null===(r=t[o])||void 0===r||r)||(s=!0,a?i[o].enable(a):i[o].disable())}return s}_queryRenderedFeatures(e){const t=this._map,n=t.transform,{interactiveLayerIds:r=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:r.filter(t.getLayer.bind(t))})}catch(ph){return[]}finally{t.transform=n}}_updateHover(e){var t;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const n=e.type,r=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0,i=this._queryRenderedFeatures(e.point),s=i.length>0;!s&&r&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=i,s&&!r&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=n}else this._hoveredFeatures=null}_fireEvent(e,t,n){const r=this._map,i=r.transform,s="string"===typeof t?t:t.type;return"move"===s&&this._updateViewState(this.props,!1),s in hp&&("object"===typeof t&&(t.viewState=sp(i)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,t,n),r.transform=i,r):(e.call(r,t,n),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{ip(this._renderTransform,t),e.transform=t}}}function mp(){let e=null;if("undefined"!==typeof location){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/my-map-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken}catch(ph){}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/my-map-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(t){}return e}gp.savedMaps=[];const _p=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function vp(e){if(!e)return null;const t=e.map,n={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>{const r=t.transform;t.transform=e.transform;const i=t.project(n);return t.transform=r,i},unproject:n=>{const r=t.transform;t.transform=e.transform;const i=t.unproject(n);return t.transform=r,i},queryTerrainElevation:(n,r)=>{const i=t.transform;t.transform=e.transform;const s=t.queryTerrainElevation(n,r);return t.transform=i,s},queryRenderedFeatures:(n,r)=>{const i=t.transform;t.transform=e.transform;const s=t.queryRenderedFeatures(n,r);return t.transform=i,s}};for(const r of function(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))"_"!==r[0]&&"function"===typeof e[r]&&"fire"!==r&&"setEventedParent"!==r&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}(t))r in n||_p.includes(r)||(n[r]=t[r].bind(t));return n}const yp="undefined"!==typeof document?e.useLayoutEffect:e.useEffect,bp=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const Ep=e.createContext(null);function wp(t,n,r){const i=(0,e.useContext)(np),[s,o]=(0,e.useState)(null),l=(0,e.useRef)(),{current:c}=(0,e.useRef)({mapLib:null,map:null});(0,e.useEffect)((()=>{const e=t.mapLib;let n,s=!0;return Promise.resolve(e||r).then((e=>{if(!s)return;if(!e)throw new Error("Invalid mapLib");const r="Map"in e?e:e.default;if(!r.Map)throw new Error("Invalid mapLib");if(function(e,t){for(const r of bp)r in t&&(e[r]=t[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;n&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(n,(e=>{e&&console.error(e)}),!0)}(r,t),r.supported&&!r.supported(t))throw new Error("Map is not supported by this browser");t.reuseMaps&&(n=gp.reuse(t,l.current)),n||(n=new gp(r.Map,t,l.current)),c.map=vp(n),c.mapLib=r,o(n),null===i||void 0===i||i.onMapMount(c.map,t.id)})).catch((e=>{const{onError:n}=t;n?n({type:"error",target:null,originalEvent:null,error:e}):console.error(e)})),()=>{s=!1,n&&(null===i||void 0===i||i.onMapUnmount(t.id),t.reuseMaps?n.recycle():n.destroy())}}),[]),yp((()=>{s&&s.setProps(t)})),(0,e.useImperativeHandle)(n,(()=>c.map),[s]);const u=(0,e.useMemo)((()=>a({position:"relative",width:"100%",height:"100%"},t.style)),[t.style]);return e.createElement("div",{id:t.id,ref:l,style:u},s&&e.createElement(Ep.Provider,{value:c},e.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},t.children)))}var Sp=n(950);const Tp=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function xp(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const e=t[r];Number.isFinite(e)&&!Tp.test(r)?n[r]="".concat(e,"px"):n[r]=e}}(0,e.memo)((0,e.forwardRef)((function(t,n){const{map:r,mapLib:i}=(0,e.useContext)(Ep),s=(0,e.useRef)({props:t});s.current.props=t;const o=(0,e.useMemo)((()=>{let n=!1;e.Children.forEach(t.children,(e=>{e&&(n=!0)}));const r=a(a({},t),{},{element:n?document.createElement("div"):null}),l=new i.Marker(r);return l.setLngLat([t.longitude,t.latitude]),l.getElement().addEventListener("click",(e=>{var t,n;null===(n=(t=s.current.props).onClick)||void 0===n||n.call(t,{type:"click",target:l,originalEvent:e})})),l.on("dragstart",(e=>{var t,n;const r=e;r.lngLat=o.getLngLat(),null===(n=(t=s.current.props).onDragStart)||void 0===n||n.call(t,r)})),l.on("drag",(e=>{var t,n;const r=e;r.lngLat=o.getLngLat(),null===(n=(t=s.current.props).onDrag)||void 0===n||n.call(t,r)})),l.on("dragend",(e=>{var t,n;const r=e;r.lngLat=o.getLngLat(),null===(n=(t=s.current.props).onDragEnd)||void 0===n||n.call(t,r)})),l}),[]);(0,e.useEffect)((()=>(o.addTo(r.getMap()),()=>{o.remove()})),[]);const{longitude:l,latitude:c,offset:u,style:h,draggable:d=!1,popup:f=null,rotation:p=0,rotationAlignment:g="auto",pitchAlignment:m="auto"}=t;return(0,e.useEffect)((()=>{xp(o.getElement(),h)}),[h]),(0,e.useImperativeHandle)(n,(()=>o),[]),o.getLngLat().lng===l&&o.getLngLat().lat===c||o.setLngLat([l,c]),u&&!function(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,s=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&r===s}(o.getOffset(),u)&&o.setOffset(u),o.isDraggable()!==d&&o.setDraggable(d),o.getRotation()!==p&&o.setRotation(p),o.getRotationAlignment()!==g&&o.setRotationAlignment(g),o.getPitchAlignment()!==m&&o.setPitchAlignment(m),o.getPopup()!==f&&o.setPopup(f),(0,Sp.createPortal)(t.children,o.getElement())})));function Ap(e){return new Set(e?e.trim().split(/\s+/):[])}(0,e.memo)((0,e.forwardRef)((function(t,n){const{map:r,mapLib:i}=(0,e.useContext)(Ep),s=(0,e.useMemo)((()=>document.createElement("div")),[]),o=(0,e.useRef)({props:t});o.current.props=t;const l=(0,e.useMemo)((()=>{const e=a({},t),n=new i.Popup(e);return n.setLngLat([t.longitude,t.latitude]),n.once("open",(e=>{var t,n;null===(n=(t=o.current.props).onOpen)||void 0===n||n.call(t,e)})),n}),[]);if((0,e.useEffect)((()=>{const e=e=>{var t,n;null===(n=(t=o.current.props).onClose)||void 0===n||n.call(t,e)};return l.on("close",e),l.setDOMContent(s).addTo(r.getMap()),()=>{l.off("close",e),l.isOpen()&&l.remove()}}),[]),(0,e.useEffect)((()=>{xp(l.getElement(),t.style)}),[t.style]),(0,e.useImperativeHandle)(n,(()=>l),[]),l.isOpen()&&(l.getLngLat().lng===t.longitude&&l.getLngLat().lat===t.latitude||l.setLngLat([t.longitude,t.latitude]),t.offset&&!rp(l.options.offset,t.offset)&&l.setOffset(t.offset),l.options.anchor===t.anchor&&l.options.maxWidth===t.maxWidth||(l.options.anchor=t.anchor,l.setMaxWidth(t.maxWidth)),l.options.className!==t.className)){const e=Ap(l.options.className),n=Ap(t.className);for(const t of e)n.has(t)||l.removeClassName(t);for(const t of n)e.has(t)||l.addClassName(t);l.options.className=t.className}return(0,Sp.createPortal)(t.children,s)})));const Rp=function(t,n,r,i){const s=(0,e.useContext)(Ep),o=(0,e.useMemo)((()=>t(s)),[]);return(0,e.useEffect)((()=>{const e=i||r||n,t="function"===typeof n&&"function"===typeof r?n:null,a="function"===typeof r?r:"function"===typeof n?n:null,{map:l}=s;return l.hasControl(o)||(l.addControl(o,null===e||void 0===e?void 0:e.position),t&&t(s)),()=>{a&&a(s),l.hasControl(o)&&l.removeControl(o)}}),[]),o};(0,e.memo)((function(t){const n=Rp((e=>{let{mapLib:n}=e;return new n.AttributionControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{xp(n._container,t.style)}),[t.style]),null}));(0,e.memo)((function(t){const n=Rp((e=>{let{mapLib:n}=e;return new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)})}),{position:t.position});return(0,e.useEffect)((()=>{xp(n._controlContainer,t.style)}),[t.style]),null}));(0,e.memo)((0,e.forwardRef)((function(t,n){const r=(0,e.useRef)({props:t}),i=Rp((e=>{let{mapLib:n}=e;const i=new n.GeolocateControl(t),s=i._setupUI;return i._setupUI=e=>{i._container.hasChildNodes()||s(e)},i.on("geolocate",(e=>{var t,n;null===(n=(t=r.current.props).onGeolocate)||void 0===n||n.call(t,e)})),i.on("error",(e=>{var t,n;null===(n=(t=r.current.props).onError)||void 0===n||n.call(t,e)})),i.on("outofmaxbounds",(e=>{var t,n;null===(n=(t=r.current.props).onOutOfMaxBounds)||void 0===n||n.call(t,e)})),i.on("trackuserlocationstart",(e=>{var t,n;null===(n=(t=r.current.props).onTrackUserLocationStart)||void 0===n||n.call(t,e)})),i.on("trackuserlocationend",(e=>{var t,n;null===(n=(t=r.current.props).onTrackUserLocationEnd)||void 0===n||n.call(t,e)})),i}),{position:t.position});return r.current.props=t,(0,e.useImperativeHandle)(n,(()=>i),[]),(0,e.useEffect)((()=>{xp(i._container,t.style)}),[t.style]),null})));(0,e.memo)((function(t){const n=Rp((e=>{let{mapLib:n}=e;return new n.NavigationControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{xp(n._container,t.style)}),[t.style]),null}));(0,e.memo)((function(t){const n=Rp((e=>{let{mapLib:n}=e;return new n.ScaleControl(t)}),{position:t.position}),r=(0,e.useRef)(t),i=r.current;r.current=t;const{style:s}=t;return void 0!==t.maxWidth&&t.maxWidth!==i.maxWidth&&(n.options.maxWidth=t.maxWidth),void 0!==t.unit&&t.unit!==i.unit&&n.setUnit(t.unit),(0,e.useEffect)((()=>{xp(n._container,s)}),[s]),null}));const Pp=n.e(879).then(n.t.bind(n,879,23)),Cp=e.forwardRef((function(e,t){return wp(e,t,Pp)}));function kp(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}class Lp extends qf{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((e=>e.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo(e){let{info:t}=e;const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(t.object=n.__source.object,t.index=n.__source.index,t):t}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"===typeof e){const t={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}return e}getSubLayerProps(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:_,operation:v,_subLayerProps:y}=this.props,b={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:_,operation:v},E=y&&t.id&&y[t.id],w=E&&E.updateTriggers,S=t.id||"sublayer";if(E){const e=this.props[Je],n=t.type?t.type._propTypes:{};for(const t in E){const r=n[t]||e[t];r&&"accessor"===r.type&&(E[t]=this.getSubLayerAccessor(E[t]))}}Object.assign(b,t,E),b.id="".concat(this.props.id,"-").concat(S),b.updateTriggers=a(a({all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all},t.updateTriggers),w);for(const a of m){const e=a.getSubLayerProps.call(this,a);e&&Object.assign(b,e,{updateTriggers:Object.assign(b.updateTriggers,e.updateTriggers)})}return b}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();if(r){n=at(this.renderLayers(),Boolean),this.internalState.subLayers=n}ot("compositeLayer.renderLayers",this,r,n);for(const i of n)i.parent=this}}Lp.layerName="CompositeLayer";const Mp=Lp;function Ip(e){let{data:t,getIndex:n,dataRange:r,replace:i}=e;const{startRow:s=0,endRow:o=1/0}=r,a=t.length;let l=a,c=a;for(let d=0;d<a;d++){const e=n(t[d]);if(l>d&&e>=s&&(l=d),e>=o){c=d;break}}let u=l;const h=c-l!==i.length?t.slice(c):void 0;for(let d=0;d<i.length;d++)t[u++]=i[d];if(h){for(let e=0;e<h.length;e++)t[u++]=h[e];t.length=u}return{startRow:l,endRow:l+i.length}}function Op(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){const r={properties:a({},e.properties[t])};for(const i in e.numericProps)r.properties[i]=e.numericProps[i].value[n];return r}(e,r,n):null}const Np={name:"project32",dependencies:[je],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Fp={name:"picking",vs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nout vec4 picking_vRGBcolor_Avalid;\nvec3 picking_normalizeColor(vec3 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nvec4 picking_normalizeColor(vec4 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nbool picking_isColorZero(vec3 color) {\nreturn dot(color, vec3(1.0)) < 0.00001;\n}\nbool picking_isColorValid(vec3 color) {\nreturn dot(color, vec3(1.0)) > 0.00001;\n}\nbool isVertexHighlighted(vec3 vertexColor) {\nvec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\nreturn\nbool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\nvoid picking_setPickingColor(vec3 pickingColor) {\npickingColor = picking_normalizeColor(pickingColor);\nif (bool(picking.isActive)) {\npicking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\nif (!bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = pickingColor;\n}\n} else {\npicking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n}\n}\nvoid picking_setPickingAttribute(float value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.r = value;\n}\n}\nvoid picking_setPickingAttribute(vec2 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rg = value;\n}\n}\nvoid picking_setPickingAttribute(vec3 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = value;\n}\n}\n",fs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\nif (picking.isActive > 0.5) {\nreturn color;\n}\nbool selected = bool(picking_vRGBcolor_Avalid.a);\nif (selected) {\nfloat highLightAlpha = picking.highlightColor.a;\nfloat blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\nfloat highLightRatio = highLightAlpha / blendedAlpha;\nvec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\nreturn vec4(blendedRGB, blendedAlpha);\n} else {\nreturn color;\n}\n}\nvec4 picking_filterPickingColor(vec4 color) {\nif (bool(picking.isActive)) {\nif (picking_vRGBcolor_Avalid.a == 0.0) {\ndiscard;\n}\nreturn picking_vRGBcolor_Avalid;\n}\nreturn color;\n}\nvec4 picking_filterColor(vec4 color) {\nvec4 highlightColor = picking_filterHighlightColor(color);\nreturn picking_filterPickingColor(highlightColor);\n}\n",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const n=e.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=n}if(e.highlightColor){const n=Array.from(e.highlightColor,(e=>e/255));Number.isFinite(n[3])||(n[3]=1),t.highlightColor=n}void 0!==e.isActive&&(t.isActive=Boolean(e.isActive),t.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(t.useFloatColors=Boolean(e.useFloatColors));return t}};const Dp=a(a({},Fp),{},{defaultUniforms:a(a({},Fp.defaultUniforms),{},{useFloatColors:!1}),inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}});class Bp{constructor(e){s(this,"id",void 0),s(this,"topology",void 0),s(this,"vertexCount",void 0),s(this,"indices",void 0),s(this,"attributes",void 0),s(this,"userData",{});const{attributes:t={},indices:n=null,vertexCount:r=null}=e;this.id=e.id||mo("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[i,s]of Object.entries(t)){const e=ArrayBuffer.isView(s)?{value:s}:s;ko(ArrayBuffer.isView(e.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),"POSITION"!==i&&"positions"!==i||e.size||(e.size=3),"indices"===i?(ko(!this.indices),this.indices=e):this.attributes[i]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?a({indices:this.indices},this.attributes):this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r of Object.values(e)){const{value:e,size:t,constant:i}=r;!i&&e&&t>=1&&(n=Math.min(n,e.length/t))}return ko(Number.isFinite(n)),n}}const Up=()=>{},zp={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Gp={x:0,y:0,width:0,height:0};function jp(e,t,n,r){const i=Math.min(n/t.width,r/t.height),s=Math.floor(t.width*i),o=Math.floor(t.height*i);return 1===i?{data:t,width:s,height:o}:(e.canvas.height=o,e.canvas.width=s,e.clearRect(0,0,s,o),e.drawImage(t,0,0,t.width,t.height,0,0,s,o),{data:e.canvas,width:s,height:o})}function Vp(e){return e&&(e.id||e.url)}function Wp(e,t,n){for(let r=0;r<t.length;r++){const{icon:i,xOffset:s}=t[r];e[Vp(i)]=a(a({},i),{},{x:s,y:n})}}class Hp{constructor(e,t){let{onUpdate:n=Up,onError:r=Up}=t;this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Vp(e):e;return this._mapping[t]||Gp}setProps(e){let{loadOptions:t,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}=e;var o;(t&&(this._loadOptions=t),void 0!==n&&(this._autoPacking=n),i&&(this._mapping=i),r)&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=r);s&&(this._textureParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"===typeof document)return;const n=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Nu(e);for(const o of i){s.index++;const e=t(o,s),i=Vp(e);if(!e)throw new Error("Icon is missing.");if(!e.url)throw new Error("Icon url is missing.");r[i]||n[i]&&e.url===n[i].url||(r[i]=a(a({},e),{},{source:o,sourceIndex:s.index}))}return r}(e,t,this._mapping)||{});if(n.length>0){const{mapping:e,xOffset:t,yOffset:r,rowHeight:i,canvasHeight:s}=function(e){let{icons:t,buffer:n,mapping:r={},xOffset:i=0,yOffset:s=0,rowHeight:o=0,canvasWidth:a}=e,l=[];for(let u=0;u<t.length;u++){const e=t[u];if(!r[Vp(e)]){const{height:t,width:c}=e;i+c+n>a&&(Wp(r,l,s),i=0,s=o+s+n,o=0,l=[]),l.push({icon:e,xOffset:i}),i=i+c+n,o=Math.max(o,t)}}return l.length>0&&Wp(r,l,s),{mapping:r,rowHeight:o,xOffset:i,yOffset:s,canvasWidth:a,canvasHeight:(c=o+s+n,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=e,this._xOffset=t,this._yOffset=r,this._canvasHeight=s,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||zp})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,n,r){const{width:i,height:s,device:o}=e,a=o.createTexture({format:"rgba8unorm",width:t,height:n,sampler:r}),l=o.createCommandEncoder();return l.copyTextureToTexture({source:e,destination:a,width:i,height:s}),l.finish(),e.destroy(),a}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||zp)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,Qn(n.url,this._loadOptions).then((e=>{const r=Vp(n),i=this._mapping[r],{x:s,y:o,width:a,height:l}=i,{data:c,width:u,height:h}=jp(t,e,a,l);this._texture.setSubImageData({data:c,x:s+(a-u)/2,y:o+(l-h)/2,width:u,height:h}),i.width=u,i.height=h,this._texture.generateMipmap(),this.onUpdate()})).catch((e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})})).finally((()=>{this._pendingCount--}))}}const Xp=[0,0,0,255],qp={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:Xp},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class Kp extends qf{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\nsizeMinPixels, sizeMaxPixels\n);\nfloat instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n",fs:"#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * opacity * vColor.a;\nif (a < alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Np,Dp]})}initializeState(){this.state={iconManager:new Hp(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:Xp},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager(),{iconAtlas:s,iconMapping:o,data:a,getIcon:l,textureParameters:c}=t,{iconManager:u}=this.state;if("string"===typeof s)return;const h=s||this.internalState.isAsyncPropLoading("iconAtlas");var d;(u.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:s,iconMapping:h?o:null,textureParameters:c}),h?n.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.packIcons(a,l),r.extensionsChanged)&&(null===(d=this.state.model)||void 0===d||d.destroy(),this.state.model=this._getModel(),i.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw(e){let{uniforms:t}=e;const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();if(c){const e=this.state.model;e.setBindings({iconsTexture:c}),e.setUniforms(t),e.setUniforms({iconsTextureDim:[c.width,c.height],sizeUnits:ge[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}),e.draw(this.context.renderPass)}}_getModel(){return new Od(this.context.device,a(a({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Bp({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([-1,-1,1,-1,-1,1,1,1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const n=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;n?n(e):de.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:r=t/2,anchorY:i=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,n/2-i]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:r,height:i}=this.state.iconManager.getIconMapping(e);return[t,n,r,i]}}Kp.defaultProps=qp,Kp.layerName="IconLayer";const Yp=Kp,Zp=[0,0,0,255],Qp={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Zp},getLineColor:{type:"accessor",value:Zp},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class $p extends qf{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\nradiusMinPixels, radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\nlineWidthMinPixels, lineWidthMaxPixels\n);\nouterRadiusPixels += stroked * lineWidthPixels / 2.0;\nfloat edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\nif (billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (stroked > 0.5) {\nfloat isLine = antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (filled) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (!filled) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Np,Dp]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var t;(super.updateState(e),e.changeFlags.extensionsChanged)&&(null===(t=this.state.model)||void 0===t||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props,p=this.state.model;p.setUniforms(t),p.setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:ge[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:ge[u],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}),p.draw(this.context.renderPass)}_getModel(){return new Od(this.context.device,a(a({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Bp({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0}))}}$p.defaultProps=Qp,$p.layerName="ScatterplotLayer";const Jp=$p,eg=.75,tg=[];class ng extends Yp{getShaders(){return a(a({},super.getShaders()),{},{fs:"#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf) {\nfloat distance = alpha;\nalpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\nif (outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\ncolor = mix(outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"})}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(n,r)}}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:r}=t;r!==n.outlineColor&&(r=r.map((e=>e/255)),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&de.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state,s=r?Math.max(n,eg*(1-r)):-1;if(e.uniforms=a(a({},e.uniforms),{},{sdfBuffer:eg,outlineBuffer:s,gamma:n,sdf:Boolean(t),outlineColor:i}),super.draw(e),t&&r){const{iconManager:e}=this.state,t=e.getTexture(),n=this.state.model;t&&(n.setUniforms({outlineBuffer:eg}),n.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap((e=>super.getInstanceOffset(e))):tg}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap((e=>super.getInstanceIconFrame(e))):tg}}ng.defaultProps={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},ng.layerName="MultiIconLayer";const rg=ng,ig=1e20;class sg{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=n;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font="".concat(o," ").concat(s," ").concat(e,"px ").concat(i),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(r)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),f={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return f;const{ctx:p,buffer:g,gridInner:m,gridOuter:_}=this;p.clearRect(g,g,a,l),p.fillText(e,g,g+o);const v=p.getImageData(g,g,a,l);_.fill(ig,0,h),m.fill(0,0,h);for(let y=0;y<l;y++)for(let e=0;e<a;e++){const t=v.data[4*(y*a+e)+3]/255;if(0===t)continue;const n=(y+g)*c+e+g;if(1===t)_[n]=0,m[n]=ig;else{const e=.5-t;_[n]=e>0?e*e:0,m[n]=e<0?e*e:0}}og(_,0,0,c,u,c,this.f,this.v,this.z),og(m,g,g,a,l,c,this.f,this.v,this.z);for(let y=0;y<h;y++){const e=Math.sqrt(_[y])-Math.sqrt(m[y]);d[y]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}}function og(e,t,n,r,i,s,o,a,l){for(let c=t;c<t+r;c++)ag(e,n*s+c,s,i,o,a,l);for(let c=n;c<n+i;c++)ag(e,c*s+t,1,r,o,a,l)}function ag(e,t,n,r,i,s,o){s[0]=0,o[0]=-ig,o[1]=ig,i[0]=e[t];for(let a=1,l=0,c=0;a<r;a++){i[a]=e[t+a*n];const r=a*a;do{const e=s[l];c=(i[a]-i[e]+r-e*e)/(a-e)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=ig}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const r=s[l],c=a-r;e[t+a*n]=i[r]+c*c}}const lg=[];function cg(e,t,n,r){let i=0;for(let o=t;o<n;o++){var s;i+=(null===(s=r[e[o]])||void 0===s?void 0:s.layoutWidth)||0}return i}function ug(e,t,n,r,i,s){let o=t,a=0;for(let l=t;l<n;l++){const t=cg(e,l,l+1,i);a+t>r&&(o<l&&s.push(l),o=l,a=0),a+=t}return a}function hg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;void 0===s&&(s=e.length);const o=[];return"break-all"===t?ug(e,i,s,n,r,o):function(e,t,n,r,i,s){let o=t,a=t,l=t,c=0;for(let u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>a){let t=cg(e,a,l,i);c+t>r&&(o<a&&(s.push(a),o=a,c=0),t>r&&(t=ug(e,a,l,r,i,s),o=s[s.length-1])),a=l,c+=t}}(e,i,s,n,r,o),o}function dg(e,t,n,r,i,s){let o=0,a=0;for(let l=t;l<n;l++){const t=e[l],n=r[t];n?(a||(a=n.layoutHeight),i[l]=o+n.layoutWidth/2,o+=n.layoutWidth):(de.warn("Missing character: ".concat(t," (").concat(t.codePointAt(0),")"))(),i[l]=o,o+=32)}s[0]=o,s[1]=a}class fg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const pg={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let gg=new fg(3);function mg(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function _g(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class vg{constructor(){this.props=a({},pg)}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,e),this._key=this._getKey();const t=function(e,t){let n;n="string"===typeof t?new Set(Array.from(t)):new Set(t);const r=gg.get(e);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}(this._key,this.props.characterSet),n=gg.get(this._key);if(n&&0===t.size)return void(this._atlas!==n&&(this._atlas=n));const r=this._generateFontAtlas(t,n);this._atlas=r,gg.set(this._key,r)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:r,fontSize:i,buffer:s,sdf:o,radius:l,cutoff:c}=this.props;let u=t&&t.data;u||(u=document.createElement("canvas"),u.width=1024);const h=u.getContext("2d",{willReadFrequently:!0});_g(h,n,i,r);const{mapping:d,canvasHeight:f,xOffset:p,yOffset:g}=function(e){let{characterSet:t,getFontWidth:n,fontHeight:r,buffer:i,maxCanvasWidth:s,mapping:o={},xOffset:a=0,yOffset:l=0}=e,c=0,u=a;const h=r+2*i;for(const f of t)if(!o[f]){const e=n(f);u+e+2*i>s&&(u=0,c++),o[f]={x:u+i,y:l+c*h+i,width:e,height:h,layoutWidth:e,layoutHeight:r},u+=e+2*i}return{mapping:o,xOffset:u,yOffset:l+c*h,canvasHeight:(d=l+(c+1)*h,Math.pow(2,Math.ceil(Math.log2(d))))};var d}(a({getFontWidth:e=>h.measureText(e).width,fontHeight:1.2*i,buffer:s,characterSet:e,maxCanvasWidth:1024},t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}));if(u.height!==f){const e=h.getImageData(0,0,u.width,u.height);u.height=f,h.putImageData(e,0,0)}if(_g(h,n,i,r),o){const t=new sg({fontSize:i,buffer:s,radius:l,cutoff:c,fontFamily:n,fontWeight:"".concat(r)});for(const n of e){const{data:e,width:r,height:s,glyphTop:o}=t.draw(n);d[n].width=r,d[n].layoutOffsetY=.9*i-o;const a=h.createImageData(r,s);mg(e,a),h.putImageData(a,d[n].x,d[n].y)}}else for(const a of e)h.fillText(a,d[a].x,d[a].y+s+.9*i);return{xOffset:p,yOffset:g,mapping:d,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:r,sdf:i,radius:s,cutoff:o}=this.props;return i?"".concat(e," ").concat(t," ").concat(n," ").concat(r," ").concat(s," ").concat(o):"".concat(e," ").concat(t," ").concat(n," ").concat(r)}}const yg={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class bg extends qf{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\nsizeMinPixels, sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nuniform bool stroked;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec2 pixelPosition = uv * dimensions;\nif (stroked) {\nfloat distToEdge = min(\nmin(pixelPosition.x, dimensions.x - pixelPosition.x),\nmin(pixelPosition.y, dimensions.y - pixelPosition.y)\n);\nfloat isBorder = smoothedge(distToEdge, vLineWidth);\nfragColor = mix(vFillColor, vLineColor, isBorder);\n} else {\nfragColor = vFillColor;\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Np,Dp]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;var n;t.extensionsChanged&&(null===(n=this.state.model)||void 0===n||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);const c=this.state.model;c.setUniforms(t),c.setUniforms({billboard:n,stroked:Boolean(a),padding:l,sizeUnits:ge[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}),c.draw(this.context.renderPass)}_getModel(){return new Od(this.context.device,a(a({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Bp({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}bg.defaultProps=yg,bg.layerName="TextBackgroundLayer";const Eg=bg,wg={start:1,middle:0,end:-1},Sg={top:1,center:0,bottom:-1},Tg=[0,0,0,255],xg={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Tg},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:pg.characterSet},fontFamily:pg.fontFamily,fontWeight:pg.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Tg},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:Tg},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Ag extends Mp{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[n,r]}=this.transformParagraph(e,t);const{fontSize:i}=this.state.fontAtlasManager.props;n/=i,r/=i;const{getTextAnchor:s,getAlignmentBaseline:o}=this.props;return[(wg["function"===typeof s?s(e,t):s]-1)*n/2,(Sg["function"===typeof o?o(e,t):o]-1)*r/2,n,r]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:r}=this.props,{x:i,y:s,rowWidth:o,size:[a,l]}=this.transformParagraph(e,t),c=wg["function"===typeof n?n(e,t):n],u=Sg["function"===typeof r?r(e,t):r],h=i.length,d=new Array(2*h);let f=0;for(let p=0;p<h;p++){const e=(1-c)*(a-o[p])/2;d[f++]=(c-1)*a/2+e+i[p],d[f++]=(u-1)*l/2+s[p]}return d}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new vg},this.props.maxWidth>0&&de.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo(e){let{info:t}=e;return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:r,characterSet:i}=this.state,s=a(a({},e),{},{characterSet:i,fontFamily:t,fontWeight:n});if(!r.mapping)return r.setProps(s),!0;for(const o in s)if(s[o]!==r.props[o])return r.setProps(s),!0;return!1}_updateText(){var e;const{data:t,characterSet:n}=this.props,r=null===(e=t.attributes)||void 0===e?void 0:e.getText;let i,{getText:s}=this.props,o=t.startIndices;const l="auto"===n&&new Set;if(r&&o){const{texts:e,characterCount:n}=function(e){let{value:t,length:n,stride:r,offset:i,startIndices:s,characterSet:o}=e;const a=t.BYTES_PER_ELEMENT,l=r?r/a:1,c=i?i/a:0,u=s[n]||Math.ceil((t.length-c)/l),h=o&&new Set,d=new Array(n);let f=t;if(l>1||c>0){f=new(0,t.constructor)(u);for(let e=0;e<u;e++)f[e]=t[e*l+c]}for(let p=0;p<n;p++){const e=s[p],t=s[p+1]||u,n=f.subarray(e,t);d[p]=String.fromCodePoint.apply(null,n),h&&n.forEach(h.add,h)}if(h)for(const p of h)o.add(String.fromCodePoint(p));return{texts:d,characterCount:u}}(a(a({},ArrayBuffer.isView(r)?{value:r}:r),{},{length:t.length,startIndices:o,characterSet:l}));i=n,s=(t,n)=>{let{index:r}=n;return e[r]}}else{const{iterable:e,objectInfo:n}=Nu(t);o=[0],i=0;for(const t of e){n.index++;const e=Array.from(s(t,n)||"");l&&e.forEach(l.add,l),i+=e.length,o.push(i)}}this.setState({getText:s,startIndices:o,numInstances:i,characterSet:l||n})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,r=n.mapping,i=this.state.getText,{wordBreak:s,lineHeight:o,maxWidth:a}=this.props;return function(e,t,n,r,i){const s=Array.from(e),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,h=[0,0],d=[0,0];let f=0,p=0,g=0;for(let _=0;_<=o;_++){const e=s[_];if("\n"!==e&&_!==o||(g=_),g>p){const e=u?hg(s,n,r,i,p,g):lg;for(let n=0;n<=e.length;n++){const r=0===n?p:e[n-1],o=n<e.length?e[n]:g;dg(s,r,o,i,a,d);for(let e=r;e<o;e++){var m;const t=(null===(m=i[s[e]])||void 0===m?void 0:m.layoutOffsetY)||0;l[e]=f+d[1]/2+t,c[e]=d[0]}f+=d[1]*t,h[0]=Math.max(h[0],d[0])}p=g}"\n"===e&&(a[p]=0,l[p]=0,c[p]=0,p++)}return h[1]=f,{x:a,y:l,rowWidth:c,size:h}}(i(e,t)||"",o,s,a*n.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:r,atlas:i,mapping:s},styleVersion:o}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:_,background:v,billboard:y,fontSettings:b,outlineWidth:E,outlineColor:w,sizeScale:S,sizeUnits:T,sizeMinPixels:x,sizeMaxPixels:A,transitions:R,updateTriggers:P}=this.props,C=this.getSubLayerClass("characters",rg),k=this.getSubLayerClass("background",Eg);return[v&&new k({getFillColor:p,getLineColor:g,getLineWidth:m,padding:_,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:y,sizeScale:S,sizeUnits:T,sizeMinPixels:x,sizeMaxPixels:A,transitions:R&&{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset,getBoundingRect:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:o}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new C({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:pg.smoothing,outlineWidth:E/(b.radius||pg.radius),outlineColor:w,iconAtlas:i,iconMapping:s,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:y,sizeScale:S*r,sizeUnits:T,sizeMinPixels:x*r,sizeMaxPixels:A*r,transitions:R&&{getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:P.getText,getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset,getIconOffsets:{getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:o}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){!function(e){de.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),gg=new fg(e)}(e)}}Ag.defaultProps=xg,Ag.layerName="TextLayer";const Rg=Ag;class Pg{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=er,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:s,dataChanged:o,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===s?2:3),this.buffers=n,this.normalize=a,i&&(Ii(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.vertexPositions=i)),this.geometryBuffer=n.vertexPositions,Array.isArray(o))for(const l of o)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(e){let{startRow:t,endRow:n}=e;this._rebuildGeometry({startRow:t,endRow:n})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?Du(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:s}=this;for(const o in i)if(o in r)s.release(n[o]),n[o]=null;else{const r=i[o];r.copy=t,n[o]=s.allocate(n[o],e,r)}}_forEachGeometry(e,t,n){const{data:r,getGeometry:i}=this,{iterable:s,objectInfo:o}=Nu(r,t,n);for(const a of s){o.index++;e(i?i(a,o):null,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:s}=this,{startRow:o=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!s)this._forEachGeometry(((e,t)=>{const r=e&&this.normalizeGeometry(e);l[t]=r,n[t+1]=n[t]+(r?this.getGeometrySize(r):0)}),o,a),r=n[n.length-1];else if(n=i.startIndices,r=n[i.length]||0,ArrayBuffer.isView(s))r=r||s.length/this.positionSize;else if(s instanceof yo){const e=4*this.positionSize;r=r||s.byteLength/e}else if(s.buffer){const e=s.stride||4*this.positionSize;r=r||s.buffer.byteLength/e}else if(s.value){const e=s.value,t=s.stride/e.BYTES_PER_ELEMENT||this.positionSize;r=r||e.length/t}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((e,i)=>{const s=l[i]||e;c.vertexStart=n[i],c.indexStart=t[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(s,c)}),o,a),this.vertexCount=t[t.length-1]}}const Cg=1,kg=-1;function Lg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:r=e.length,plane:i="xy"}=t,s=t.size||2;let o=0;const a=Mg[i[0]],l=Mg[i[1]];for(let c=n,u=r-s;c<r;c+=s)o+=(e[c+a]-e[u+a])*(e[c+l]+e[u+l]),u=c;return o/2}(e,t))}(e,n);return r!==t&&(function(e,t){const{start:n=0,end:r=e.length,size:i=2}=t,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const t=n+a*i,r=n+(s-1-a)*i;for(let n=0;n<i;++n){const i=e[t+n];e[t+n]=e[r+n],e[r+n]=i}}}(e,n),!0)}const Mg={x:0,y:1,z:2};function Ig(e,t,n,r){let i,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)i=(r[3]-e[1])/(t[1]-e[1]),s=3;else if(4&n)i=(r[1]-e[1])/(t[1]-e[1]),s=1;else if(2&n)i=(r[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&n))return null;i=(r[0]-e[0])/(t[0]-e[0]),s=0}for(let a=0;a<e.length;a++)o[a]=(1&s)===a?r[s]:i*(t[a]-e[a])+e[a];return o}function Og(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ng(e,t){const n=t.length,r=e.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(e[r-n+s]!==t[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)e[r+i]=t[i];return!0}function Fg(e,t){const n=t.length;for(let r=0;r<n;r++)e[r]=t[r]}function Dg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const s=r+t*n;for(let o=0;o<n;o++)i[o]=e[s+o];return i}function Bg(e,t){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=e.length}=t||{},l=(a-o)/n;let c=[];const u=[c],h=Dg(e,0,n,o);let d,f;const p=Gg(h,i,s,[]),g=[];Ng(c,h);for(let m=1;m<l;m++){for(d=Dg(e,m,n,o,d),f=Og(d,p);f;){Ig(h,d,f,p,g);const e=Og(g,p);e&&(Ig(h,g,e,p,g),f=e),Ng(c,g),Fg(h,g),jg(p,i,f),r&&c.length>n&&(c=[],u.push(c),Ng(c,h)),f=Og(d,p)}Ng(c,d),Fg(h,d)}return r?u:u[0]}function Ug(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!e.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:e,types:o?new Array(e.length/r).fill(1):null,holes:t||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();Vg(e,r,n[0]||e.length,c),u=Gg(c[0],i,s,u);const h=Og(c[1],u);if(h){let i=zg(e,t,r,0,n[0]||e.length,u,h);const s={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(s,a);for(let l=0;l<n.length;l++)i=zg(e,t,r,n[l],n[l+1]||e.length,u,h),i[0]&&(s.holes.push(s.pos.length),s.pos=Wg(s.pos,i[0].pos),o&&(s.types=Wg(s.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=Wg(a.pos,i[1].pos),o&&(a.types=Wg(a.types,i[1].types)))}else{const r={positions:e};o&&(r.edgeTypes=t),n.length&&(r.holeIndices=n),a.push(r)}}return a}function zg(e,t,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],h=[],d=[];let f,p,g;const m=Dg(e,a-1,n,r);let _=Math.sign(8&o?m[1]-s[3]:m[0]-s[2]),v=t&&t[a-1],y=0,b=0;for(let E=0;E<a;E++)f=Dg(e,E,n,r,f),p=Math.sign(8&o?f[1]-s[3]:f[0]-s[2]),g=t&&t[r/n+E],p&&_&&_!==p&&(Ig(m,f,o,s,d),Ng(l,d)&&u.push(v),Ng(c,d)&&h.push(v)),p<=0?(Ng(l,f)&&u.push(g),y-=p):u.length&&(u[u.length-1]=0),p>=0?(Ng(c,f)&&h.push(g),b+=p):h.length&&(h[h.length-1]=0),Fg(m,f),_=p,v=g;return[y?{pos:l,types:t&&u}:null,b?{pos:c,types:t&&h}:null]}function Gg(e,t,n,r){const i=Math.floor((e[0]-n[0])/t)*t+n[0],s=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=i,r[1]=s,r[2]=i+t,r[3]=s+t,r}function jg(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function Vg(e,t,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=t){const t=e[l],n=e[l+1];i=t<i?t:i,s=t>s?t:s,o=n<o?n:o,a=n>a?n:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function Wg(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function Hg(e,t,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=t){const t=Math.abs(e[o]);t>i&&(i=t,s=o-1)}return s}function Xg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129;const s=e[n],o=e[r-t];if(Math.abs(s-o)>180){const r=Dg(e,0,t,n);r[0]+=360*Math.round((o-s)/360),Ng(e,r),r[1]=Math.sign(r[1])*i,Ng(e,r),r[0]=s,Ng(e,r)}}function qg(e,t,n,r){let i,s=e[0];for(let o=n;o<r;o+=t){i=e[o];const t=i-s;(t>180||t<-180)&&(i-=360*Math.round(t/360)),e[o]=s=i}}function Kg(e,t){let n;const r=e.length/t;for(let s=0;s<r&&(n=e[s*t],(n+180)%360===0);s++);const i=360*-Math.round(n/360);if(0!==i)for(let s=0;s<r;s++)e[s*t]+=i}function Yg(e,t,n,r){let i;if(Array.isArray(e[0])){const n=e.length*t;i=new Array(n);for(let r=0;r<e.length;r++)for(let n=0;n<t;n++)i[r*t+n]=e[r][n]||0}else i=e;return n?Bg(i,{size:t,gridResolution:n}):r?function(e,t){const{size:n=2,startIndex:r=0,endIndex:i=e.length,normalize:s=!0}=t||{},o=e.slice(r,i);qg(o,n,0,i-r);const a=Bg(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)Kg(l,n);return a}(i,{size:t}):i}class Zg extends Pg{constructor(e){super(a(a({},e),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?Yg(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Qg(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&Qg(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),{vertexStart:i,geometrySize:s}=t;n.fill(0,i,i+s),r?(n[i]=4,n[i+s-2]=4):(n[i]+=1,n[i+s-2]+=2),n[i+s-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:r,geometrySize:i}=t,s=new Array(3);for(let o=r,a=0;a<i;o++,a++)this.getPointOnPath(e,a,s),n[3*o]=s[0],n[3*o+1]=s[1],n[3*o+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const i=t*r;return n[0]=e[i],n[1]=e[i+1],n[2]=3===r&&e[i+2]||0,n}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}function Qg(e){return Array.isArray(e[0])}const $g=[0,0,0,255],Jg={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:$g},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},em={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class tm extends qf{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = capType;\n} else {\nvJointType = jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\nwidthMinPixels, widthMaxPixels) / 2.0);\nvec3 width;\nif (billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nuniform float miterLimit;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Np,Dp]})}get wrapLongitude(){return!1}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["vertexPositions"])}initializeState(){const e=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:em,accessor:"getPath",update:this.calculatePositions,noAlloc:e,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:e},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:em,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:em,defaultValue:$g},instancePickingColors:{size:4,type:"uint8",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}}),this.setState({pathTesselator:new Zg({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:i.getPath,buffers:i,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||r.invalidateAll()}var i;n.extensionsChanged&&(null===(i=this.state.model)||void 0===i||i.destroy(),this.state.model=this._getModel(),r.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model;u.setUniforms(t),u.setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:ge[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}),u.draw(this.context.renderPass)}_getModel(){return new Od(this.context.device,a(a({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Bp({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}tm.defaultProps=Jg,tm.layerName="PathLayer";const nm=tm,rm="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\nvec3 color;\n};\nstruct PointLight {\nvec3 color;\nvec3 position;\nvec3 attenuation;\n};\nstruct DirectionalLight {\nvec3 color;\nvec3 direction;\n};\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\nuniform bool lighting_uEnabled;\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\nreturn pointLight.attenuation.x\n+ pointLight.attenuation.y * distance\n+ pointLight.attenuation.z * distance * distance;\n}\n#endif\n",im={lightSources:{}};function sm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t=[0,0,0],intensity:n=1}=e;return t.map((e=>e*n/255))}const om={name:"lights",vs:rm,fs:rm,getUniforms:function e(){var t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:im;if("lightSources"in r){const{ambientLight:e,pointLights:t,directionalLights:n}=r.lightSources||{};return e||t&&t.length>0||n&&n.length>0?Object.assign({},function(e){let{ambientLight:t,pointLights:n=[],directionalLights:r=[]}=e;const i={};return i["lighting_uAmbientLight.color"]=t?sm(t):[0,0,0],n.forEach(((e,t)=>{i["lighting_uPointLight[".concat(t,"].color")]=sm(e),i["lighting_uPointLight[".concat(t,"].position")]=e.position,i["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]})),i.lighting_uPointLightCount=n.length,r.forEach(((e,t)=>{i["lighting_uDirectionalLight[".concat(t,"].color")]=sm(e),i["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction})),i.lighting_uDirectionalLightCount=r.length,i}({ambientLight:e,pointLights:t,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in r){const i={pointLights:[],directionalLights:[]};for(const e of r.lights||[])switch(e.type){case"ambient":i.ambientLight=e;break;case"directional":null===(t=i.directionalLights)||void 0===t||t.push(e);break;case"point":null===(n=i.pointLights)||void 0===n||n.push(e)}return e({lightSources:i})}return{}},defines:{MAX_LIGHTS:3}},am="uniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\nvec3 halfway_direction = normalize(light_direction + view_direction);\nfloat lambertian = dot(light_direction, normal_worldspace);\nfloat specular = 0.0;\nif (lambertian > 0.0) {\nfloat specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\nspecular = pow(specular_angle, lighting_uShininess);\n}\nlambertian = max(lambertian, 0.0);\nreturn (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = surfaceColor;\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nlightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = vec3(0, 0, 0);\nvec3 surfaceColor = vec3(0, 0, 0);\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\n",lm={};function cm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lm;if(!("material"in e))return{};const{material:t}=e;return t?function(e){const{ambient:t=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((e=>e/255))}}(t):{lighting_uEnabled:!1}}const um={name:"gouraud-lighting",dependencies:[om],vs:am,defines:{LIGHTING_VERTEX:1},getUniforms:cm};var hm=n(973);const dm=Cg,fm=kg,pm={isClosed:!0};function gm(e){return"positions"in e?e.positions:e}function mm(e){return"holeIndices"in e?e.holeIndices:null}function _m(e,t,n,r,i){let s=t;const o=n.length;for(let a=0;a<o;a++)for(let t=0;t<r;t++)e[s++]=n[a][t]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let a=0;a<r;a++)e[s++]=n[0][a]||0;return pm.start=t,pm.end=s,pm.size=r,Lg(e,i,pm),s}function vm(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;s=s||n.length;const a=s-i;if(a<=0)return t;let l=t;for(let c=0;c<a;c++)e[l++]=n[i+c];if(!function(e,t,n,r){for(let i=0;i<t;i++)if(e[n+i]!==e[r-t+i])return!1;return!0}(n,r,i,s))for(let c=0;c<r;c++)e[l++]=n[i+c];return pm.start=t,pm.end=l,pm.size=r,Lg(e,o,pm),l}function ym(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],r=[];if("positions"in e){const{positions:i,holeIndices:s}=e;if(s){let e=0;for(let o=0;o<=s.length;o++)e=vm(n,e,i,t,s[o-1],s[o],0===o?dm:fm),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=i}if(!function(e){return Array.isArray(e[0])}(e))return vm(n,0,e,t,0,n.length,dm),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let i=0;for(const[s,o]of e.entries())i=_m(n,i,o,t,0===s?dm:fm),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return _m(n,0,e,t,dm),n}function bm(e,t,n){const r=e.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=e[3*s+t]*e[3*o+n],i-=e[3*o+t]*e[3*s+n]}return Math.abs(i/2)}function Em(e,t,n,r){const i=e.length/3;for(let s=0;s<i;s++){const i=3*s,o=e[i+0],a=e[i+1],l=e[i+2];e[i+t]=o,e[i+n]=a,e[i+r]=l}}class wm extends Pg{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super(a(a({},e),{},{attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}}))}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=ym(e,this.positionSize);return this.opts.resolution?Ug(gm(t),mm(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};t=t||[];const o=[],a=[];let l=0,c=0;for(let h=0;h<=t.length;h++){const i=t[h]||e.length,s=c,u=Hg(e,r,l,i);for(let t=u;t<i;t++)o[c++]=e[t];for(let t=l;t<u;t++)o[c++]=e[t];qg(o,r,s,c),Xg(o,r,s,c,null===n||void 0===n?void 0:n.maxLatitude),l=i,a[h]=c}a.pop();const u=Ug(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const h of u)Kg(h.positions,r);return u}(gm(t),mm(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(Sm(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return gm(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&Sm(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const n=e;this._updateIndices(n,t),this._updatePositions(n,t),this._updateVertexValid(n,t)}}_updateIndices(e,t){let{geometryIndex:n,vertexStart:r,indexStart:i}=t;const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=function(e,t,n,r){let i=mm(e);i&&(i=i.map((e=>e/t)));let s=gm(e);const o=r&&3===t;if(n){const e=s.length;s=s.slice();const r=[];for(let i=0;i<e;i+=t){r[0]=s[i],r[1]=s[i+1],o&&(r[2]=s[i+2]);const e=n(r);s[i]=e[0],s[i+1]=e[1],o&&(s[i+2]=e[2])}}if(o){const e=bm(s,0,1),t=bm(s,0,2),r=bm(s,1,2);if(!e&&!t&&!r)return[];e>t&&e>r||(t>r?(n||(s=s.slice()),Em(s,0,2,1)):(n||(s=s.slice()),Em(s,2,0,1)))}return hm(s,i,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let h=0;h<u.length;h++)l[c++]=u[h]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,t){let{vertexStart:n,geometrySize:r}=t;const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=gm(e);for(let a=n,l=0;l<r;a++,l++){const e=o[l*s],t=o[l*s+1],n=s>2?o[l*s+2]:0;i[3*a]=e,i[3*a+1]=t,i[3*a+2]=n}}_updateVertexValid(e,t){let{vertexStart:n,geometrySize:r}=t;const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&mm(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function Sm(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const Tm="uniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\nin vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\nout vec4 vColor;\nstruct PolygonProps {\nvec3 positions;\nvec3 positions64Low;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project_uCommonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = isWireframe ? lineColors : fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = pickingColors;\nif (extruded) {\npos.z += props.elevations * elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",xm="#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\n".concat(Tm,"\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n"),Am="#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 vertexPositions;\nin vec3 nextVertexPositions;\nin vec3 vertexPositions64Low;\nin vec3 nextVertexPositions64Low;\nin float elevations;\nin float instanceVertexValid;\n".concat(Tm,"\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = vertexPositions;\npos64Low = vertexPositions64Low;\nnextPos = nextVertexPositions;\nnextPos64Low = nextVertexPositions64Low;\n#else\npos = nextVertexPositions;\npos64Low = nextVertexPositions64Low;\nnextPos = vertexPositions;\nnextPos64Low = vertexPositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = elevations * positions.y;\ncalculatePosition(props);\n}\n"),Rm=[0,0,0,255],Pm={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Rm},getLineColor:{type:"accessor",value:Rm},material:!0},Cm={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class km extends qf{getShaders(e){return super.getShaders({vs:"top"===e?xm:Am,fs:"#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[Np,um,Dp]})}get wrapLongitude(){return!1}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:n}=this.props;let r;e.isGeospatial&&t===fe.DEFAULT&&(t=fe.LNGLAT),t===fe.LNGLAT&&(r=n?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new wm({preproject:r,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:Cm,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:Cm,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Cm,accessor:"getFillColor",defaultValue:Rm},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Cm,accessor:"getLineColor",defaultValue:Rm},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:l,wireframeModel:c,polygonTesselator:u}=this.state,h=a(a({},t),{},{extruded:Boolean(n),elevationScale:s});c&&i&&(c.setInstanceCount(u.instanceCount-1),c.setUniforms(h),c.draw(this.context.renderPass)),l&&r&&(l.setInstanceCount(u.instanceCount-1),l.setUniforms(h),l.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(u.vertexCount),o.setUniforms(h),o.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager();var s;(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(null===(s=this.state.models)||void 0===s||s.forEach((e=>e.destroy())),this.setState(this._getModels()),i.invalidateAll())}updateGeometry(e){let{props:t,oldProps:n,changeFlags:r}=e;if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,n=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:n}=this.props;let r,i,s;if(t){const t=this.getShaders("top");t.defines.NON_INSTANCED_MODEL=1;const n=this.getAttributeManager().getBufferLayouts({isInstanced:!1});r=new Od(this.context.device,a(a({},t),{},{id:"".concat(e,"-top"),topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:n,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}}))}if(n){const t=this.getAttributeManager().getBufferLayouts({isInstanced:!0});i=new Od(this.context.device,a(a({},this.getShaders("side")),{},{id:"".concat(e,"-side"),bufferLayout:t,uniforms:{isWireframe:!1},geometry:new Bp({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})),s=new Od(this.context.device,a(a({},this.getShaders("side")),{},{id:"".concat(e,"-wireframe"),bufferLayout:t,uniforms:{isWireframe:!0},geometry:new Bp({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}))}return{models:[i,s,r].filter(Boolean),topModel:r,sideModel:i,wireframeModel:s}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}km.defaultProps=Pm,km.layerName="SolidPolygonLayer";const Lm={circle:{type:Jp,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Yp,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Rg,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Mm={type:nm,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Im={type:km,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Om(e){let{type:t,props:n}=e;const r={};for(const i in n)r[i]=t.defaultProps[n[i]];return r}function Nm(e,t){const{transitions:n,updateTriggers:r}=e.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in t){const o=t[s];let a=e.props[s];s.startsWith("get")&&(a=e.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function Fm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=e.length}=n;for(let o=i;o<s;o++){const n=e[o],{geometry:i}=n;if(i)if("GeometryCollection"===i.type){de.assert(Array.isArray(i.geometries),"GeoJSON does not have geometries array");const{geometries:e}=i;for(let i=0;i<e.length;i++){Dm(e[i],r,t,n,o)}}else Dm(i,r,t,n,o)}return r}function Dm(e,t,n,r,i){const{type:s,coordinates:o}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(function(e,t){let n=Bm[e];de.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(s,o))switch(s){case"Point":a.push(n({geometry:e},r,i));break;case"MultiPoint":o.forEach((e=>{a.push(n({geometry:{type:"Point",coordinates:e}},r,i))}));break;case"LineString":l.push(n({geometry:e},r,i));break;case"MultiLineString":o.forEach((e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"Polygon":c.push(n({geometry:e},r,i)),o.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"MultiPolygon":o.forEach((e=>{c.push(n({geometry:{type:"Polygon",coordinates:e}},r,i)),e.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}))}))}else de.warn("".concat(s," coordinates are malformed"))()}const Bm={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Um(e){return e.geometry.coordinates}function zm(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:s}=e,o=function(e,t){const n={points:null,lines:null,polygons:null};for(const r in n){const i=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(4*i.length);const s=[];for(let e=0;e<i.length;e++)t(i[e],s),n[r][4*e+0]=s[0],n[r][4*e+1]=s[1],n[r][4*e+2]=s[2],n[r][4*e+3]=255}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:a(a({},r.attributes),{},{getPosition:r.positions,instancePickingColors:{size:4,value:o.points}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:a(a({},i.attributes),{},{getPath:i.positions,instancePickingColors:{size:4,value:o.lines}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:a(a({},s.attributes),{},{getPolygon:s.positions,pickingColors:{size:4,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:a(a({},s.attributes),{},{getPath:s.positions,instancePickingColors:{size:4,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const Gm=["instancePickingColors"],jm=["points","linestrings","polygons"],Vm=a(a(a(a(a(a({},Om(Lm.circle)),Om(Lm.icon)),Om(Lm.text)),Om(Mm)),Om(Im)),{},{stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}});class Wm extends Mp{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState(e){let{props:t,changeFlags:n}=e;if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}_updateStateBinary(e){let{props:t,changeFlags:n}=e;const r=zm(t.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON(e){let{props:t,changeFlags:n}=e;const r=function(e){if(Array.isArray(e))return e;switch(de.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return de.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const e=this.state.features;for(const t in e)s[t]=e[t].slice(),o[t]=[];for(const t of n.dataChanged){const n=Fm(r,i,t);for(const r in e)o[r].push(Ip({data:s[r],getIndex:e=>e.__source.index,dataRange:t,replace:n[r]}))}}else s=Fm(r,i);const a=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=e;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=Um,n.lines.data=i,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=Um,n.polygons.data=s,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=Um,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=Um,n}(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:r}=t;return t.featureType=jm.find((e=>r.id.startsWith("".concat(this.id,"-").concat(e,"-")))),n>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),n="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(e)}_renderPolygonLayer(){var e;const{extruded:t,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,null===(e=r.polygons)||void 0===e?void 0:e.data)&&this.getSubLayerClass(i,Im.type);if(s){const e=Nm(this,Im.props),o=t&&n;return o||delete e.getLineColor,e.updateTriggers.lineColors=o,new s(e,this.getSubLayerProps({id:i,updateTriggers:e.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var e,t;const{extruded:n,stroked:r}=this.props,{layerProps:i}=this.state,s="polygons-stroke",o="linestrings",a=!n&&r&&this.shouldRenderSubLayer(s,null===(e=i.polygonsOutline)||void 0===e?void 0:e.data)&&this.getSubLayerClass(s,Mm.type),l=this.shouldRenderSubLayer(o,null===(t=i.lines)||void 0===t?void 0:t.data)&&this.getSubLayerClass(o,Mm.type);if(a||l){const e=Nm(this,Mm.props);return[a&&new a(e,this.getSubLayerProps({id:s,updateTriggers:e.updateTriggers}),i.polygonsOutline),l&&new l(e,this.getSubLayerProps({id:o,updateTriggers:e.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex((e=>e.__source.index===r)));const i=new Set(e.split("+")),s=[];for(const l of i){var o;const e="points-".concat(l),i=Lm[l],c=i&&this.shouldRenderSubLayer(e,null===(o=t.points)||void 0===o?void 0:o.data)&&this.getSubLayerClass(e,i.type);if(c){const o=Nm(this,i.props);let u=t.points;if("text"===l&&n){const e=u.data.attributes,{instancePickingColors:t}=e,n=kp(e,Gm);u=a(a({},u),{},{data:a(a({},u.data),{},{attributes:n})})}s.push(new c(o,this.getSubLayerProps({id:e,updateTriggers:o.updateTriggers,highlightedObjectIndex:r}),u))}}return s}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"===typeof e?(t,n)=>{const{data:r,index:i}=n,s=Op(r,i);return e(s,n)}:super.getSubLayerAccessor(e)}}Wm.layerName="GeoJsonLayer",Wm.defaultProps=Vm;const Hm=Wm;var Xm=n(579);const qm={longitude:2.213749,latitude:46.227638,zoom:5,pitch:0,bearing:0},Km=()=>{const[t,n]=(0,e.useState)(null),[r,i]=(0,e.useState)(null),[s,o]=(0,e.useState)(null),[a,l]=(0,e.useState)(qm),[c,u]=(0,e.useState)(null),[h,d]=(0,e.useState)("score");(0,e.useEffect)((()=>{console.log("Rendu => hoverInfo:",c),fetch("./regions.geojson").then((e=>e.json())).then((e=>n(e))).catch((e=>console.error("Erreur lors du chargement des r\xe9gions :",e))),fetch("./fichier_joined.geojson").then((e=>e.json())).then((e=>i(e))).catch((e=>console.error("Erreur lors du chargement des communes :",e)))}),[]);const f=new Hm({id:"region-layer",data:t,filled:!1,stroked:!0,getLineColor:[255,255,255,255],lineWidthMinPixels:2}),p=new Hm({id:"commune-layer",data:r,filled:!0,stroked:!0,getFillColor:e=>{if(e.properties.reg===s){const t=e.properties[h];if("score"===h)switch(t){case 0:return[50,205,50,200];case 1:return[255,255,0,200];case 2:return[255,165,0,200];case 3:return[255,0,0,200];default:return[200,200,200,200]}else if("APL"===h)return(e=>null===e||void 0===e||isNaN(e)?[200,200,200,200]:e<2.5?[144,238,144,200]:e<4?[34,139,34,200]:[0,100,0,200])(t)}return[0,0,0,0]},getLineColor:e=>e.properties.reg===s&&a.zoom>=7?[0,0,0,255]:[0,0,0,0],lineWidthMinPixels:1,pickable:!0,onHover:e=>{let{object:t,x:n,y:r}=e;console.log("onHover d\xe9clench\xe9 :",t),u(t?{name:t.properties.libgeo,x:n,y:r}:null)},updateTriggers:{getFillColor:[s,h],getLineColor:[s,a.zoom]}});return(0,Xm.jsxs)("div",{children:[(0,Xm.jsxs)("select",{onChange:e=>{const n=e.target.value;o(n);const r=t.features.find((e=>e.properties.code===n));if(r){const e=(e=>{let t=1/0,n=1/0,r=-1/0,i=-1/0;if("Polygon"===e.type)e.coordinates.forEach((e=>{e.forEach((e=>{let[s,o]=e;isNaN(s)||isNaN(o)||(s<t&&(t=s),o<n&&(n=o),s>r&&(r=s),o>i&&(i=o))}))}));else{if("MultiPolygon"!==e.type)return console.error("Type de g\xe9om\xe9trie non pris en charge :",e.type),null;e.coordinates.forEach((e=>{e.forEach((e=>{e.forEach((e=>{let[s,o]=e;isNaN(s)||isNaN(o)||(s<t&&(t=s),o<n&&(n=o),s>r&&(r=s),o>i&&(i=o))}))}))}))}return isFinite(t)&&isFinite(n)&&isFinite(r)&&isFinite(i)?[t,n,r,i]:(console.error("Bounding box invalide pour la r\xe9gion :",e),null)})(r.geometry);if(e){const[t,n,r,i]=e;l({longitude:(t+r)/2,latitude:(n+i)/2,zoom:7,pitch:0,bearing:0})}}},defaultValue:"",style:{position:"absolute",top:10,left:2,zIndex:10,background:"white",padding:"5px",border:"1px solid #ccc",borderRadius:"4px"},children:[(0,Xm.jsx)("option",{value:"",disabled:!0,children:"Choisissez une r\xe9gion"}),t&&t.features.map((e=>(0,Xm.jsx)("option",{value:e.properties.code,children:e.properties.nom},e.properties.code)))]}),(0,Xm.jsx)("div",{style:{position:"absolute",top:10,left:210,zIndex:1e3},children:(0,Xm.jsxs)("select",{onChange:e=>{d(e.target.value)},value:h,style:{background:"white",padding:"5px",border:"1px solid #ccc",borderRadius:"4px"},children:[(0,Xm.jsx)("option",{value:"score",children:"DM"}),(0,Xm.jsx)("option",{value:"APL",children:"APL"})]})}),c&&(0,Xm.jsx)("div",{style:{position:"absolute",left:c.x,top:c.y,background:"white",zIndex:999999,padding:"5px",border:"1px solid #ccc",borderRadius:"4px",pointerEvents:"none"},children:c.name}),a.zoom>=7&&(0,Xm.jsxs)("div",{style:{position:"absolute",bottom:30,left:10,background:"white",padding:"10px",border:"1px solid #ccc",borderRadius:"4px",zIndex:10},children:[(0,Xm.jsx)("strong",{children:"L\xe9gende :"}),"score"===h?(0,Xm.jsxs)(Xm.Fragment,{children:[(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(50, 205, 50)",width:20,height:20,marginRight:10}}),"Pas de difficult\xe9 d'acc\xe8s"]}),(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(255, 255, 0)",width:20,height:20,marginRight:10}}),"1 Difficult\xe9"]}),(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(255, 165, 0)",width:20,height:20,marginRight:10}}),"2 Difficult\xe9s"]}),(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(255, 0, 0)",width:20,height:20,marginRight:10}}),"D\xe9sert m\xe9dical"]})]}):"APL"===h?(0,Xm.jsxs)(Xm.Fragment,{children:[(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(215, 238, 215)",width:20,height:20,marginRight:10}}),"[0 ; 2.5["]}),(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(48, 166, 48)",width:20,height:20,marginRight:10}}),"[2.5 ; 4["]}),(0,Xm.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:[(0,Xm.jsx)("div",{style:{backgroundColor:"rgb(0, 100, 0)",width:20,height:20,marginRight:10}}),"[4 ; 100["]})]}):null]}),(0,Xm.jsx)(tp,{viewState:a,onViewStateChange:e=>{let{viewState:t}=e;return l(t)},controller:!0,layers:[f,p],children:(0,Xm.jsx)(Cp,{mapboxAccessToken:"pk.eyJ1IjoicGllcnJlcm5vdCIsImEiOiJjbTV6ODI5eDYwMWc1MmlzYXhxbzhhZHFrIn0.oTv2QPR2e5ka2Oa597bI5g",mapStyle:"mapbox://styles/mapbox/satellite-v9",style:{pointerEvents:"none"}})})]})},Ym=e=>{e&&e instanceof Function&&n.e(488).then(n.bind(n,488)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};t.createRoot(document.getElementById("root")).render((0,Xm.jsxs)(e.StrictMode,{children:[(0,Xm.jsxs)("div",{style:{maxWidth:"800px",margin:"40px auto",backgroundColor:"#F9FDFB",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(42, 157, 143, 0.2)",fontFamily:"Arial, sans-serif",lineHeight:1.7,color:"#264653"},children:[(0,Xm.jsx)("h1",{style:{textAlign:"center",color:"#2A9D8F",marginBottom:"20px"},children:"Carte des communes en situation de d\xe9sert m\xe9dical par r\xe9gion"}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{children:"Deux m\xe9thodes de calcul sont ici utilis\xe9es pour analyser l'accessibilit\xe9 des diff\xe9rentes communes aux offres de soins :"}),(0,Xm.jsx)("br",{}),"On retrouve le score APL (Accessibilit\xe9 Potentielle Localis\xe9e) calcul\xe9 par la DREES (Direction de la Recherche) ainsi qu'un autre score que j'ai trouv\xe9 dans ce TD propos\xe9 par l'\xc9cole des m\xe9tiers de l'environnement :",(0,Xm.jsx)("a",{href:"https://storymaps.arcgis.com/stories/aa8a70ec49ef46b5a28834064a3f9e19",target:"_blank",rel:"noopener noreferrer",children:"Acc\xe9der au site de UniLaSalle"}),"."]}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{style:{color:"#2A9D8F"},children:"1. Score APL calcul\xe9 par la DREES"}),(0,Xm.jsx)("br",{}),"Le ",(0,Xm.jsx)("strong",{children:"score APL (Accessibilit\xe9 Potentielle Localis\xe9e)"})," est une mesure fine de l'accessibilit\xe9 aux soins, prenant en compte la densit\xe9 de professionnels de sant\xe9, la population et l'\xe9loignement. Cette valeur, comprise entre 0 et un maximum variable, offre une indication compl\xe9mentaire sur la disponibilit\xe9 des soins pour chaque commune. Ici, le score APL est calcul\xe9 uniquement pour les m\xe9decins g\xe9n\xe9ralistes."]}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{style:{color:"#2A9D8F"},children:"2. Score DM (D\xe9sert M\xe9dical)"}),(0,Xm.jsx)("br",{}),"Le ",(0,Xm.jsx)("strong",{children:"score DM (D\xe9sert M\xe9dical)"})," permet de d\xe9terminer \xe0 quel moment une commune est consid\xe9r\xe9e comme un d\xe9sert m\xe9dical. Les communes sont \xe9valu\xe9es sur trois crit\xe8res principaux. Un score de 0 indique que la commune dispose d\u2019une bonne accessibilit\xe9 aux soins, tandis qu\u2019un score de 3 signifie que la commune cumule tous les facteurs de difficult\xe9 et se trouve donc en situation de d\xe9sert m\xe9dical. Les diff\xe9rents facteurs \xe9valu\xe9s sont les suivants :"]}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{style:{color:"#E76F51"},children:"2.1. Le nombre de m\xe9decins g\xe9n\xe9ralistes"}),(0,Xm.jsx)("br",{}),"Chaque m\xe9decin g\xe9n\xe9raliste peut consulter environ 5\u202f000 patients par an. Comme un patient a besoin d\u2019environ 2,5 consultations par an, cela \xe9quivaut \xe0 1 m\xe9decin pour 2\u202f000 habitants. Si une commune ne respecte pas ce ratio (c\u2019est-\xe0-dire moins d\u2019un m\xe9decin pour 2\u202f000 habitants), elle re\xe7oit un point (+1) \xe0 son score."]}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{style:{color:"#E76F51"},children:"2.2. L\u2019\xe9loignement par rapport \xe0 une pharmacie"}),(0,Xm.jsx)("br",{}),"Nous consid\xe9rons qu\u2019une commune est correctement desservie si elle se trouve \xe0 moins de 5\u202fkm d\u2019une pharmacie, ce qui correspond \xe0 environ 10\u202fminutes de trajet \xe0 30\u202fkm/h. Si la commune est situ\xe9e \xe0 plus de 5\u202fkm d\u2019une pharmacie, elle obtient +1 \xe0 son score."]}),(0,Xm.jsxs)("p",{style:{marginBottom:"15px"},children:[(0,Xm.jsx)("strong",{style:{color:"#E76F51"},children:"2.3. L\u2019\xe9loignement par rapport \xe0 un h\xf4pital"}),(0,Xm.jsx)("br",{}),"De la m\xeame fa\xe7on, nous prenons en compte une zone de 15\u202fkm autour des h\xf4pitaux, qui repr\xe9sente environ 30\u202fminutes de trajet \xe0 30\u202fkm/h. Si la commune se situe au-del\xe0 de 15\u202fkm d\u2019un h\xf4pital, elle re\xe7oit \xe9galement +1 \xe0 son score."]})]}),(0,Xm.jsx)("div",{style:{width:"800px",height:"600px",margin:"40px auto",border:"1px solid #E9C46A",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,0.15)",position:"relative"},children:(0,Xm.jsx)(Km,{})})]})),Ym()})()})();
//# sourceMappingURL=main.b94587fc.js.map